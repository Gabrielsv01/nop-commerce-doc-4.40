<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NopCommerce 4.40: Referência à classe Nop.Services.Orders.OrderProcessingService</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="download.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NopCommerce 4.40
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gerado por Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Localizar','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Localizar');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_nop.html">Nop</a></li><li class="navelem"><a class="el" href="namespace_nop_1_1_services.html">Services</a></li><li class="navelem"><a class="el" href="namespace_nop_1_1_services_1_1_orders.html">Orders</a></li><li class="navelem"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html">OrderProcessingService</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Componentes</a> &#124;
<a href="#pub-methods">Membros públicos</a> &#124;
<a href="#pro-methods">Membros protegidos</a> &#124;
<a href="#pri-attribs">Atributos Privados</a> &#124;
<a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service-members.html">Mostrar lista completa dos membros</a>  </div>
  <div class="headertitle">
<div class="title">Referência à classe Nop.Services.Orders.OrderProcessingService</div>  </div>
</div><!--header-->
<div class="contents">

<p>Order processing service  
 <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#details">Mais...</a></p>
<div class="dynheader">
Diagrama de heranças da classe Nop.Services.Orders.OrderProcessingService</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.png" usemap="#Nop.Services.Orders.OrderProcessingService_map" alt=""/>
  <map id="Nop.Services.Orders.OrderProcessingService_map" name="Nop.Services.Orders.OrderProcessingService_map">
<area href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html" title="Order processing service interface" alt="Nop.Services.Orders.IOrderProcessingService" shape="rect" coords="0,0,281,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Componentes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">PlaceOrder container  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#details">Mais...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Membros públicos</h2></td></tr>
<tr class="memitem:ad640a14a8581f8eb8a57b0a210cc7316"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">OrderProcessingService</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html">CurrencySettings</a> currencySettings, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html">IAddressService</a> addressService, <a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html">IAffiliateService</a> affiliateService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html">ICheckoutAttributeFormatter</a> checkoutAttributeFormatter, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html">ICountryService</a> countryService, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html">ICurrencyService</a> currencyService, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html">ICustomerActivityService</a> customerActivityService, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html">ICustomerService</a> customerService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html">ICustomNumberFormatter</a> customNumberFormatter, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html">IDiscountService</a> discountService, <a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html">IEncryptionService</a> encryptionService, <a class="el" href="interface_nop_1_1_core_1_1_events_1_1_i_event_publisher.html">IEventPublisher</a> eventPublisher, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_generic_attribute_service.html">IGenericAttributeService</a> genericAttributeService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html">IGiftCardService</a> giftCardService, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html">ILanguageService</a> languageService, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html">ILocalizationService</a> localizationService, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html">ILogger</a> logger, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html">IOrderService</a> orderService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html">IOrderTotalCalculationService</a> orderTotalCalculationService, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html">IPaymentPluginManager</a> paymentPluginManager, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html">IPaymentService</a> paymentService, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html">IPdfService</a> pdfService, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html">IPriceCalculationService</a> priceCalculationService, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html">IPriceFormatter</a> priceFormatter, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html">IProductAttributeFormatter</a> productAttributeFormatter, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html">IProductAttributeParser</a> productAttributeParser, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html">IProductService</a> productService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html">IRewardPointService</a> rewardPointService, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html">IShipmentService</a> shipmentService, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html">IShippingService</a> shippingService, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html">IShoppingCartService</a> shoppingCartService, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html">IStateProvinceService</a> stateProvinceService, <a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html">ITaxService</a> taxService, <a class="el" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html">IVendorService</a> vendorService, <a class="el" href="interface_nop_1_1_core_1_1_i_web_helper.html">IWebHelper</a> webHelper, <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html">IWorkContext</a> workContext, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html">IWorkflowMessageService</a> workflowMessageService, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html">LocalizationSettings</a> localizationSettings, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html">OrderSettings</a> orderSettings, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html">PaymentSettings</a> paymentSettings, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html">RewardPointsSettings</a> rewardPointsSettings, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html">ShippingSettings</a> shippingSettings, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html">TaxSettings</a> taxSettings)</td></tr>
<tr class="separator:ad640a14a8581f8eb8a57b0a210cc7316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e730601668851f42f549318caaaa86"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a36e730601668851f42f549318caaaa86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks order status  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Mais...</a><br /></td></tr>
<tr class="separator:a36e730601668851f42f549318caaaa86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2ae89a729ed2afc363893126b81958"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_place_order_result.html">PlaceOrderResult</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">PlaceOrderAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest)</td></tr>
<tr class="memdesc:a6d2ae89a729ed2afc363893126b81958"><td class="mdescLeft">&#160;</td><td class="mdescRight">Places an order  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Mais...</a><br /></td></tr>
<tr class="separator:a6d2ae89a729ed2afc363893126b81958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598b25782d04f6afcb42582553bb84a2"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">UpdateOrderTotalsAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html">UpdateOrderParameters</a> updateOrderParameters)</td></tr>
<tr class="memdesc:a598b25782d04f6afcb42582553bb84a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update order totals  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Mais...</a><br /></td></tr>
<tr class="separator:a598b25782d04f6afcb42582553bb84a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f39e64546fb3a2604e36367c473eac"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">DeleteOrderAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:aa6f39e64546fb3a2604e36367c473eac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes an order  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Mais...</a><br /></td></tr>
<tr class="separator:aa6f39e64546fb3a2604e36367c473eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae46217f3f60445071742ab76556757aa"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IEnumerable&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">ProcessNextRecurringPaymentAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> paymentResult=null)</td></tr>
<tr class="memdesc:ae46217f3f60445071742ab76556757aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process next recurring payment  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Mais...</a><br /></td></tr>
<tr class="separator:ae46217f3f60445071742ab76556757aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a234b127560732053f0c1ab698604c408"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">CancelRecurringPaymentAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment)</td></tr>
<tr class="memdesc:a234b127560732053f0c1ab698604c408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels a recurring payment  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Mais...</a><br /></td></tr>
<tr class="separator:a234b127560732053f0c1ab698604c408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0875883e79f8cf6f926d30b11c9d0a3"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac0875883e79f8cf6f926d30b11c9d0a3">CanCancelRecurringPaymentAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Customer</a> customerToValidate, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment)</td></tr>
<tr class="memdesc:ac0875883e79f8cf6f926d30b11c9d0a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether a customer can cancel recurring payment  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac0875883e79f8cf6f926d30b11c9d0a3">Mais...</a><br /></td></tr>
<tr class="separator:ac0875883e79f8cf6f926d30b11c9d0a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb836ba11d1d94f76d792a351ee53cba"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeb836ba11d1d94f76d792a351ee53cba">CanRetryLastRecurringPaymentAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Customer</a> customer, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment)</td></tr>
<tr class="memdesc:aeb836ba11d1d94f76d792a351ee53cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether a customer can retry last failed recurring payment  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeb836ba11d1d94f76d792a351ee53cba">Mais...</a><br /></td></tr>
<tr class="separator:aeb836ba11d1d94f76d792a351ee53cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af368ffb978128f1a87ec3b4113c1e356"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">ShipAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html">Shipment</a> shipment, bool notifyCustomer)</td></tr>
<tr class="memdesc:af368ffb978128f1a87ec3b4113c1e356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a shipment  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Mais...</a><br /></td></tr>
<tr class="separator:af368ffb978128f1a87ec3b4113c1e356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad28d85dbb5aba28cdbcb26ca78f36edd"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">DeliverAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html">Shipment</a> shipment, bool notifyCustomer)</td></tr>
<tr class="memdesc:ad28d85dbb5aba28cdbcb26ca78f36edd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks a shipment as delivered  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Mais...</a><br /></td></tr>
<tr class="separator:ad28d85dbb5aba28cdbcb26ca78f36edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0701c7a5f62731bae805fbb414351c6"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae0701c7a5f62731bae805fbb414351c6">CanCancelOrder</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ae0701c7a5f62731bae805fbb414351c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether cancel is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae0701c7a5f62731bae805fbb414351c6">Mais...</a><br /></td></tr>
<tr class="separator:ae0701c7a5f62731bae805fbb414351c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94d9d92a027d9c60f54dc0e1cda6a8a8"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">CancelOrderAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, bool notifyCustomer)</td></tr>
<tr class="memdesc:a94d9d92a027d9c60f54dc0e1cda6a8a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels order  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Mais...</a><br /></td></tr>
<tr class="separator:a94d9d92a027d9c60f54dc0e1cda6a8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411ae4434d370451aaf29c57bd7cc543"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a411ae4434d370451aaf29c57bd7cc543">CanMarkOrderAsAuthorized</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a411ae4434d370451aaf29c57bd7cc543"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether order can be marked as authorized  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a411ae4434d370451aaf29c57bd7cc543">Mais...</a><br /></td></tr>
<tr class="separator:a411ae4434d370451aaf29c57bd7cc543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda57f823a8631e81d96c2318845fc84"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">MarkAsAuthorizedAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:aeda57f823a8631e81d96c2318845fc84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks order as authorized  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">Mais...</a><br /></td></tr>
<tr class="separator:aeda57f823a8631e81d96c2318845fc84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7af3ca11a1d78bcbba7679447c03e5a9"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">CanCaptureAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a7af3ca11a1d78bcbba7679447c03e5a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether capture from admin panel is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">Mais...</a><br /></td></tr>
<tr class="separator:a7af3ca11a1d78bcbba7679447c03e5a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed73679d36b7b6be34f30cc26e12dff"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">CaptureAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a4ed73679d36b7b6be34f30cc26e12dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capture an order (from admin panel)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Mais...</a><br /></td></tr>
<tr class="separator:a4ed73679d36b7b6be34f30cc26e12dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d275e26976b46270de28874bbb7beec"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a3d275e26976b46270de28874bbb7beec">CanMarkOrderAsPaid</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a3d275e26976b46270de28874bbb7beec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether order can be marked as paid  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a3d275e26976b46270de28874bbb7beec">Mais...</a><br /></td></tr>
<tr class="separator:a3d275e26976b46270de28874bbb7beec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a9ee7368631647b120766b46d5e5c0"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">MarkOrderAsPaidAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a85a9ee7368631647b120766b46d5e5c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks order as paid  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Mais...</a><br /></td></tr>
<tr class="separator:a85a9ee7368631647b120766b46d5e5c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a51e3689da5d8de248f4d4505f651f6"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">CanRefundAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a5a51e3689da5d8de248f4d4505f651f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether refund from admin panel is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">Mais...</a><br /></td></tr>
<tr class="separator:a5a51e3689da5d8de248f4d4505f651f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72ff7732c1fc400922a2a6c37d20e17"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">RefundAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ad72ff7732c1fc400922a2a6c37d20e17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refunds an order (from admin panel)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Mais...</a><br /></td></tr>
<tr class="separator:ad72ff7732c1fc400922a2a6c37d20e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de203d7ac5f4bb664036c72eec2f772"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2de203d7ac5f4bb664036c72eec2f772">CanRefundOffline</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a2de203d7ac5f4bb664036c72eec2f772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether order can be marked as refunded  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2de203d7ac5f4bb664036c72eec2f772">Mais...</a><br /></td></tr>
<tr class="separator:a2de203d7ac5f4bb664036c72eec2f772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adede3bbc864fd8df87dbf282c9a6f0c4"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">RefundOfflineAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:adede3bbc864fd8df87dbf282c9a6f0c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refunds an order (offline)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Mais...</a><br /></td></tr>
<tr class="separator:adede3bbc864fd8df87dbf282c9a6f0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c1027453ac2c150e4f5b5e34022883"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">CanPartiallyRefundAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, decimal amountToRefund)</td></tr>
<tr class="memdesc:af5c1027453ac2c150e4f5b5e34022883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether partial refund from admin panel is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">Mais...</a><br /></td></tr>
<tr class="separator:af5c1027453ac2c150e4f5b5e34022883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6623c66d5d0f34b520aa92df82552f37"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">PartiallyRefundAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, decimal amountToRefund)</td></tr>
<tr class="memdesc:a6623c66d5d0f34b520aa92df82552f37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partially refunds an order (from admin panel)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Mais...</a><br /></td></tr>
<tr class="separator:a6623c66d5d0f34b520aa92df82552f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d89f4c048a18b4790969a296a4d9952"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8d89f4c048a18b4790969a296a4d9952">CanPartiallyRefundOffline</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, decimal amountToRefund)</td></tr>
<tr class="memdesc:a8d89f4c048a18b4790969a296a4d9952"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether order can be marked as partially refunded  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8d89f4c048a18b4790969a296a4d9952">Mais...</a><br /></td></tr>
<tr class="separator:a8d89f4c048a18b4790969a296a4d9952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e7a00a2b1767ccb3d8cc954a16eff4"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">PartiallyRefundOfflineAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, decimal amountToRefund)</td></tr>
<tr class="memdesc:a81e7a00a2b1767ccb3d8cc954a16eff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partially refunds an order (offline)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Mais...</a><br /></td></tr>
<tr class="separator:a81e7a00a2b1767ccb3d8cc954a16eff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad97456f8075170348beaad8f57bd56e7"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">CanVoidAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ad97456f8075170348beaad8f57bd56e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether async Task from admin panel is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">Mais...</a><br /></td></tr>
<tr class="separator:ad97456f8075170348beaad8f57bd56e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604b3d74e2c15459de99e0ffcc43dd8f"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">VoidAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a604b3d74e2c15459de99e0ffcc43dd8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">async <a class="el" href="namespace_nop_1_1_services_1_1_tasks.html">Tasks</a> order (from admin panel)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Mais...</a><br /></td></tr>
<tr class="separator:a604b3d74e2c15459de99e0ffcc43dd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c099f5c6bff8c808ad6d86bcf7e8163"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0c099f5c6bff8c808ad6d86bcf7e8163">CanVoidOffline</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a0c099f5c6bff8c808ad6d86bcf7e8163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether order can be marked as async Tasked  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0c099f5c6bff8c808ad6d86bcf7e8163">Mais...</a><br /></td></tr>
<tr class="separator:a0c099f5c6bff8c808ad6d86bcf7e8163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5af48ff59b61c63f5d23630a925b09f"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">VoidOfflineAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ac5af48ff59b61c63f5d23630a925b09f"><td class="mdescLeft">&#160;</td><td class="mdescRight">async <a class="el" href="namespace_nop_1_1_services_1_1_tasks.html">Tasks</a> order (offline)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Mais...</a><br /></td></tr>
<tr class="separator:ac5af48ff59b61c63f5d23630a925b09f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0a42aabf0d2b5c41765806fce04b17"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">ReOrderAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a9b0a42aabf0d2b5c41765806fce04b17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Place order items in current user shopping cart.  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Mais...</a><br /></td></tr>
<tr class="separator:a9b0a42aabf0d2b5c41765806fce04b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a5d841973c068e42ea78caf6a160a3"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81a5d841973c068e42ea78caf6a160a3">IsReturnRequestAllowedAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a81a5d841973c068e42ea78caf6a160a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether return request is allowed  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81a5d841973c068e42ea78caf6a160a3">Mais...</a><br /></td></tr>
<tr class="separator:a81a5d841973c068e42ea78caf6a160a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2cedc770d4bd92ee976dcb0cec0604b"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">ValidateMinOrderSubtotalAmountAsync</a> (IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt; cart)</td></tr>
<tr class="memdesc:ab2cedc770d4bd92ee976dcb0cec0604b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate minimum order sub-total amount  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">Mais...</a><br /></td></tr>
<tr class="separator:ab2cedc770d4bd92ee976dcb0cec0604b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f9da9315f1980c60a43f756b7dc85c"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">ValidateMinOrderTotalAmountAsync</a> (IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt; cart)</td></tr>
<tr class="memdesc:aa5f9da9315f1980c60a43f756b7dc85c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate minimum order total amount  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">Mais...</a><br /></td></tr>
<tr class="separator:aa5f9da9315f1980c60a43f756b7dc85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468a280332b31043d11c73bd2f6e6630"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">IsPaymentWorkflowRequiredAsync</a> (IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt; cart, bool? useRewardPoints=null)</td></tr>
<tr class="memdesc:a468a280332b31043d11c73bd2f6e6630"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value indicating whether payment workflow is required  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">Mais...</a><br /></td></tr>
<tr class="separator:a468a280332b31043d11c73bd2f6e6630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5180e1683480f5550d2ca71a25b516"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; DateTime?&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">GetNextPaymentDateAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment)</td></tr>
<tr class="memdesc:abb5180e1683480f5550d2ca71a25b516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the next payment date  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">Mais...</a><br /></td></tr>
<tr class="separator:abb5180e1683480f5550d2ca71a25b516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26815bf28de303791fa0f42633a9245e"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a26815bf28de303791fa0f42633a9245e">GetCyclesRemainingAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a> recurringPayment)</td></tr>
<tr class="memdesc:a26815bf28de303791fa0f42633a9245e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the cycles remaining  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a26815bf28de303791fa0f42633a9245e">Mais...</a><br /></td></tr>
<tr class="separator:a26815bf28de303791fa0f42633a9245e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Membros protegidos</h2></td></tr>
<tr class="memitem:af7b69d22b846ca3ea12be3a4fd016a49"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, string note)</td></tr>
<tr class="memdesc:af7b69d22b846ca3ea12be3a4fd016a49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add order note  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Mais...</a><br /></td></tr>
<tr class="separator:af7b69d22b846ca3ea12be3a4fd016a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fe03f365a1fb4e26dfa305562fa7d5e"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">PreparePlaceOrderDetailsAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest)</td></tr>
<tr class="memdesc:a7fe03f365a1fb4e26dfa305562fa7d5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare details to place an order. It also sets some properties to "processPaymentRequest"  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Mais...</a><br /></td></tr>
<tr class="separator:a7fe03f365a1fb4e26dfa305562fa7d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a51cb2794e39742eca861d2767779ad"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">PrepareRecurringOrderDetailsAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest)</td></tr>
<tr class="memdesc:a8a51cb2794e39742eca861d2767779ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare details to place order based on the recurring payment.  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Mais...</a><br /></td></tr>
<tr class="separator:a8a51cb2794e39742eca861d2767779ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea58104edceca7eb0576dc9c02824f04"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">SaveOrderDetailsAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> processPaymentResult, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> details)</td></tr>
<tr class="memdesc:aea58104edceca7eb0576dc9c02824f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save order and add order notes  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Mais...</a><br /></td></tr>
<tr class="separator:aea58104edceca7eb0576dc9c02824f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fe03f64d9156620bc0611240669287"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">SendNotificationsAndSaveNotesAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a11fe03f64d9156620bc0611240669287"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send "order placed" notifications and save order notes  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Mais...</a><br /></td></tr>
<tr class="separator:a11fe03f64d9156620bc0611240669287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5834b1db8b3e55653eb039c0bbd3be9"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">AwardRewardPointsAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ae5834b1db8b3e55653eb039c0bbd3be9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Award (earn) reward points (for placing a new order)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Mais...</a><br /></td></tr>
<tr class="separator:ae5834b1db8b3e55653eb039c0bbd3be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ef586e3bf6517d1a70e6fcc6bef293"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">ReduceRewardPointsAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a58ef586e3bf6517d1a70e6fcc6bef293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce (cancel) reward points (previously awarded for placing an order)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Mais...</a><br /></td></tr>
<tr class="separator:a58ef586e3bf6517d1a70e6fcc6bef293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4879004f9159f7339cf04d1e2478178"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">ReturnBackRedeemedRewardPointsAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ab4879004f9159f7339cf04d1e2478178"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return back redeemed reward points to a customer (spent when placing an order)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Mais...</a><br /></td></tr>
<tr class="separator:ab4879004f9159f7339cf04d1e2478178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab640dd113d78cc91758e7bd2e05c5ec5"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">SetActivatedValueForPurchasedGiftCardsAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, bool activate)</td></tr>
<tr class="memdesc:ab640dd113d78cc91758e7bd2e05c5ec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set IsActivated value for purchase gift cards for particular order  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Mais...</a><br /></td></tr>
<tr class="separator:ab640dd113d78cc91758e7bd2e05c5ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa36dec6110e6877538e59656b5fbc67"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">SetOrderStatusAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, <a class="el" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a> os, bool notifyCustomer)</td></tr>
<tr class="memdesc:afa36dec6110e6877538e59656b5fbc67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an order status  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Mais...</a><br /></td></tr>
<tr class="separator:afa36dec6110e6877538e59656b5fbc67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f96cdb18cd65086be7f64788f98ca3"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">ProcessOrderPaidAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a14f96cdb18cd65086be7f64788f98ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process order paid status  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Mais...</a><br /></td></tr>
<tr class="separator:a14f96cdb18cd65086be7f64788f98ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfacc51e4ed202dd0ee478dba282fb3"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">ProcessCustomerRolesWithPurchasedProductSpecifiedAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, bool add)</td></tr>
<tr class="memdesc:a9cfacc51e4ed202dd0ee478dba282fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process customer roles with "Purchased with Product" property configured  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Mais...</a><br /></td></tr>
<tr class="separator:a9cfacc51e4ed202dd0ee478dba282fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada11474c14bf82ad908d28bf9d926112"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_vendors_1_1_vendor.html">Vendor</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">GetVendorsInOrderAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ada11474c14bf82ad908d28bf9d926112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a list of vendors in order (order items)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Mais...</a><br /></td></tr>
<tr class="separator:ada11474c14bf82ad908d28bf9d926112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f364e54df9c3c5e630d0251b3c4b6e2"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">CreateFirstRecurringPaymentAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a6f364e54df9c3c5e630d0251b3c4b6e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create recurring payment (the first payment)  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">Mais...</a><br /></td></tr>
<tr class="separator:a6f364e54df9c3c5e630d0251b3c4b6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c693d0278fa64204bbcac1f05df1651"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">MoveShoppingCartItemsToOrderItemsAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> details, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:a2c693d0278fa64204bbcac1f05df1651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move shopping cart items to order items  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Mais...</a><br /></td></tr>
<tr class="separator:a2c693d0278fa64204bbcac1f05df1651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b72d392fdabac68ba2bdfc50e63247"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">AddGiftCardsAsync</a> (<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html">Product</a> product, string attributesXml, int quantity, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item.html">OrderItem</a> orderItem, decimal? unitPriceExclTax=null, decimal? amount=null)</td></tr>
<tr class="memdesc:ac4b72d392fdabac68ba2bdfc50e63247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add gift cards  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Mais...</a><br /></td></tr>
<tr class="separator:ac4b72d392fdabac68ba2bdfc50e63247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fdc3a30ecd2f4fd151465b6b1953eb0"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt; <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">GetProcessPaymentResultAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a> processPaymentRequest, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> details)</td></tr>
<tr class="memdesc:a5fdc3a30ecd2f4fd151465b6b1953eb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get process payment result  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Mais...</a><br /></td></tr>
<tr class="separator:a5fdc3a30ecd2f4fd151465b6b1953eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b1d50935c535ba0709de02f3da3c05"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">SaveGiftCardUsageHistoryAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> details, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:af2b1d50935c535ba0709de02f3da3c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save gift card usage history  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">Mais...</a><br /></td></tr>
<tr class="separator:af2b1d50935c535ba0709de02f3da3c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28360b413dd34283242e7075da477d3"><td class="memItemLeft" align="right" valign="top">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">SaveDiscountUsageHistoryAsync</a> (<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a> details, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order)</td></tr>
<tr class="memdesc:ae28360b413dd34283242e7075da477d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save discount usage history  <a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">Mais...</a><br /></td></tr>
<tr class="separator:ae28360b413dd34283242e7075da477d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Atributos Privados</h2></td></tr>
<tr class="memitem:a7ece80723f8671f549b939dbd21926ce"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html">CurrencySettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">_currencySettings</a></td></tr>
<tr class="separator:a7ece80723f8671f549b939dbd21926ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeff3449bd42300b1f5277b5d4038059"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html">IAddressService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a></td></tr>
<tr class="separator:adeff3449bd42300b1f5277b5d4038059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee78ab02d7850dd249b88d5dc0d775e"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html">IAffiliateService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">_affiliateService</a></td></tr>
<tr class="separator:abee78ab02d7850dd249b88d5dc0d775e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75dbf57754d33a660e8263165282af98"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html">ICheckoutAttributeFormatter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">_checkoutAttributeFormatter</a></td></tr>
<tr class="separator:a75dbf57754d33a660e8263165282af98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf47b468edb2b5094a965595abef7180"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html">ICountryService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a></td></tr>
<tr class="separator:aaf47b468edb2b5094a965595abef7180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af4526c16c2806e79141eee59eec04d"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html">ICurrencyService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a></td></tr>
<tr class="separator:a1af4526c16c2806e79141eee59eec04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e8d965a1d5e4b9abd89d5b8167c7fae"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html">ICustomerActivityService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">_customerActivityService</a></td></tr>
<tr class="separator:a9e8d965a1d5e4b9abd89d5b8167c7fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528f4227552c25da09510c9030bc9471"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html">ICustomerService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a></td></tr>
<tr class="separator:a528f4227552c25da09510c9030bc9471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8773893cfe0dfd2f8ae2c17cd868325"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html">ICustomNumberFormatter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">_customNumberFormatter</a></td></tr>
<tr class="separator:ab8773893cfe0dfd2f8ae2c17cd868325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3799d8d3ec560c2e825d188bcda1e5b"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html">IDiscountService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a></td></tr>
<tr class="separator:ae3799d8d3ec560c2e825d188bcda1e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935fb408a00bf0f0c44151f1f87beb96"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html">IEncryptionService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a></td></tr>
<tr class="separator:a935fb408a00bf0f0c44151f1f87beb96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc6735136b96ead99c6fd2e4ac5bd9a"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_core_1_1_events_1_1_i_event_publisher.html">IEventPublisher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a></td></tr>
<tr class="separator:afbc6735136b96ead99c6fd2e4ac5bd9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af591bddf525120c688839eeb5b63483a"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_generic_attribute_service.html">IGenericAttributeService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a></td></tr>
<tr class="separator:af591bddf525120c688839eeb5b63483a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0283d452f56e8cc530632d5f24147f5f"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html">IGiftCardService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a></td></tr>
<tr class="separator:a0283d452f56e8cc530632d5f24147f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a86507ce9f96e887f327064723d350b"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html">ILanguageService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a></td></tr>
<tr class="separator:a8a86507ce9f96e887f327064723d350b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523bf26abfaef915d5c034e4e0a811b5"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html">ILocalizationService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a></td></tr>
<tr class="separator:a523bf26abfaef915d5c034e4e0a811b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2086f47aac799702f9a3b55b5bd964e"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html">ILogger</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a></td></tr>
<tr class="separator:ab2086f47aac799702f9a3b55b5bd964e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682a75ec4bce1100c65798a7e251bcf7"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html">IOrderService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a></td></tr>
<tr class="separator:a682a75ec4bce1100c65798a7e251bcf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adda1708b22c29c47ffd9976e21265e"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html">IOrderTotalCalculationService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a></td></tr>
<tr class="separator:a8adda1708b22c29c47ffd9976e21265e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ff841d52ac21b5a23ce1a9883730d3"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html">IPaymentPluginManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a></td></tr>
<tr class="separator:a96ff841d52ac21b5a23ce1a9883730d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9392ed22ab944838b08d28039e3ded08"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html">IPaymentService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a></td></tr>
<tr class="separator:a9392ed22ab944838b08d28039e3ded08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b921e2382b2d0f35d5fd9d378f62668"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html">IPdfService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">_pdfService</a></td></tr>
<tr class="separator:a4b921e2382b2d0f35d5fd9d378f62668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997713a565a6ac517f86ce46b6a05bbf"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html">IPriceCalculationService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">_priceCalculationService</a></td></tr>
<tr class="separator:a997713a565a6ac517f86ce46b6a05bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0c1f9f592bd30994ec44a49280cad0"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html">IPriceFormatter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">_priceFormatter</a></td></tr>
<tr class="separator:afc0c1f9f592bd30994ec44a49280cad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c365ad403e9ac6aa0f5557edb7f2fe"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html">IProductAttributeFormatter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">_productAttributeFormatter</a></td></tr>
<tr class="separator:a37c365ad403e9ac6aa0f5557edb7f2fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35af79dc9ceb975327b0a420491d3ec0"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html">IProductAttributeParser</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">_productAttributeParser</a></td></tr>
<tr class="separator:a35af79dc9ceb975327b0a420491d3ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a309d452cba4d881271ad2d24c7843dff"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html">IProductService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a></td></tr>
<tr class="separator:a309d452cba4d881271ad2d24c7843dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a637b49bb3285d8244c1ee304e59a3b3f"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html">IRewardPointService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a></td></tr>
<tr class="separator:a637b49bb3285d8244c1ee304e59a3b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8acb96f997201c0543a6833cd3a304e7"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html">IShipmentService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a></td></tr>
<tr class="separator:a8acb96f997201c0543a6833cd3a304e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0edda809b10ea29bfe00542d7306424f"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html">IShippingService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">_shippingService</a></td></tr>
<tr class="separator:a0edda809b10ea29bfe00542d7306424f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964b7bb1015e5a6901aaf80e827969cd"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html">IShoppingCartService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a></td></tr>
<tr class="separator:a964b7bb1015e5a6901aaf80e827969cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4eca13441d549f6e2b57ed3b0bb8df2"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html">IStateProvinceService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">_stateProvinceService</a></td></tr>
<tr class="separator:ad4eca13441d549f6e2b57ed3b0bb8df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a870338b48b8874c10ae35cff96dd4322"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html">ITaxService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a></td></tr>
<tr class="separator:a870338b48b8874c10ae35cff96dd4322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a904543a4ac69a1f79f576612ec51b05d"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html">IVendorService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">_vendorService</a></td></tr>
<tr class="separator:a904543a4ac69a1f79f576612ec51b05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85950a3b9289d679c1f24a07dc5b2610"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_core_1_1_i_web_helper.html">IWebHelper</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">_webHelper</a></td></tr>
<tr class="separator:a85950a3b9289d679c1f24a07dc5b2610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad13ab85dbf2eeff57a0e908475117cf"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html">IWorkContext</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a></td></tr>
<tr class="separator:aad13ab85dbf2eeff57a0e908475117cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f4795b2175a1ff0af7828c284477df"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html">IWorkflowMessageService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a></td></tr>
<tr class="separator:a34f4795b2175a1ff0af7828c284477df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23fbd6e69641baba3a5e4a2b72ba7da"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html">LocalizationSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a></td></tr>
<tr class="separator:ac23fbd6e69641baba3a5e4a2b72ba7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1ee6cc5f283a26994eff77ebbf11eb"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html">OrderSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a></td></tr>
<tr class="separator:a6b1ee6cc5f283a26994eff77ebbf11eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25d720884f3f10ddec6c09b6a214b4d"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html">PaymentSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">_paymentSettings</a></td></tr>
<tr class="separator:ab25d720884f3f10ddec6c09b6a214b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a974bdf4aa0452e9f43e8d9669acca975"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html">RewardPointsSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a></td></tr>
<tr class="separator:a974bdf4aa0452e9f43e8d9669acca975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212c894e11cf3f8fc28b0cfdc0bbedf8"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html">ShippingSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">_shippingSettings</a></td></tr>
<tr class="separator:a212c894e11cf3f8fc28b0cfdc0bbedf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab630f7eca77078d362428f6b924d2472"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html">TaxSettings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">_taxSettings</a></td></tr>
<tr class="separator:ab630f7eca77078d362428f6b924d2472"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descrição detalhada</h2>
<div class="textblock"><p>Order processing service </p>
</div><h2 class="groupheader">Documentação dos Construtores &amp; Destrutor</h2>
<a id="ad640a14a8581f8eb8a57b0a210cc7316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad640a14a8581f8eb8a57b0a210cc7316">&#9670;&nbsp;</a></span>OrderProcessingService()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Nop.Services.Orders.OrderProcessingService.OrderProcessingService </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html">CurrencySettings</a>&#160;</td>
          <td class="paramname"><em>currencySettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html">IAddressService</a>&#160;</td>
          <td class="paramname"><em>addressService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html">IAffiliateService</a>&#160;</td>
          <td class="paramname"><em>affiliateService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html">ICheckoutAttributeFormatter</a>&#160;</td>
          <td class="paramname"><em>checkoutAttributeFormatter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html">ICountryService</a>&#160;</td>
          <td class="paramname"><em>countryService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html">ICurrencyService</a>&#160;</td>
          <td class="paramname"><em>currencyService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html">ICustomerActivityService</a>&#160;</td>
          <td class="paramname"><em>customerActivityService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html">ICustomerService</a>&#160;</td>
          <td class="paramname"><em>customerService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html">ICustomNumberFormatter</a>&#160;</td>
          <td class="paramname"><em>customNumberFormatter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html">IDiscountService</a>&#160;</td>
          <td class="paramname"><em>discountService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html">IEncryptionService</a>&#160;</td>
          <td class="paramname"><em>encryptionService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_core_1_1_events_1_1_i_event_publisher.html">IEventPublisher</a>&#160;</td>
          <td class="paramname"><em>eventPublisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_generic_attribute_service.html">IGenericAttributeService</a>&#160;</td>
          <td class="paramname"><em>genericAttributeService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html">IGiftCardService</a>&#160;</td>
          <td class="paramname"><em>giftCardService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html">ILanguageService</a>&#160;</td>
          <td class="paramname"><em>languageService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html">ILocalizationService</a>&#160;</td>
          <td class="paramname"><em>localizationService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html">ILogger</a>&#160;</td>
          <td class="paramname"><em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html">IOrderService</a>&#160;</td>
          <td class="paramname"><em>orderService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html">IOrderTotalCalculationService</a>&#160;</td>
          <td class="paramname"><em>orderTotalCalculationService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html">IPaymentPluginManager</a>&#160;</td>
          <td class="paramname"><em>paymentPluginManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html">IPaymentService</a>&#160;</td>
          <td class="paramname"><em>paymentService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html">IPdfService</a>&#160;</td>
          <td class="paramname"><em>pdfService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html">IPriceCalculationService</a>&#160;</td>
          <td class="paramname"><em>priceCalculationService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html">IPriceFormatter</a>&#160;</td>
          <td class="paramname"><em>priceFormatter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html">IProductAttributeFormatter</a>&#160;</td>
          <td class="paramname"><em>productAttributeFormatter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html">IProductAttributeParser</a>&#160;</td>
          <td class="paramname"><em>productAttributeParser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html">IProductService</a>&#160;</td>
          <td class="paramname"><em>productService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html">IRewardPointService</a>&#160;</td>
          <td class="paramname"><em>rewardPointService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html">IShipmentService</a>&#160;</td>
          <td class="paramname"><em>shipmentService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html">IShippingService</a>&#160;</td>
          <td class="paramname"><em>shippingService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html">IShoppingCartService</a>&#160;</td>
          <td class="paramname"><em>shoppingCartService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html">IStateProvinceService</a>&#160;</td>
          <td class="paramname"><em>stateProvinceService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html">ITaxService</a>&#160;</td>
          <td class="paramname"><em>taxService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html">IVendorService</a>&#160;</td>
          <td class="paramname"><em>vendorService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_core_1_1_i_web_helper.html">IWebHelper</a>&#160;</td>
          <td class="paramname"><em>webHelper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html">IWorkContext</a>&#160;</td>
          <td class="paramname"><em>workContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html">IWorkflowMessageService</a>&#160;</td>
          <td class="paramname"><em>workflowMessageService</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html">LocalizationSettings</a>&#160;</td>
          <td class="paramname"><em>localizationSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html">OrderSettings</a>&#160;</td>
          <td class="paramname"><em>orderSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html">PaymentSettings</a>&#160;</td>
          <td class="paramname"><em>paymentSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html">RewardPointsSettings</a>&#160;</td>
          <td class="paramname"><em>rewardPointsSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html">ShippingSettings</a>&#160;</td>
          <td class="paramname"><em>shippingSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html">TaxSettings</a>&#160;</td>
          <td class="paramname"><em>taxSettings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">_currencySettings</a> = currencySettings;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a> = addressService;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">_affiliateService</a> = affiliateService;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">_checkoutAttributeFormatter</a> = checkoutAttributeFormatter;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a> = countryService;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a> = currencyService;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">_customerActivityService</a> = customerActivityService;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a> = customerService;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">_customNumberFormatter</a> = customNumberFormatter;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a> = discountService;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a> = encryptionService;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a> = eventPublisher;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a> = genericAttributeService;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a> = giftCardService;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a> = languageService;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a> = localizationService;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a> = logger;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a> = orderService;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a> = orderTotalCalculationService;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a> = paymentPluginManager;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a> = paymentService;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">_pdfService</a> = pdfService;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">_priceCalculationService</a> = priceCalculationService;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">_priceFormatter</a> = priceFormatter;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">_productAttributeFormatter</a> = productAttributeFormatter;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">_productAttributeParser</a> = productAttributeParser;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a> = productService;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a> = rewardPointService;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a> = shipmentService;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">_shippingService</a> = shippingService;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a> = shoppingCartService;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">_stateProvinceService</a> = stateProvinceService;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a> = taxService;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">_vendorService</a> = vendorService;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">_webHelper</a> = webHelper;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a> = workContext;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a> = workflowMessageService;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a> = localizationSettings;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a> = orderSettings;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">_paymentSettings</a> = paymentSettings;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a> = rewardPointsSettings;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">_shippingSettings</a> = shippingSettings;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">_taxSettings</a> = taxSettings;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a0283d452f56e8cc530632d5f24147f5f"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a></div><div class="ttdeci">readonly IGiftCardService _giftCardService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:57</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a0edda809b10ea29bfe00542d7306424f"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">Nop.Services.Orders.OrderProcessingService._shippingService</a></div><div class="ttdeci">readonly IShippingService _shippingService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:73</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a1af4526c16c2806e79141eee59eec04d"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">Nop.Services.Orders.OrderProcessingService._currencyService</a></div><div class="ttdeci">readonly ICurrencyService _currencyService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:49</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a212c894e11cf3f8fc28b0cfdc0bbedf8"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">Nop.Services.Orders.OrderProcessingService._shippingSettings</a></div><div class="ttdeci">readonly ShippingSettings _shippingSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:85</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a309d452cba4d881271ad2d24c7843dff"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a></div><div class="ttdeci">readonly IProductService _productService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:70</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a34f4795b2175a1ff0af7828c284477df"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a></div><div class="ttdeci">readonly IWorkflowMessageService _workflowMessageService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:80</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a35af79dc9ceb975327b0a420491d3ec0"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">Nop.Services.Orders.OrderProcessingService._productAttributeParser</a></div><div class="ttdeci">readonly IProductAttributeParser _productAttributeParser</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:69</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a37c365ad403e9ac6aa0f5557edb7f2fe"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">Nop.Services.Orders.OrderProcessingService._productAttributeFormatter</a></div><div class="ttdeci">readonly IProductAttributeFormatter _productAttributeFormatter</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:68</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a4b921e2382b2d0f35d5fd9d378f62668"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">Nop.Services.Orders.OrderProcessingService._pdfService</a></div><div class="ttdeci">readonly IPdfService _pdfService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:65</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a523bf26abfaef915d5c034e4e0a811b5"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a></div><div class="ttdeci">readonly ILocalizationService _localizationService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:59</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a528f4227552c25da09510c9030bc9471"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a></div><div class="ttdeci">readonly ICustomerService _customerService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:51</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a637b49bb3285d8244c1ee304e59a3b3f"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a></div><div class="ttdeci">readonly IRewardPointService _rewardPointService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:71</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a682a75ec4bce1100c65798a7e251bcf7"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a></div><div class="ttdeci">readonly IOrderService _orderService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:61</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a6b1ee6cc5f283a26994eff77ebbf11eb"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a></div><div class="ttdeci">readonly OrderSettings _orderSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:82</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a75dbf57754d33a660e8263165282af98"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">Nop.Services.Orders.OrderProcessingService._checkoutAttributeFormatter</a></div><div class="ttdeci">readonly ICheckoutAttributeFormatter _checkoutAttributeFormatter</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:47</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a7ece80723f8671f549b939dbd21926ce"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">Nop.Services.Orders.OrderProcessingService._currencySettings</a></div><div class="ttdeci">readonly CurrencySettings _currencySettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:44</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a85950a3b9289d679c1f24a07dc5b2610"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">Nop.Services.Orders.OrderProcessingService._webHelper</a></div><div class="ttdeci">readonly IWebHelper _webHelper</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:78</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a870338b48b8874c10ae35cff96dd4322"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">Nop.Services.Orders.OrderProcessingService._taxService</a></div><div class="ttdeci">readonly ITaxService _taxService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:76</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a8a86507ce9f96e887f327064723d350b"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">Nop.Services.Orders.OrderProcessingService._languageService</a></div><div class="ttdeci">readonly ILanguageService _languageService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:58</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a8acb96f997201c0543a6833cd3a304e7"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a></div><div class="ttdeci">readonly IShipmentService _shipmentService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:72</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a8adda1708b22c29c47ffd9976e21265e"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a></div><div class="ttdeci">readonly IOrderTotalCalculationService _orderTotalCalculationService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:62</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a904543a4ac69a1f79f576612ec51b05d"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">Nop.Services.Orders.OrderProcessingService._vendorService</a></div><div class="ttdeci">readonly IVendorService _vendorService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:77</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a935fb408a00bf0f0c44151f1f87beb96"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">Nop.Services.Orders.OrderProcessingService._encryptionService</a></div><div class="ttdeci">readonly IEncryptionService _encryptionService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:54</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a9392ed22ab944838b08d28039e3ded08"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a></div><div class="ttdeci">readonly IPaymentService _paymentService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:64</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a964b7bb1015e5a6901aaf80e827969cd"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a></div><div class="ttdeci">readonly IShoppingCartService _shoppingCartService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:74</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a96ff841d52ac21b5a23ce1a9883730d3"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">Nop.Services.Orders.OrderProcessingService._paymentPluginManager</a></div><div class="ttdeci">readonly IPaymentPluginManager _paymentPluginManager</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:63</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a974bdf4aa0452e9f43e8d9669acca975"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">Nop.Services.Orders.OrderProcessingService._rewardPointsSettings</a></div><div class="ttdeci">readonly RewardPointsSettings _rewardPointsSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:84</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a997713a565a6ac517f86ce46b6a05bbf"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">Nop.Services.Orders.OrderProcessingService._priceCalculationService</a></div><div class="ttdeci">readonly IPriceCalculationService _priceCalculationService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:66</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a9e8d965a1d5e4b9abd89d5b8167c7fae"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">Nop.Services.Orders.OrderProcessingService._customerActivityService</a></div><div class="ttdeci">readonly ICustomerActivityService _customerActivityService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:50</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_aad13ab85dbf2eeff57a0e908475117cf"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">Nop.Services.Orders.OrderProcessingService._workContext</a></div><div class="ttdeci">readonly IWorkContext _workContext</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:79</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_aaf47b468edb2b5094a965595abef7180"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">Nop.Services.Orders.OrderProcessingService._countryService</a></div><div class="ttdeci">readonly ICountryService _countryService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:48</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab2086f47aac799702f9a3b55b5bd964e"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a></div><div class="ttdeci">readonly ILogger _logger</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:60</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab25d720884f3f10ddec6c09b6a214b4d"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">Nop.Services.Orders.OrderProcessingService._paymentSettings</a></div><div class="ttdeci">readonly PaymentSettings _paymentSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:83</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab630f7eca77078d362428f6b924d2472"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">Nop.Services.Orders.OrderProcessingService._taxSettings</a></div><div class="ttdeci">readonly TaxSettings _taxSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:86</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab8773893cfe0dfd2f8ae2c17cd868325"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">Nop.Services.Orders.OrderProcessingService._customNumberFormatter</a></div><div class="ttdeci">readonly ICustomNumberFormatter _customNumberFormatter</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:52</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_abee78ab02d7850dd249b88d5dc0d775e"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">Nop.Services.Orders.OrderProcessingService._affiliateService</a></div><div class="ttdeci">readonly IAffiliateService _affiliateService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:46</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ac23fbd6e69641baba3a5e4a2b72ba7da"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a></div><div class="ttdeci">readonly LocalizationSettings _localizationSettings</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:81</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ad4eca13441d549f6e2b57ed3b0bb8df2"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">Nop.Services.Orders.OrderProcessingService._stateProvinceService</a></div><div class="ttdeci">readonly IStateProvinceService _stateProvinceService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:75</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_adeff3449bd42300b1f5277b5d4038059"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a></div><div class="ttdeci">readonly IAddressService _addressService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:45</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ae3799d8d3ec560c2e825d188bcda1e5b"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a></div><div class="ttdeci">readonly IDiscountService _discountService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:53</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_af591bddf525120c688839eeb5b63483a"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">Nop.Services.Orders.OrderProcessingService._genericAttributeService</a></div><div class="ttdeci">readonly IGenericAttributeService _genericAttributeService</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:56</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_afbc6735136b96ead99c6fd2e4ac5bd9a"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a></div><div class="ttdeci">readonly IEventPublisher _eventPublisher</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:55</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_afc0c1f9f592bd30994ec44a49280cad0"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">Nop.Services.Orders.OrderProcessingService._priceFormatter</a></div><div class="ttdeci">readonly IPriceFormatter _priceFormatter</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:67</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">Nop.Services.Orders.OrderProcessingService._affiliateService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">Nop.Services.Orders.OrderProcessingService._checkoutAttributeFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">Nop.Services.Orders.OrderProcessingService._countryService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">Nop.Services.Orders.OrderProcessingService._currencyService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">Nop.Services.Orders.OrderProcessingService._currencySettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">Nop.Services.Orders.OrderProcessingService._customerActivityService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">Nop.Services.Orders.OrderProcessingService._customNumberFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">Nop.Services.Orders.OrderProcessingService._encryptionService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">Nop.Services.Orders.OrderProcessingService._genericAttributeService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">Nop.Services.Orders.OrderProcessingService._languageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">Nop.Services.Orders.OrderProcessingService._paymentPluginManager</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">Nop.Services.Orders.OrderProcessingService._paymentSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">Nop.Services.Orders.OrderProcessingService._pdfService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">Nop.Services.Orders.OrderProcessingService._priceCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">Nop.Services.Orders.OrderProcessingService._priceFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">Nop.Services.Orders.OrderProcessingService._productAttributeFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">Nop.Services.Orders.OrderProcessingService._productAttributeParser</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">Nop.Services.Orders.OrderProcessingService._rewardPointsSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">Nop.Services.Orders.OrderProcessingService._shippingService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">Nop.Services.Orders.OrderProcessingService._shippingSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">Nop.Services.Orders.OrderProcessingService._stateProvinceService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">Nop.Services.Orders.OrderProcessingService._taxService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">Nop.Services.Orders.OrderProcessingService._taxSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">Nop.Services.Orders.OrderProcessingService._vendorService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">Nop.Services.Orders.OrderProcessingService._webHelper</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">Nop.Services.Orders.OrderProcessingService._workContext</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>.</p>

</div>
</div>
<h2 class="groupheader">Documentação dos métodos</h2>
<a id="ac4b72d392fdabac68ba2bdfc50e63247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4b72d392fdabac68ba2bdfc50e63247">&#9670;&nbsp;</a></span>AddGiftCardsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html">Product</a>&#160;</td>
          <td class="paramname"><em>product</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>attributesXml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item.html">OrderItem</a>&#160;</td>
          <td class="paramname"><em>orderItem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal?&#160;</td>
          <td class="paramname"><em>unitPriceExclTax</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal?&#160;</td>
          <td class="paramname"><em>amount</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add gift cards </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">product</td><td>Product</td></tr>
    <tr><td class="paramname">attributesXml</td><td>attributes XML</td></tr>
    <tr><td class="paramname">quantity</td><td>Quantity</td></tr>
    <tr><td class="paramname">orderItem</td><td>Order item</td></tr>
    <tr><td class="paramname">unitPriceExclTax</td><td>Unit price exclude tax, it set as amount if not set specific amount and product.OverriddenGiftCardAmount isn't set to</td></tr>
    <tr><td class="paramname">amount</td><td>Amount</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <span class="keywordflow">if</span> (!product.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a8d70485c3203a16825ae825c95213251">IsGiftCard</a>)</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">_productAttributeParser</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#aa6709c214a351f742b21fea2a724ebc0">GetGiftCardAttribute</a>(attributesXml, out var giftCardRecipientName, out var giftCardRecipientEmail, out var giftCardSenderName, out var giftCardSenderEmail, out var giftCardMessage);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; quantity; i++)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a3c7fdae43952c4b12e25c21e1850e5df">InsertGiftCardAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card.html">GiftCard</a></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a0e151df37c0bce5b7c5b587fa8fe9abf">GiftCardType</a> = product.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a890e434f9d4c91e70b77f48a09a4fde7">GiftCardType</a>,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    PurchasedWithOrderItemId = orderItem.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae367eb09b221d67f54cd231220ee462c">Amount</a> = amount ?? product.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a11d9541f2278f2a61fdf587dad206e85">OverriddenGiftCardAmount</a> ?? unitPriceExclTax ?? 0,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5da4f183515ba0059333b776910ab454">IsGiftCardActivated</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4fcb914f9042f05c2eb92f4892f6b154">GiftCardCouponCode</a> = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a29685699ada6e844f37f68010589f4b3">GenerateGiftCardCode</a>(),</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae13196995048ad3ac2bfa89f52373e92">RecipientName</a> = giftCardRecipientName,</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0756e5d227147932e90c9932f049815">RecipientEmail</a> = giftCardRecipientEmail,</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aac78175a0fa511600c48ed7f90977ec0">SenderName</a> = giftCardSenderName,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#acd75e887843bb605b7360eee917bd85d">SenderEmail</a> = giftCardSenderEmail,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5bb51970160b2dab13749ebf5a891396">Message</a> = giftCardMessage,</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a3b9eb62bdabbf3eca7e0dc86b1eb9dac">IsRecipientNotified</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                    CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                });</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_base_entity_html_a6908f7c042a024f82d7e7947e75bca53"><div class="ttname"><a href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a></div><div class="ttdeci">int Id</div><div class="ttdoc">Gets or sets the entity identifier</div><div class="ttdef"><b>Definition:</b> BaseEntity.cs:11</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product_html_a11d9541f2278f2a61fdf587dad206e85"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a11d9541f2278f2a61fdf587dad206e85">Nop.Core.Domain.Catalog.Product.OverriddenGiftCardAmount</a></div><div class="ttdeci">decimal? OverriddenGiftCardAmount</div><div class="ttdoc">Gets or sets gift card amount that can be used after purchase. If not specified, then product price w...</div><div class="ttdef"><b>Definition:</b> Product.cs:146</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product_html_a890e434f9d4c91e70b77f48a09a4fde7"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a890e434f9d4c91e70b77f48a09a4fde7">Nop.Core.Domain.Catalog.Product.GiftCardType</a></div><div class="ttdeci">GiftCardType GiftCardType</div><div class="ttdoc">Gets or sets the gift card type</div><div class="ttdef"><b>Definition:</b> Product.cs:575</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product_html_a8d70485c3203a16825ae825c95213251"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a8d70485c3203a16825ae825c95213251">Nop.Core.Domain.Catalog.Product.IsGiftCard</a></div><div class="ttdeci">bool IsGiftCard</div><div class="ttdoc">Gets or sets a value indicating whether the product is gift card</div><div class="ttdef"><b>Definition:</b> Product.cs:136</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card.html">Nop.Core.Domain.Orders.GiftCard</a></div><div class="ttdoc">Represents a gift card</div><div class="ttdef"><b>Definition:</b> GiftCard.cs:10</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser_html_aa6709c214a351f742b21fea2a724ebc0"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#aa6709c214a351f742b21fea2a724ebc0">Nop.Services.Catalog.IProductAttributeParser.GetGiftCardAttribute</a></div><div class="ttdeci">void GetGiftCardAttribute(string attributesXml, out string recipientName, out string recipientEmail, out string senderName, out string senderEmail, out string giftCardMessage)</div><div class="ttdoc">Get gift card attributes</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_a29685699ada6e844f37f68010589f4b3"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a29685699ada6e844f37f68010589f4b3">Nop.Services.Orders.IGiftCardService.GenerateGiftCardCode</a></div><div class="ttdeci">string GenerateGiftCardCode()</div><div class="ttdoc">Generate new gift card code</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_a3c7fdae43952c4b12e25c21e1850e5df"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a3c7fdae43952c4b12e25c21e1850e5df">Nop.Services.Orders.IGiftCardService.InsertGiftCardAsync</a></div><div class="ttdeci">Task InsertGiftCardAsync(GiftCard giftCard)</div><div class="ttdoc">Inserts a gift card</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_catalog_html_a0e151df37c0bce5b7c5b587fa8fe9abf"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a0e151df37c0bce5b7c5b587fa8fe9abf">Nop.Core.Domain.Catalog.GiftCardType</a></div><div class="ttdeci">GiftCardType</div><div class="ttdoc">Represents a gift card type</div><div class="ttdef"><b>Definition:</b> GiftCardType.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog_html_a5bb51970160b2dab13749ebf5a891396"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5bb51970160b2dab13749ebf5a891396">Nop.Web.Areas.Admin.Models.Catalog.Message</a></div><div class="ttdeci">string Message</div><div class="ttdef"><b>Definition:</b> StockQuantityHistoryModel.cs:28</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a3b9eb62bdabbf3eca7e0dc86b1eb9dac"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a3b9eb62bdabbf3eca7e0dc86b1eb9dac">Nop.Web.Areas.Admin.Models.Orders.IsRecipientNotified</a></div><div class="ttdeci">bool IsRecipientNotified</div><div class="ttdef"><b>Definition:</b> GiftCardModel.cs:66</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a4fcb914f9042f05c2eb92f4892f6b154"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4fcb914f9042f05c2eb92f4892f6b154">Nop.Web.Areas.Admin.Models.Orders.GiftCardCouponCode</a></div><div class="ttdeci">string GiftCardCouponCode</div><div class="ttdef"><b>Definition:</b> GiftCardModel.cs:46</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a5da4f183515ba0059333b776910ab454"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5da4f183515ba0059333b776910ab454">Nop.Web.Areas.Admin.Models.Orders.IsGiftCardActivated</a></div><div class="ttdeci">bool IsGiftCardActivated</div><div class="ttdef"><b>Definition:</b> GiftCardModel.cs:43</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_aac78175a0fa511600c48ed7f90977ec0"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aac78175a0fa511600c48ed7f90977ec0">Nop.Web.Areas.Admin.Models.Orders.SenderName</a></div><div class="ttdeci">string SenderName</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:120</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_acd75e887843bb605b7360eee917bd85d"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#acd75e887843bb605b7360eee917bd85d">Nop.Web.Areas.Admin.Models.Orders.SenderEmail</a></div><div class="ttdeci">string SenderEmail</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:123</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ae13196995048ad3ac2bfa89f52373e92"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae13196995048ad3ac2bfa89f52373e92">Nop.Web.Areas.Admin.Models.Orders.RecipientName</a></div><div class="ttdeci">string RecipientName</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:115</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ae367eb09b221d67f54cd231220ee462c"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae367eb09b221d67f54cd231220ee462c">Nop.Web.Areas.Admin.Models.Orders.Amount</a></div><div class="ttdeci">decimal Amount</div><div class="ttdef"><b>Definition:</b> GiftCardModel.cs:34</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_af0756e5d227147932e90c9932f049815"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0756e5d227147932e90c9932f049815">Nop.Web.Areas.Admin.Models.Orders.RecipientEmail</a></div><div class="ttdeci">string RecipientEmail</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:118</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">Nop.Services.Orders.OrderProcessingService._productAttributeParser</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae367eb09b221d67f54cd231220ee462c">Nop.Web.Areas.Admin.Models.Orders.Amount</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a29685699ada6e844f37f68010589f4b3">Nop.Services.Orders.IGiftCardService.GenerateGiftCardCode()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#aa6709c214a351f742b21fea2a724ebc0">Nop.Services.Catalog.IProductAttributeParser.GetGiftCardAttribute()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4fcb914f9042f05c2eb92f4892f6b154">Nop.Web.Areas.Admin.Models.Orders.GiftCardCouponCode</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a890e434f9d4c91e70b77f48a09a4fde7">Nop.Core.Domain.Catalog.Product.GiftCardType</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a3c7fdae43952c4b12e25c21e1850e5df">Nop.Services.Orders.IGiftCardService.InsertGiftCardAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a8d70485c3203a16825ae825c95213251">Nop.Core.Domain.Catalog.Product.IsGiftCard</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5da4f183515ba0059333b776910ab454">Nop.Web.Areas.Admin.Models.Orders.IsGiftCardActivated</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a3b9eb62bdabbf3eca7e0dc86b1eb9dac">Nop.Web.Areas.Admin.Models.Orders.IsRecipientNotified</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5bb51970160b2dab13749ebf5a891396">Nop.Web.Areas.Admin.Models.Catalog.Message</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_catalog_1_1_product.html#a11d9541f2278f2a61fdf587dad206e85">Nop.Core.Domain.Catalog.Product.OverriddenGiftCardAmount</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0756e5d227147932e90c9932f049815">Nop.Web.Areas.Admin.Models.Orders.RecipientEmail</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae13196995048ad3ac2bfa89f52373e92">Nop.Web.Areas.Admin.Models.Orders.RecipientName</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#acd75e887843bb605b7360eee917bd85d">Nop.Web.Areas.Admin.Models.Orders.SenderEmail</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aac78175a0fa511600c48ed7f90977ec0">Nop.Web.Areas.Admin.Models.Orders.SenderName</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="af7b69d22b846ca3ea12be3a4fd016a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7b69d22b846ca3ea12be3a4fd016a49">&#9670;&nbsp;</a></span>AddOrderNoteAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>note</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add order note </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">note</td><td>Note text</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">InsertOrderNoteAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_note.html">OrderNote</a></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Note</a> = note,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">DisplayToCustomer</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            });</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_note_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_note.html">Nop.Core.Domain.Orders.OrderNote</a></div><div class="ttdoc">Represents an order note</div><div class="ttdef"><b>Definition:</b> OrderNote.cs:9</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a8050588c304b2eb1124db700048e9aca"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">Nop.Services.Orders.IOrderService.InsertOrderNoteAsync</a></div><div class="ttdeci">Task InsertOrderNoteAsync(OrderNote orderNote)</div><div class="ttdoc">Inserts an order note</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts_html_acfc1f9bbdff6eb7524d793f0816abf27"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a></div><div class="ttdeci">int OrderId</div><div class="ttdef"><b>Definition:</b> DiscountUsageHistoryModel.cs:16</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a09633445d2625eaf1bcdb22508ee225d"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Nop.Web.Areas.Admin.Models.Orders.Note</a></div><div class="ttdeci">string Note</div><div class="ttdef"><b>Definition:</b> OrderNoteModel.cs:20</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a97fa178b181ac63a4b628d63c4b01a2b"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">Nop.Web.Areas.Admin.Models.Orders.DisplayToCustomer</a></div><div class="ttdeci">bool DisplayToCustomer</div><div class="ttdef"><b>Definition:</b> OrderNoteModel.cs:17</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">Nop.Web.Areas.Admin.Models.Orders.DisplayToCustomer</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">Nop.Services.Orders.IOrderService.InsertOrderNoteAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Nop.Web.Areas.Admin.Models.Orders.Note</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">Nop.Services.Orders.OrderProcessingService.MarkAsAuthorizedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync()</a>.</p>

</div>
</div>
<a id="ae5834b1db8b3e55653eb039c0bbd3be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5834b1db8b3e55653eb039c0bbd3be9">&#9670;&nbsp;</a></span>AwardRewardPointsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Award (earn) reward points (for placing a new order) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordflow">if</span> (order is <span class="keyword">null</span>)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            var totalForRewardPoints = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                .<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ac7d675bce9c7ec0501c77ad844727571">CalculateApplicableOrderTotalForRewardPoints</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ad5df520cde264bc84fa73ed2d60a4bc6">OrderShippingInclTax</a>, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            var points = totalForRewardPoints &gt; decimal.Zero ?</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a5336d950071e2d76647171ba3632c5f6">CalculateRewardPointsAsync</a>(customer, totalForRewardPoints) : 0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">if</span> (points == 0)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="comment">//Ensure that reward points were not added (earned) before. We should not add reward points if they were already earned for this order</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">RewardPointsHistoryEntryId</a>.HasValue)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="comment">//check whether delay is set</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            DateTime? activatingDate = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#aa22ef7d301261635dc85dda7f9ae0462">ActivationDelay</a> &gt; 0)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                var delayPeriod = (<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_customers.html#a5f5350b47ea551443d91ecb1a7cbeb37">RewardPointsActivatingDelayPeriod</a>)<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a5f9869d57abf0c54cdb48d76d3cdbbc8">ActivationDelayPeriodId</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                var delayInHours = delayPeriod.ToHours(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#aa22ef7d301261635dc85dda7f9ae0462">ActivationDelay</a>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                activatingDate = DateTime.UtcNow.AddHours(delayInHours);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="comment">//whether points validity is set</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            DateTime? endDate = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a0e4b1fa205f0395e5252342726f7fd74">PurchasesPointsValidity</a> &gt; 0)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                endDate = (activatingDate ?? DateTime.UtcNow).AddDays(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">_rewardPointsSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a0e4b1fa205f0395e5252342726f7fd74">PurchasesPointsValidity</a>.Value);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="comment">//add reward points</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">RewardPointsHistoryEntryId</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">AddRewardPointsHistoryEntryAsync</a>(customer, points, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;RewardPoints.Message.EarnedForOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">CustomOrderNumber</a>),</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                activatingDate: activatingDate, endDate: endDate);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings_html_a0e4b1fa205f0395e5252342726f7fd74"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a0e4b1fa205f0395e5252342726f7fd74">Nop.Core.Domain.Customers.RewardPointsSettings.PurchasesPointsValidity</a></div><div class="ttdeci">int? PurchasesPointsValidity</div><div class="ttdoc">Gets or sets a number of days when the points awarded for purchases will be valid</div><div class="ttdef"><b>Definition:</b> RewardPointsSettings.cs:53</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings_html_a5f9869d57abf0c54cdb48d76d3cdbbc8"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a5f9869d57abf0c54cdb48d76d3cdbbc8">Nop.Core.Domain.Customers.RewardPointsSettings.ActivationDelayPeriodId</a></div><div class="ttdeci">int ActivationDelayPeriodId</div><div class="ttdoc">Gets or sets the period of activation delay</div><div class="ttdef"><b>Definition:</b> RewardPointsSettings.cs:68</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings_html_aa22ef7d301261635dc85dda7f9ae0462"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#aa22ef7d301261635dc85dda7f9ae0462">Nop.Core.Domain.Customers.RewardPointsSettings.ActivationDelay</a></div><div class="ttdeci">int ActivationDelay</div><div class="ttdoc">Gets or sets a delay before activation points</div><div class="ttdef"><b>Definition:</b> RewardPointsSettings.cs:63</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a5707771d888f12d4a74e1e2eac82f720"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a></div><div class="ttdeci">decimal OrderTotal</div><div class="ttdoc">Gets or sets the order total</div><div class="ttdef"><b>Definition:</b> Order.cs:149</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a6eab9b1126cda0970526b3c4d9af9aed"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">Nop.Core.Domain.Orders.Order.StoreId</a></div><div class="ttdeci">int StoreId</div><div class="ttdoc">Gets or sets the store identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:24</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a7061d07eef94408c40f32832cf91aafa"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">Nop.Core.Domain.Orders.Order.CustomOrderNumber</a></div><div class="ttdeci">string CustomOrderNumber</div><div class="ttdoc">Gets or sets the custom order number without prefix</div><div class="ttdef"><b>Definition:</b> Order.cs:289</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a860f19c21ffa790750a0887b6ae14b85"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">Nop.Core.Domain.Orders.Order.RewardPointsHistoryEntryId</a></div><div class="ttdeci">int? RewardPointsHistoryEntryId</div><div class="ttdoc">Gets or sets the reward points history entry identifier when reward points were earned (gained) for p...</div><div class="ttdef"><b>Definition:</b> Order.cs:159</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_ad5df520cde264bc84fa73ed2d60a4bc6"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ad5df520cde264bc84fa73ed2d60a4bc6">Nop.Core.Domain.Orders.Order.OrderShippingInclTax</a></div><div class="ttdeci">decimal OrderShippingInclTax</div><div class="ttdoc">Gets or sets the order shipping (include tax)</div><div class="ttdef"><b>Definition:</b> Order.cs:114</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_afc851a198d160f4084e1398b3b4892c3"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a></div><div class="ttdeci">int CustomerId</div><div class="ttdoc">Gets or sets the customer identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:29</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a9d2dc587d116a6f656792c4f4cf22e09"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync</a></div><div class="ttdeci">Task&lt; Customer &gt; GetCustomerByIdAsync(int customerId)</div><div class="ttdoc">Gets a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_localization_1_1_i_localization_service_html_ac1ae5d2f3ddfea87ce1f780c9294656a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync</a></div><div class="ttdeci">Task&lt; string &gt; GetResourceAsync(string resourceKey)</div><div class="ttdoc">Gets a resource string based on the specified ResourceKey property.</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_aef9bab53153d827f38ce1b4f6f785112"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync</a></div><div class="ttdeci">Task UpdateOrderAsync(Order order)</div><div class="ttdoc">Updates the order</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_a5336d950071e2d76647171ba3632c5f6"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a5336d950071e2d76647171ba3632c5f6">Nop.Services.Orders.IOrderTotalCalculationService.CalculateRewardPointsAsync</a></div><div class="ttdeci">Task&lt; int &gt; CalculateRewardPointsAsync(Customer customer, decimal amount)</div><div class="ttdoc">Calculate how much reward points will be earned/reduced based on certain amount spent</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_ac7d675bce9c7ec0501c77ad844727571"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ac7d675bce9c7ec0501c77ad844727571">Nop.Services.Orders.IOrderTotalCalculationService.CalculateApplicableOrderTotalForRewardPoints</a></div><div class="ttdeci">decimal CalculateApplicableOrderTotalForRewardPoints(decimal orderShippingInclTax, decimal orderTotal)</div><div class="ttdoc">Calculate how order total (maximum amount) for which reward points could be earned/reduced</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service_html_a43b1fe16836f76602bf85aad1cef602e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">Nop.Services.Orders.IRewardPointService.AddRewardPointsHistoryEntryAsync</a></div><div class="ttdeci">Task&lt; int &gt; AddRewardPointsHistoryEntryAsync(Customer customer, int points, int storeId, string message=&quot;&quot;, Order usedWithOrder=null, decimal usedAmount=0M, DateTime? activatingDate=null, DateTime? endDate=null)</div><div class="ttdoc">Add reward points history record</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_customers_html_a5f5350b47ea551443d91ecb1a7cbeb37"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_customers.html#a5f5350b47ea551443d91ecb1a7cbeb37">Nop.Core.Domain.Customers.RewardPointsActivatingDelayPeriod</a></div><div class="ttdeci">RewardPointsActivatingDelayPeriod</div><div class="ttdoc">Represents the period of delay</div><div class="ttdef"><b>Definition:</b> RewardPointsActivatingDelayPeriod.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a974bdf4aa0452e9f43e8d9669acca975">Nop.Services.Orders.OrderProcessingService._rewardPointsSettings</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#aa22ef7d301261635dc85dda7f9ae0462">Nop.Core.Domain.Customers.RewardPointsSettings.ActivationDelay</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a5f9869d57abf0c54cdb48d76d3cdbbc8">Nop.Core.Domain.Customers.RewardPointsSettings.ActivationDelayPeriodId</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">Nop.Services.Orders.IRewardPointService.AddRewardPointsHistoryEntryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ac7d675bce9c7ec0501c77ad844727571">Nop.Services.Orders.IOrderTotalCalculationService.CalculateApplicableOrderTotalForRewardPoints()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a5336d950071e2d76647171ba3632c5f6">Nop.Services.Orders.IOrderTotalCalculationService.CalculateRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">Nop.Core.Domain.Orders.Order.CustomOrderNumber</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ad5df520cde264bc84fa73ed2d60a4bc6">Nop.Core.Domain.Orders.Order.OrderShippingInclTax</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html#a0e4b1fa205f0395e5252342726f7fd74">Nop.Core.Domain.Customers.RewardPointsSettings.PurchasesPointsValidity</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">Nop.Core.Domain.Orders.Order.RewardPointsHistoryEntryId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">Nop.Core.Domain.Orders.Order.StoreId</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="ae0701c7a5f62731bae805fbb414351c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0701c7a5f62731bae805fbb414351c6">&#9670;&nbsp;</a></span>CanCancelOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanCancelOrder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether cancel is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether cancel is allowed</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a4f5e84d239204b2e72103a058096ac48">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a1da26c037c2fa677811f7ae1b6748286"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a></div><div class="ttdeci">OrderStatus OrderStatus</div><div class="ttdoc">Gets or sets the order status</div><div class="ttdef"><b>Definition:</b> Order.cs:304</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_orders_html_a110e048090478f8f42845b47c90139e8"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">Nop.Core.Domain.Orders.OrderStatus</a></div><div class="ttdeci">OrderStatus</div><div class="ttdoc">Represents an order status enumeration</div><div class="ttdef"><b>Definition:</b> OrderStatus.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a> e <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a01c6093577534d85c30bd7f0d79587df">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeCancelledWhenOrderStatusIsNotCanCelledYet()</a>.</p>

</div>
</div>
<a id="ac0875883e79f8cf6f926d30b11c9d0a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0875883e79f8cf6f926d30b11c9d0a3">&#9670;&nbsp;</a></span>CanCancelRecurringPaymentAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanCancelRecurringPaymentAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Customer</a>&#160;</td>
          <td class="paramname"><em>customerToValidate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether a customer can cancel recurring payment </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">customerToValidate</td><td>Customer</td></tr>
    <tr><td class="paramname">recurringPayment</td><td>Recurring Payment</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the value indicating whether a customer can cancel recurring payment </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a648cbf64534695f3612c9c289343b138">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <span class="keywordflow">if</span> (recurringPayment is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <span class="keywordflow">if</span> (customerToValidate is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            var initialOrder = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">InitialOrderId</a>);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <span class="keywordflow">if</span> (initialOrder is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(initialOrder.CustomerId);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            <span class="keywordflow">if</span> (customer is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <span class="keywordflow">if</span> (initialOrder.OrderStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a0946a763b35b15dc03118ec61dffc1f9">IsAdminAsync</a>(customerToValidate))</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                <span class="keywordflow">if</span> (customer.Id != customerToValidate.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">GetNextPaymentDateAsync</a>(recurringPayment) is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_a5095922475cf4b1ea4e3f8eeb62cad14"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">Nop.Core.Domain.Orders.RecurringPayment.InitialOrderId</a></div><div class="ttdeci">int InitialOrderId</div><div class="ttdoc">Gets or sets the initial order identifier</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:50</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_abb5180e1683480f5550d2ca71a25b516"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">Nop.Services.Orders.OrderProcessingService.GetNextPaymentDateAsync</a></div><div class="ttdeci">virtual async Task&lt; DateTime?&gt; GetNextPaymentDateAsync(RecurringPayment recurringPayment)</div><div class="ttdoc">Gets the next payment date</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:3187</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a0946a763b35b15dc03118ec61dffc1f9"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a0946a763b35b15dc03118ec61dffc1f9">Nop.Services.Customers.ICustomerService.IsAdminAsync</a></div><div class="ttdeci">Task&lt; bool &gt; IsAdminAsync(Customer customer, bool onlyActiveCustomerRoles=true)</div><div class="ttdoc">Gets a value indicating whether customer is administrator</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a75bc6860ccdf693731b275018e462978"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync</a></div><div class="ttdeci">Task&lt; Order &gt; GetOrderByIdAsync(int orderId)</div><div class="ttdoc">Gets an order</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">Nop.Services.Orders.OrderProcessingService.GetNextPaymentDateAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">Nop.Core.Domain.Orders.RecurringPayment.InitialOrderId</a> e <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a0946a763b35b15dc03118ec61dffc1f9">Nop.Services.Customers.ICustomerService.IsAdminAsync()</a>.</p>

</div>
</div>
<a id="a7af3ca11a1d78bcbba7679447c03e5a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7af3ca11a1d78bcbba7679447c03e5a9">&#9670;&nbsp;</a></span>CanCaptureAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanCaptureAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether capture from admin panel is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a value indicating whether capture from admin panel is allowed </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a6c9b16f0630eb463e26a1e5b1aee373c">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled ||</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Pending)</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Authorized &amp;&amp;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ac4114c61ee93cea4b4ebe74a8124cc67">SupportCaptureAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">PaymentMethodSystemName</a>))</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a1a4dc20567fdbe33a1f5a1a6ad9a71a2"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">Nop.Core.Domain.Orders.Order.PaymentMethodSystemName</a></div><div class="ttdeci">string PaymentMethodSystemName</div><div class="ttdoc">Gets or sets the payment method system name</div><div class="ttdef"><b>Definition:</b> Order.cs:69</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a1ef8e44cb2bff7de9ab65a583f03252c"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a></div><div class="ttdeci">PaymentStatus PaymentStatus</div><div class="ttdoc">Gets or sets the payment status</div><div class="ttdef"><b>Definition:</b> Order.cs:313</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_ac4114c61ee93cea4b4ebe74a8124cc67"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ac4114c61ee93cea4b4ebe74a8124cc67">Nop.Services.Payments.IPaymentService.SupportCaptureAsync</a></div><div class="ttdeci">Task&lt; bool &gt; SupportCaptureAsync(string paymentMethodSystemName)</div><div class="ttdoc">Gets a value indicating whether capture is supported by payment method</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_payments_html_a5af4d422e00c0b088770533afd7d2c22"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">Nop.Core.Domain.Payments.PaymentStatus</a></div><div class="ttdeci">PaymentStatus</div><div class="ttdoc">Represents a payment status enumeration</div><div class="ttdef"><b>Definition:</b> PaymentStatus.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">Nop.Core.Domain.Orders.Order.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a> e <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ac4114c61ee93cea4b4ebe74a8124cc67">Nop.Services.Payments.IPaymentService.SupportCaptureAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a> e <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a65c85e38b8c4b96871ef2e554ff1c148">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeCapturedWhenOrderStatusIsNotCancelledOrPendingAndPaymentStatusIsAuthorizedAndPaymentModuleSupportsCapture()</a>.</p>

</div>
</div>
<a id="a94d9d92a027d9c60f54dc0e1cda6a8a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94d9d92a027d9c60f54dc0e1cda6a8a8">&#9670;&nbsp;</a></span>CancelOrderAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.CancelOrderAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>notifyCustomer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cancels order </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">notifyCustomer</td><td>True to notify customer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a842bb5f1ccc4cbe39d0dc91d6641a8ec">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae0701c7a5f62731bae805fbb414351c6">CanCancelOrder</a>(order))</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cannot do cancel for order.&quot;</span>);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="comment">//cancel order</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">SetOrderStatusAsync</a>(order, <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled, notifyCustomer);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been cancelled&quot;</span>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <span class="comment">//return (add) back redeemded reward points</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">ReturnBackRedeemedRewardPointsAsync</a>(order);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            <span class="comment">//delete gift card usage history</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a90ead625c4a97218450209ca92d16965">DeleteGiftCardUsageHistory</a>) </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#ad0ab08c30141312813dcdfc7af9320cd">DeleteGiftCardUsageHistoryAsync</a>(order);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="comment">//cancel recurring payments</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            var recurringPayments = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aab18b8ee56cc32d37977e38d032a36d7">SearchRecurringPaymentsAsync</a>(initialOrderId: order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <span class="keywordflow">foreach</span> (var rp <span class="keywordflow">in</span> recurringPayments) </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">CancelRecurringPaymentAsync</a>(rp);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <span class="comment">//Adjust inventory for already shipped shipments</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="comment">//only products with &quot;use multiple warehouses&quot;</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            <span class="keywordflow">foreach</span> (var shipment <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#a6602d86cd5ebf33efe57ee9dc4e77327">GetShipmentsByOrderIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                <span class="keywordflow">foreach</span> (var shipmentItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">GetShipmentItemsByShipmentIdAsync</a>(shipment.Id))</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                    var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">GetProductByOrderItemIdAsync</a>(shipmentItem.OrderItemId);</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                    <span class="keywordflow">if</span> (product is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#aff4738a330663b5eb45a204405491967">ReverseBookedInventoryAsync</a>(product, shipmentItem,</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                        <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.CancelOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>));</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="comment">//Adjust inventory</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            <span class="keywordflow">foreach</span> (var orderItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(orderItem.ProductId);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">AdjustInventoryAsync</a>(product, orderItem.Quantity, orderItem.AttributesXml,</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.CancelOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>));</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_cancelled_event.html">OrderCancelledEvent</a>(order));</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_cancelled_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_cancelled_event.html">Nop.Core.Domain.Orders.OrderCancelledEvent</a></div><div class="ttdoc">Order cancelled event</div><div class="ttdef"><b>Definition:</b> OrderCancelledEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a90ead625c4a97218450209ca92d16965"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a90ead625c4a97218450209ca92d16965">Nop.Core.Domain.Orders.OrderSettings.DeleteGiftCardUsageHistory</a></div><div class="ttdeci">bool DeleteGiftCardUsageHistory</div><div class="ttdoc">Gets or sets a value indicating whether the gift card usage history have to delete when an order is c...</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:169</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_nop_exception_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_nop_exception.html">Nop.Core.NopException</a></div><div class="ttdoc">Represents errors that occur during application execution</div><div class="ttdef"><b>Definition:</b> NopException.cs:11</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a234b127560732053f0c1ab698604c408"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync</a></div><div class="ttdeci">virtual async Task&lt; IList&lt; string &gt; &gt; CancelRecurringPaymentAsync(RecurringPayment recurringPayment)</div><div class="ttdoc">Cancels a recurring payment</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2021</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab4879004f9159f7339cf04d1e2478178"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync</a></div><div class="ttdeci">virtual async Task ReturnBackRedeemedRewardPointsAsync(Order order)</div><div class="ttdoc">Return back redeemed reward points to a customer (spent when placing an order)</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:989</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ae0701c7a5f62731bae805fbb414351c6"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae0701c7a5f62731bae805fbb414351c6">Nop.Services.Orders.OrderProcessingService.CanCancelOrder</a></div><div class="ttdeci">virtual bool CanCancelOrder(Order order)</div><div class="ttdoc">Gets a value indicating whether cancel is allowed</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2271</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_af7b69d22b846ca3ea12be3a4fd016a49"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync</a></div><div class="ttdeci">virtual async Task AddOrderNoteAsync(Order order, string note)</div><div class="ttdoc">Add order note</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:383</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_afa36dec6110e6877538e59656b5fbc67"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync</a></div><div class="ttdeci">virtual async Task SetOrderStatusAsync(Order order, OrderStatus os, bool notifyCustomer)</div><div class="ttdoc">Sets an order status</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1054</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_service_html_ab448923cc8826840ac6cd1558a0f2a9d"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync</a></div><div class="ttdeci">Task&lt; Product &gt; GetProductByIdAsync(int productId)</div><div class="ttdoc">Gets product</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_service_html_af768f5da7a64d4bd0229f1ebbe727d87"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">Nop.Services.Catalog.IProductService.AdjustInventoryAsync</a></div><div class="ttdeci">Task AdjustInventoryAsync(Product product, int quantityToChange, string attributesXml=&quot;&quot;, string message=&quot;&quot;)</div><div class="ttdoc">Adjust inventory</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_service_html_aff4738a330663b5eb45a204405491967"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#aff4738a330663b5eb45a204405491967">Nop.Services.Catalog.IProductService.ReverseBookedInventoryAsync</a></div><div class="ttdeci">Task&lt; int &gt; ReverseBookedInventoryAsync(Product product, ShipmentItem shipmentItem, string message=&quot;&quot;)</div><div class="ttdoc">Reverse booked inventory (if acceptable)</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_ad0ab08c30141312813dcdfc7af9320cd"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#ad0ab08c30141312813dcdfc7af9320cd">Nop.Services.Orders.IGiftCardService.DeleteGiftCardUsageHistoryAsync</a></div><div class="ttdeci">Task DeleteGiftCardUsageHistoryAsync(Order order)</div><div class="ttdoc">Delete gift card usage history</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a7feff9a701ac531db9f83037a0564b87"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">Nop.Services.Orders.IOrderService.GetProductByOrderItemIdAsync</a></div><div class="ttdeci">Task&lt; Product &gt; GetProductByOrderItemIdAsync(int orderItemId)</div><div class="ttdoc">Gets a product of specify order item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_aab18b8ee56cc32d37977e38d032a36d7"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aab18b8ee56cc32d37977e38d032a36d7">Nop.Services.Orders.IOrderService.SearchRecurringPaymentsAsync</a></div><div class="ttdeci">Task&lt; IPagedList&lt; RecurringPayment &gt; &gt; SearchRecurringPaymentsAsync(int storeId=0, int customerId=0, int initialOrderId=0, OrderStatus? initialOrderStatus=null, int pageIndex=0, int pageSize=int.MaxValue, bool showHidden=false)</div><div class="ttdoc">Search recurring payments</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_aea8bd5179d4144f1fd3da8d17a761de2"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync</a></div><div class="ttdeci">Task&lt; IList&lt; OrderItem &gt; &gt; GetOrderItemsAsync(int orderId, bool? isNotReturnable=null, bool? isShipEnabled=null, int vendorId=0)</div><div class="ttdoc">Gets a list items of order</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service_html_a6602d86cd5ebf33efe57ee9dc4e77327"><div class="ttname"><a href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#a6602d86cd5ebf33efe57ee9dc4e77327">Nop.Services.Shipping.IShipmentService.GetShipmentsByOrderIdAsync</a></div><div class="ttdeci">Task&lt; IList&lt; Shipment &gt; &gt; GetShipmentsByOrderIdAsync(int orderId, bool? shipped=null, int vendorId=0)</div><div class="ttdoc">Gets a list of order shipments</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service_html_ab6aa8c5c24fcd7f12da2c5be0aae16a1"><div class="ttname"><a href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">Nop.Services.Shipping.IShipmentService.GetShipmentItemsByShipmentIdAsync</a></div><div class="ttdeci">Task&lt; IList&lt; ShipmentItem &gt; &gt; GetShipmentItemsByShipmentIdAsync(int shipmentId)</div><div class="ttdoc">Gets a shipment items of shipment</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">Nop.Services.Catalog.IProductService.AdjustInventoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae0701c7a5f62731bae805fbb414351c6">Nop.Services.Orders.OrderProcessingService.CanCancelOrder()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a90ead625c4a97218450209ca92d16965">Nop.Core.Domain.Orders.OrderSettings.DeleteGiftCardUsageHistory</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#ad0ab08c30141312813dcdfc7af9320cd">Nop.Services.Orders.IGiftCardService.DeleteGiftCardUsageHistoryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">Nop.Services.Orders.IOrderService.GetProductByOrderItemIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">Nop.Services.Shipping.IShipmentService.GetShipmentItemsByShipmentIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#a6602d86cd5ebf33efe57ee9dc4e77327">Nop.Services.Shipping.IShipmentService.GetShipmentsByOrderIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#aff4738a330663b5eb45a204405491967">Nop.Services.Catalog.IProductService.ReverseBookedInventoryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aab18b8ee56cc32d37977e38d032a36d7">Nop.Services.Orders.IOrderService.SearchRecurringPaymentsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="a234b127560732053f0c1ab698604c408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234b127560732053f0c1ab698604c408">&#9670;&nbsp;</a></span>CancelRecurringPaymentAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cancels a recurring payment </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">recurringPayment</td><td>Recurring payment</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a1cb0979376feeb18f0dea77bdb190c50">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            <span class="keywordflow">if</span> (recurringPayment == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(recurringPayment));</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            var initialOrder = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">InitialOrderId</a>);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <span class="keywordflow">if</span> (initialOrder == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> List&lt;string&gt; { <span class="stringliteral">&quot;Initial order could not be loaded&quot;</span> };</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;            var request = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_request.html">CancelRecurringPaymentRequest</a>();</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_result.html">CancelRecurringPaymentResult</a> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                request.Order = initialOrder;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa621e3969430087afb0b96eeaf6bfbf0">CancelRecurringPaymentAsync</a>(request);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                    <span class="comment">//update recurring payment</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                    recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">IsActive</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">UpdateRecurringPaymentAsync</a>(recurringPayment);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                    <span class="comment">//add a note</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">InsertOrderNoteAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_note.html">OrderNote</a></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                    {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = initialOrder.Id,</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Note</a> = <span class="stringliteral">&quot;Recurring payment has been cancelled&quot;</span>,</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">DisplayToCustomer</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                        CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                    });</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                    <span class="comment">//notify a store owner</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                        .<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aab88e81da64272e24041a03b21dd4cde">SendRecurringPaymentCancelledStoreOwnerNotificationAsync</a>(recurringPayment,</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;            {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_result.html">CancelRecurringPaymentResult</a>();</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError($<span class="stringliteral">&quot;Error: {exc.Message}. Full exception: {exc}&quot;</span>);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            <span class="comment">//process errors</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            var error = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count; i++)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                error += $<span class="stringliteral">&quot;Error {i}: {result.Errors[i]}&quot;</span>;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                <span class="keywordflow">if</span> (i != <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count - 1)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                    error += <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(error))</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">InsertOrderNoteAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_note.html">OrderNote</a></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = initialOrder.Id,</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Note</a> = $<span class="stringliteral">&quot;Unable to cancel recurring payment. {error}&quot;</span>,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">DisplayToCustomer</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            });</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <span class="comment">//log it</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            var logError = $<span class="stringliteral">&quot;Error cancelling recurring payment. Order #{initialOrder.Id}. Error: {error}&quot;</span>;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">InsertLogAsync</a>(<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">LogLevel</a>.Error, logError, logError);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings_html_aad81758f66176a496313e75eadb67aea"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a></div><div class="ttdeci">int DefaultAdminLanguageId</div><div class="ttdoc">Default admin area language identifier</div><div class="ttdef"><b>Definition:</b> LocalizationSettings.cs:13</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_a4b79451041f31572807357c834e61054"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">Nop.Core.Domain.Orders.RecurringPayment.IsActive</a></div><div class="ttdeci">bool IsActive</div><div class="ttdoc">Gets or sets a value indicating whether the payment is active</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:35</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_request_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_request.html">Nop.Services.Payments.CancelRecurringPaymentRequest</a></div><div class="ttdoc">Represents a CancelRecurringPaymentResult</div><div class="ttdef"><b>Definition:</b> CancelRecurringPaymentRequest.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_result_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_cancel_recurring_payment_result.html">Nop.Services.Payments.CancelRecurringPaymentResult</a></div><div class="ttdoc">Cancel recurring payment result</div><div class="ttdef"><b>Definition:</b> CancelRecurringPaymentResult.cs:10</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_logging_1_1_i_logger_html_a6211543383b66a745408896a80310a40"><div class="ttname"><a href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync</a></div><div class="ttdeci">Task&lt; Log &gt; InsertLogAsync(LogLevel logLevel, string shortMessage, string fullMessage=&quot;&quot;, Customer customer=null)</div><div class="ttdoc">Inserts a log item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_aab88e81da64272e24041a03b21dd4cde"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aab88e81da64272e24041a03b21dd4cde">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentCancelledStoreOwnerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendRecurringPaymentCancelledStoreOwnerNotificationAsync(RecurringPayment recurringPayment, int languageId)</div><div class="ttdoc">Sends a &quot;Recurring payment cancelled&quot; notification to a store owner</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a46d2342e8308951f8cd55ead51dff68f"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">Nop.Services.Orders.IOrderService.UpdateRecurringPaymentAsync</a></div><div class="ttdeci">Task UpdateRecurringPaymentAsync(RecurringPayment recurringPayment)</div><div class="ttdoc">Updates the recurring payment</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_aa621e3969430087afb0b96eeaf6bfbf0"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa621e3969430087afb0b96eeaf6bfbf0">Nop.Services.Payments.IPaymentService.CancelRecurringPaymentAsync</a></div><div class="ttdeci">Task&lt; CancelRecurringPaymentResult &gt; CancelRecurringPaymentAsync(CancelRecurringPaymentRequest cancelPaymentRequest)</div><div class="ttdoc">Cancels a recurring payment</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_logging_html_ab594ab9c457c9e33971ebd84419e8aa1"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">Nop.Core.Domain.Logging.LogLevel</a></div><div class="ttdeci">LogLevel</div><div class="ttdoc">Represents a log level</div><div class="ttdef"><b>Definition:</b> LogLevel.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_models_1_1_blogs_html_a6cc3986434c188bc64f7d71789d4a5c8"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a></div><div class="ttdeci">return result</div><div class="ttdef"><b>Definition:</b> BlogPagingFilteringModel.cs:21</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa621e3969430087afb0b96eeaf6bfbf0">Nop.Services.Payments.IPaymentService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a97fa178b181ac63a4b628d63c4b01a2b">Nop.Web.Areas.Admin.Models.Orders.DisplayToCustomer</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">Nop.Core.Domain.Orders.RecurringPayment.InitialOrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a8050588c304b2eb1124db700048e9aca">Nop.Services.Orders.IOrderService.InsertOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">Nop.Core.Domain.Orders.RecurringPayment.IsActive</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a09633445d2625eaf1bcdb22508ee225d">Nop.Web.Areas.Admin.Models.Orders.Note</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aab88e81da64272e24041a03b21dd4cde">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentCancelledStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">Nop.Services.Orders.IOrderService.UpdateRecurringPaymentAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a411ae4434d370451aaf29c57bd7cc543"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411ae4434d370451aaf29c57bd7cc543">&#9670;&nbsp;</a></span>CanMarkOrderAsAuthorized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanMarkOrderAsAuthorized </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether order can be marked as authorized </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether order can be marked as authorized</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a145d31a1e9c23c48548b44e5e3740e2e">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Pending)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#aec3d791a1758290864601a5bead7c793">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeMarkedAsAuthorizedWhenOrderStatusIsNotCancelledAndPaymentStatusIsPending()</a>.</p>

</div>
</div>
<a id="a3d275e26976b46270de28874bbb7beec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d275e26976b46270de28874bbb7beec">&#9670;&nbsp;</a></span>CanMarkOrderAsPaid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanMarkOrderAsPaid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether order can be marked as paid </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether order can be marked as paid</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a1f7dee67df2bf3480efdbd5ab0aa83d2">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160; </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid ||</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Refunded ||</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Voided)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160; </div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#abe9fdcab28ccd55cb3af4f2131f2e82c">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBeMarkedAsPaidWhenOrderStatusIsCancelledOrPaymentStatusIsPaidOrRefundedOrVoided()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync()</a>.</p>

</div>
</div>
<a id="af5c1027453ac2c150e4f5b5e34022883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c1027453ac2c150e4f5b5e34022883">&#9670;&nbsp;</a></span>CanPartiallyRefundAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal&#160;</td>
          <td class="paramname"><em>amountToRefund</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether partial refund from admin panel is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">amountToRefund</td><td>Amount to refund</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a value indicating whether refund from admin panel is allowed </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a6338bbb6511b727f5574e1a4462f8a0e">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            <span class="comment">//uncomment the lines below in order to allow this operation for cancelled orders</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            <span class="comment">//    return false;</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            var canBeRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> - order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a>;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">if</span> (canBeRefunded &lt;= decimal.Zero)</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160; </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            <span class="keywordflow">if</span> (amountToRefund &gt; canBeRefunded)</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            <span class="keywordflow">if</span> ((order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid ||</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.PartiallyRefunded) &amp;&amp;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a21dea00d8356fce31ec403fefc3ddf05">SupportPartiallyRefundAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">PaymentMethodSystemName</a>))</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a9b339205739d7323f10102549276d3b2"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a></div><div class="ttdeci">decimal RefundedAmount</div><div class="ttdoc">Gets or sets the refunded amount</div><div class="ttdef"><b>Definition:</b> Order.cs:154</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a21dea00d8356fce31ec403fefc3ddf05"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a21dea00d8356fce31ec403fefc3ddf05">Nop.Services.Payments.IPaymentService.SupportPartiallyRefundAsync</a></div><div class="ttdeci">Task&lt; bool &gt; SupportPartiallyRefundAsync(string paymentMethodSystemName)</div><div class="ttdoc">Gets a value indicating whether partial refund is supported by payment method</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">Nop.Core.Domain.Orders.Order.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a> e <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a21dea00d8356fce31ec403fefc3ddf05">Nop.Services.Payments.IPaymentService.SupportPartiallyRefundAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a3a7a34559eab6333658e37f2e78c6522">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBePartiallyRefundedWhenAmountToRefundIsGreaterThanAmountThatCanBeRefunded()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a28977e6b5f25ae08614cdf5fb0bd158a">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBePartiallyRefundedWhenPaymentStatusIsPaidOrPartiallyRefundedAndPaymentModuleSupportsPartialRefund()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>.</p>

</div>
</div>
<a id="a8d89f4c048a18b4790969a296a4d9952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d89f4c048a18b4790969a296a4d9952">&#9670;&nbsp;</a></span>CanPartiallyRefundOffline()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundOffline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal&#160;</td>
          <td class="paramname"><em>amountToRefund</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether order can be marked as partially refunded </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">amountToRefund</td><td>Amount to refund</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether order can be marked as partially refunded</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a5e93c72b05d9b0df952fc0e5f5e7ce6b">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160; </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <span class="comment">//uncomment the lines below in order to allow this operation for cancelled orders</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            <span class="comment">//    return false;</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; </div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;            var canBeRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> - order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a>;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            <span class="keywordflow">if</span> (canBeRefunded &lt;= decimal.Zero)</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;            <span class="keywordflow">if</span> (amountToRefund &gt; canBeRefunded)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160; </div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid ||</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.PartiallyRefunded)</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160; </div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a00b3de769a0eab4f154ebe596db25987">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBePartiallyRefundedOfflineWhenAmountToRefundIsGreaterThanAmountThatCanBeRefunded()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a509bbbc3b5661c3f38ed55e730221d7b">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBePartiallyRefundedOfflineWhenPaymentStatusIsPaidOrPartiallyRefunded()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>.</p>

</div>
</div>
<a id="a5a51e3689da5d8de248f4d4505f651f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a51e3689da5d8de248f4d4505f651f6">&#9670;&nbsp;</a></span>CanRefundAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanRefundAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether refund from admin panel is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a value indicating whether refund from admin panel is allowed </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#ae069158ce1d4a48fb2af44f07540a8a3">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <span class="comment">//refund cannot be made if previously a partial refund has been already done. only other partial refund can be made in this case</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> &gt; decimal.Zero)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="comment">//uncomment the lines below in order to disallow this operation for cancelled orders</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            <span class="comment">//    return false;</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid &amp;&amp;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aac25bcffd6598b31a9ca21c0d7d1f4f8">SupportRefundAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">PaymentMethodSystemName</a>))</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_aac25bcffd6598b31a9ca21c0d7d1f4f8"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aac25bcffd6598b31a9ca21c0d7d1f4f8">Nop.Services.Payments.IPaymentService.SupportRefundAsync</a></div><div class="ttdeci">Task&lt; bool &gt; SupportRefundAsync(string paymentMethodSystemName)</div><div class="ttdoc">Gets a value indicating whether refund is supported by payment method</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">Nop.Core.Domain.Orders.Order.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a> e <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aac25bcffd6598b31a9ca21c0d7d1f4f8">Nop.Services.Payments.IPaymentService.SupportRefundAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#ad0e2447f24f7302bffa80a7ea27eae64">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBeRefundedWhenOrderTotalIsZero()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a35bc45c05afcdac6c08b4bd1abe6fef3">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeRefundedWhenPaymentStatusIsPaidAndPaymentModuleSupportsRefund()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>.</p>

</div>
</div>
<a id="a2de203d7ac5f4bb664036c72eec2f772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de203d7ac5f4bb664036c72eec2f772">&#9670;&nbsp;</a></span>CanRefundOffline()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanRefundOffline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether order can be marked as refunded </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether order can be marked as refunded</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#adbb3e924a5983c61c70aad629e9276dc">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        {</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            <span class="comment">//refund cannot be made if previously a partial refund has been already done. only other partial refund can be made in this case</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> &gt; decimal.Zero)</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            <span class="comment">//uncomment the lines below in order to disallow this operation for cancelled orders</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            <span class="comment">//     return false;</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160; </div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a3515a2d4fc7c9ebf1b38031bfc654bb9">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBeRefundedOfflineWhenOrdertotalIsZero()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a128fecbe9774eabbc8d08be508e774a0">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeRefundedOfflineWhenPaymentStatusIsPaid()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>.</p>

</div>
</div>
<a id="aeb836ba11d1d94f76d792a351ee53cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb836ba11d1d94f76d792a351ee53cba">&#9670;&nbsp;</a></span>CanRetryLastRecurringPaymentAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanRetryLastRecurringPaymentAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Customer</a>&#160;</td>
          <td class="paramname"><em>customer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether a customer can retry last failed recurring payment </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">customer</td><td>Customer</td></tr>
    <tr><td class="paramname">recurringPayment</td><td>Recurring Payment</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the rue if a customer can retry payment; otherwise false </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a26b76294ab65eea84737723eadd05921">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keywordflow">if</span> (recurringPayment == <span class="keyword">null</span> || customer == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            var order = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">InitialOrderId</a>);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            <span class="keywordflow">if</span> (order is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            var orderCustomer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.CustomerId);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            <span class="keywordflow">if</span> (order.OrderStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160; </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            <span class="keywordflow">if</span> (!recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">LastPaymentFailed</a> || await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">GetRecurringPaymentTypeAsync</a>(order.PaymentMethodSystemName) != <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Manual)</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            <span class="keywordflow">if</span> (orderCustomer == <span class="keyword">null</span> || (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a0946a763b35b15dc03118ec61dffc1f9">IsAdminAsync</a>(customer) &amp;&amp; orderCustomer.Id != customer.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_aa76fcbec98f282a4dbb17c534d55c16c"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">Nop.Core.Domain.Orders.RecurringPayment.LastPaymentFailed</a></div><div class="ttdeci">bool LastPaymentFailed</div><div class="ttdoc">Gets or sets a value indicating whether the last payment failed</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:40</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a28a938d0a5192f91ac7024c081b232e9"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">Nop.Services.Payments.IPaymentService.GetRecurringPaymentTypeAsync</a></div><div class="ttdeci">Task&lt; RecurringPaymentType &gt; GetRecurringPaymentTypeAsync(string paymentMethodSystemName)</div><div class="ttdoc">Gets a recurring payment type of payment method</div></div>
<div class="ttc" id="anamespace_nop_1_1_services_1_1_payments_html_aef3ff9dcc532279768359b7656e72cc7"><div class="ttname"><a href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">Nop.Services.Payments.RecurringPaymentType</a></div><div class="ttdeci">RecurringPaymentType</div><div class="ttdoc">Represents a recurring payment type</div><div class="ttdef"><b>Definition:</b> RecurringPaymentType.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">Nop.Services.Payments.IPaymentService.GetRecurringPaymentTypeAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">Nop.Core.Domain.Orders.RecurringPayment.InitialOrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a0946a763b35b15dc03118ec61dffc1f9">Nop.Services.Customers.ICustomerService.IsAdminAsync()</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">Nop.Core.Domain.Orders.RecurringPayment.LastPaymentFailed</a>.</p>

</div>
</div>
<a id="ad97456f8075170348beaad8f57bd56e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad97456f8075170348beaad8f57bd56e7">&#9670;&nbsp;</a></span>CanVoidAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.CanVoidAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether async Task from admin panel is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a value indicating whether async Task from admin panel is allowed </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a93cf66d5d6092597fbf4a37079e70928">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;            <span class="comment">//uncomment the lines below in order to allow this operation for cancelled orders</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;            <span class="comment">//    return false;</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Authorized &amp;&amp;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a378d87b846f0d35d1f66f5d0360c50a7">SupportVoidAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">PaymentMethodSystemName</a>))</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160; </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a378d87b846f0d35d1f66f5d0360c50a7"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a378d87b846f0d35d1f66f5d0360c50a7">Nop.Services.Payments.IPaymentService.SupportVoidAsync</a></div><div class="ttdeci">Task&lt; bool &gt; SupportVoidAsync(string paymentMethodSystemName)</div><div class="ttdoc">Gets a value indicating whether void is supported by payment method</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1a4dc20567fdbe33a1f5a1a6ad9a71a2">Nop.Core.Domain.Orders.Order.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a> e <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a378d87b846f0d35d1f66f5d0360c50a7">Nop.Services.Payments.IPaymentService.SupportVoidAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#ad371cde36cbe47fd66f15dd4783283bc">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBeVoidedWhenOrderTotalIsZero()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a9412374ab6c96216e7693bba31ef583b">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeVoidedWhenPaymentStatusIsAuthorizedAndPaymentModuleSupportsVoid()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a>.</p>

</div>
</div>
<a id="a0c099f5c6bff8c808ad6d86bcf7e8163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c099f5c6bff8c808ad6d86bcf7e8163">&#9670;&nbsp;</a></span>CanVoidOffline()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Nop.Services.Orders.OrderProcessingService.CanVoidOffline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether order can be marked as async Tasked </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A value indicating whether order can be marked as async Tasked</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a9525f3983a5fde2adb138c1fda7a2ce2">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        {</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == decimal.Zero)</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; </div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            <span class="comment">//uncomment the lines below in order to allow this operation for cancelled orders</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            <span class="comment">//if (order.OrderStatus == OrderStatus.Cancelled)</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            <span class="comment">//    return false;</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Authorized)</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160; </div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a718ab39dc16cf3e24572d69f9af0c4c3">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCannotBeVoidedOfflineWhenOrderTotalIsZero()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a05d3542b0f4b668a539089ac5db5017f">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.EnsureOrderCanOnlyBeVoidedOfflineWhenPaymentStatusIsAuthorized()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync()</a>.</p>

</div>
</div>
<a id="a4ed73679d36b7b6be34f30cc26e12dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed73679d36b7b6be34f30cc26e12dff">&#9670;&nbsp;</a></span>CaptureAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.CaptureAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Capture an order (from admin panel) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a list of errors; empty list if no errors </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#af8745505eb6a7d6f5d2591f8db523c0a">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">CanCaptureAsync</a>(order))</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cannot do capture for order.&quot;</span>);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            var request = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_capture_payment_request.html">CapturePaymentRequest</a>();</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_capture_payment_result.html">CapturePaymentResult</a> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                <span class="comment">//old info from placing order</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                request.Order = order;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#acdb2f9127ddea3c4121026adec3f4d32">CaptureAsync</a>(request);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                    var paidDate = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">PaidDateUtc</a>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                        paidDate = DateTime.UtcNow;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a767b0713af5f7bd040aef9ebf7b2c7e9">CaptureTransactionId</a> = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.CaptureTransactionId;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a877245122aa732f18b3a1149f2799a41">CaptureTransactionResult</a> = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.CaptureTransactionResult;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">PaidDateUtc</a> = paidDate;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                    <span class="comment">//add a note</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been captured&quot;</span>);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                    <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid) </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">ProcessOrderPaidAsync</a>(order);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                }</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            {</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_capture_payment_result.html">CapturePaymentResult</a>();</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError($<span class="stringliteral">&quot;Error: {exc.Message}. Full exception: {exc}&quot;</span>);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            <span class="comment">//process errors</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;            var error = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count; i++)</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                error += $<span class="stringliteral">&quot;Error {i}: {result.Errors[i]}&quot;</span>;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                <span class="keywordflow">if</span> (i != <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count - 1)</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                    error += <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(error))</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Unable to capture order. {error}&quot;</span>);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="comment">//log it</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            var logError = $<span class="stringliteral">&quot;Error capturing order #{order.Id}. Error: {error}&quot;</span>;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">InsertLogAsync</a>(<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">LogLevel</a>.Error, logError, logError);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a767b0713af5f7bd040aef9ebf7b2c7e9"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a767b0713af5f7bd040aef9ebf7b2c7e9">Nop.Core.Domain.Orders.Order.CaptureTransactionId</a></div><div class="ttdeci">string CaptureTransactionId</div><div class="ttdoc">Gets or sets the capture transaction identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:244</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a877245122aa732f18b3a1149f2799a41"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a877245122aa732f18b3a1149f2799a41">Nop.Core.Domain.Orders.Order.CaptureTransactionResult</a></div><div class="ttdeci">string CaptureTransactionResult</div><div class="ttdoc">Gets or sets the capture transaction result</div><div class="ttdef"><b>Definition:</b> Order.cs:249</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_ac8c537be82fe4c7c7550efe0c203f03a"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">Nop.Core.Domain.Orders.Order.PaidDateUtc</a></div><div class="ttdeci">DateTime? PaidDateUtc</div><div class="ttdoc">Gets or sets the paid date and time</div><div class="ttdef"><b>Definition:</b> Order.cs:259</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a14f96cdb18cd65086be7f64788f98ca3"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync</a></div><div class="ttdeci">virtual async Task ProcessOrderPaidAsync(Order order)</div><div class="ttdoc">Process order paid status</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1117</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a36e730601668851f42f549318caaaa86"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync</a></div><div class="ttdeci">virtual async Task CheckOrderStatusAsync(Order order)</div><div class="ttdoc">Checks order status</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1502</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a7af3ca11a1d78bcbba7679447c03e5a9"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">Nop.Services.Orders.OrderProcessingService.CanCaptureAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; CanCaptureAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether capture from admin panel is allowed</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2390</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_capture_payment_request_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_capture_payment_request.html">Nop.Services.Payments.CapturePaymentRequest</a></div><div class="ttdoc">Represents a CapturePaymentRequest</div><div class="ttdef"><b>Definition:</b> CapturePaymentRequest.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_capture_payment_result_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_capture_payment_result.html">Nop.Services.Payments.CapturePaymentResult</a></div><div class="ttdoc">Capture payment result</div><div class="ttdef"><b>Definition:</b> CapturePaymentResult.cs:11</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_acdb2f9127ddea3c4121026adec3f4d32"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#acdb2f9127ddea3c4121026adec3f4d32">Nop.Services.Payments.IPaymentService.CaptureAsync</a></div><div class="ttdeci">Task&lt; CapturePaymentResult &gt; CaptureAsync(CapturePaymentRequest capturePaymentRequest)</div><div class="ttdoc">Captures payment</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">Nop.Services.Orders.OrderProcessingService.CanCaptureAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#acdb2f9127ddea3c4121026adec3f4d32">Nop.Services.Payments.IPaymentService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a767b0713af5f7bd040aef9ebf7b2c7e9">Nop.Core.Domain.Orders.Order.CaptureTransactionId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a877245122aa732f18b3a1149f2799a41">Nop.Core.Domain.Orders.Order.CaptureTransactionResult</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">Nop.Core.Domain.Orders.Order.PaidDateUtc</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a36e730601668851f42f549318caaaa86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36e730601668851f42f549318caaaa86">&#9670;&nbsp;</a></span>CheckOrderStatusAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks order status </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a6bf08bae69a4feba262c49f308818e87">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid &amp;&amp; !order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">PaidDateUtc</a>.HasValue)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                <span class="comment">//ensure that paid date is set</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">PaidDateUtc</a> = DateTime.UtcNow;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">switch</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a>)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Pending:</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                    <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Authorized ||</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">SetOrderStatusAsync</a>(order, <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Processing, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.PartiallyShipped ||</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                        order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Shipped ||</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                        order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Delivered)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">SetOrderStatusAsync</a>(order, <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Processing, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                <span class="comment">//is order complete?</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled:</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete:</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="keywordtype">bool</span> completed;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.ShippingNotRequired)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="comment">//shipping is not required</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                completed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                <span class="comment">//shipping is required</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ada13cab0440786e5c416d8f04a17db73">CompleteOrderWhenDelivered</a>)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                    completed = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Delivered;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                    completed = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Shipped ||</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">ShippingStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Delivered;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="keywordflow">if</span> (completed) </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">SetOrderStatusAsync</a>(order, <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a6ee56dfef88f0242ccbc7df201d2cb0a"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">Nop.Core.Domain.Orders.Order.ShippingStatus</a></div><div class="ttdeci">ShippingStatus ShippingStatus</div><div class="ttdoc">Gets or sets the shipping status</div><div class="ttdef"><b>Definition:</b> Order.cs:322</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_ada13cab0440786e5c416d8f04a17db73"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ada13cab0440786e5c416d8f04a17db73">Nop.Core.Domain.Orders.OrderSettings.CompleteOrderWhenDelivered</a></div><div class="ttdeci">bool CompleteOrderWhenDelivered</div><div class="ttdoc">Gets or sets a value indicating whether an order status should be set to &quot;Complete&quot; only when its shi...</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:149</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_shipping_html_a1dbf5d81e9b14f65a14f24436b374fae"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">Nop.Core.Domain.Shipping.ShippingStatus</a></div><div class="ttdeci">ShippingStatus</div><div class="ttdoc">Represents the shipping status enumeration</div><div class="ttdef"><b>Definition:</b> ShippingStatus.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ada13cab0440786e5c416d8f04a17db73">Nop.Core.Domain.Orders.OrderSettings.CompleteOrderWhenDelivered</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">Nop.Core.Domain.Orders.Order.PaidDateUtc</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6ee56dfef88f0242ccbc7df201d2cb0a">Nop.Core.Domain.Orders.Order.ShippingStatus</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">Nop.Services.Orders.OrderProcessingService.MarkAsAuthorizedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync()</a>.</p>

</div>
</div>
<a id="a6f364e54df9c3c5e630d0251b3c4b6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f364e54df9c3c5e630d0251b3c4b6e2">&#9670;&nbsp;</a></span>CreateFirstRecurringPaymentAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.CreateFirstRecurringPaymentAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create recurring payment (the first payment) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            var rp = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#adef789271076da1c91c61ad003ce43ab">CycleLength</a> = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a9706413e3020ec3fcaca17a98b0e989e">RecurringCycleLength</a>,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                CyclePeriod = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a08372489cdf545bd5d84cf74937b1feb">RecurringCyclePeriod</a>,</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a697d3eddbad2538edcde4ef15c005671">TotalCycles</a> = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6886a986ee35038a9c951e47c12dabca">RecurringTotalCycles</a>,</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#a9499fbb31059450fc3340a31c8608632">StartDateUtc</a> = DateTime.UtcNow,</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                <a class="code" href="namespace_nop_1_1_plugin_1_1_misc_1_1_sendinblue_1_1_models.html#aba5f995022a1039f2dcac000700cdbaf">IsActive</a> = <span class="keyword">true</span>,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                CreatedOnUtc = DateTime.UtcNow,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a778dd1c22e6d948bd79395a22c20e2f4">InitialOrderId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            };</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a71f22a085e966d34a91795faee99e848">InsertRecurringPaymentAsync</a>(rp);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <span class="keywordflow">switch</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">GetRecurringPaymentTypeAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a>))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.NotSupported:</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                    <span class="comment">//not supported</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Manual:</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aa5d03d6d03cfeb2771e00796c0a04ded">InsertRecurringPaymentHistoryAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_history.html">RecurringPaymentHistory</a></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                    {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a661520bc33d33d1bf5a482fe00f1c984">RecurringPaymentId</a> = rp.Id,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                        CreatedOnUtc = DateTime.UtcNow,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    });</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Automatic:</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    <span class="comment">//will be created later (process is automated)</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_history_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_history.html">Nop.Core.Domain.Orders.RecurringPaymentHistory</a></div><div class="ttdoc">Represents a recurring payment history</div><div class="ttdef"><b>Definition:</b> RecurringPaymentHistory.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">Nop.Core.Domain.Orders.RecurringPayment</a></div><div class="ttdoc">Represents a recurring payment</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:11</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a08372489cdf545bd5d84cf74937b1feb"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a08372489cdf545bd5d84cf74937b1feb">Nop.Services.Payments.ProcessPaymentRequest.RecurringCyclePeriod</a></div><div class="ttdeci">RecurringProductCyclePeriod RecurringCyclePeriod</div><div class="ttdoc">Gets or sets the cycle period</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:100</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a6886a986ee35038a9c951e47c12dabca"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6886a986ee35038a9c951e47c12dabca">Nop.Services.Payments.ProcessPaymentRequest.RecurringTotalCycles</a></div><div class="ttdeci">int RecurringTotalCycles</div><div class="ttdoc">Gets or sets the total cycles</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:105</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a6929faec75eea9a7ee1af7ad7ed88813"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">Nop.Services.Payments.ProcessPaymentRequest.PaymentMethodSystemName</a></div><div class="ttdeci">string PaymentMethodSystemName</div><div class="ttdoc">///</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:49</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a9706413e3020ec3fcaca17a98b0e989e"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a9706413e3020ec3fcaca17a98b0e989e">Nop.Services.Payments.ProcessPaymentRequest.RecurringCycleLength</a></div><div class="ttdeci">int RecurringCycleLength</div><div class="ttdoc">Gets or sets the cycle length</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:95</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a71f22a085e966d34a91795faee99e848"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a71f22a085e966d34a91795faee99e848">Nop.Services.Orders.IOrderService.InsertRecurringPaymentAsync</a></div><div class="ttdeci">Task InsertRecurringPaymentAsync(RecurringPayment recurringPayment)</div><div class="ttdoc">Inserts a recurring payment</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_aa5d03d6d03cfeb2771e00796c0a04ded"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aa5d03d6d03cfeb2771e00796c0a04ded">Nop.Services.Orders.IOrderService.InsertRecurringPaymentHistoryAsync</a></div><div class="ttdeci">Task InsertRecurringPaymentHistoryAsync(RecurringPaymentHistory recurringPaymentHistory)</div><div class="ttdoc">Inserts a recurring payment history entry</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_misc_1_1_sendinblue_1_1_models_html_aba5f995022a1039f2dcac000700cdbaf"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_misc_1_1_sendinblue_1_1_models.html#aba5f995022a1039f2dcac000700cdbaf">Nop.Plugin.Misc.Sendinblue.Models.IsActive</a></div><div class="ttdeci">bool IsActive</div><div class="ttdef"><b>Definition:</b> SendinblueMessageTemplateModel.cs:12</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts_html_a9499fbb31059450fc3340a31c8608632"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#a9499fbb31059450fc3340a31c8608632">Nop.Web.Areas.Admin.Models.Discounts.StartDateUtc</a></div><div class="ttdeci">DateTime? StartDateUtc</div><div class="ttdef"><b>Definition:</b> DiscountModel.cs:64</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a661520bc33d33d1bf5a482fe00f1c984"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a661520bc33d33d1bf5a482fe00f1c984">Nop.Web.Areas.Admin.Models.Orders.RecurringPaymentId</a></div><div class="ttdeci">int RecurringPaymentId</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:137</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a697d3eddbad2538edcde4ef15c005671"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a697d3eddbad2538edcde4ef15c005671">Nop.Web.Areas.Admin.Models.Orders.TotalCycles</a></div><div class="ttdeci">int TotalCycles</div><div class="ttdef"><b>Definition:</b> RecurringPaymentModel.cs:35</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a778dd1c22e6d948bd79395a22c20e2f4"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a778dd1c22e6d948bd79395a22c20e2f4">Nop.Web.Areas.Admin.Models.Orders.InitialOrderId</a></div><div class="ttdeci">int InitialOrderId</div><div class="ttdef"><b>Definition:</b> RecurringPaymentModel.cs:50</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_adef789271076da1c91c61ad003ce43ab"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#adef789271076da1c91c61ad003ce43ab">Nop.Web.Areas.Admin.Models.Orders.CycleLength</a></div><div class="ttdeci">int CycleLength</div><div class="ttdef"><b>Definition:</b> RecurringPaymentModel.cs:26</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#adef789271076da1c91c61ad003ce43ab">Nop.Web.Areas.Admin.Models.Orders.CycleLength</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">Nop.Services.Payments.IPaymentService.GetRecurringPaymentTypeAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a778dd1c22e6d948bd79395a22c20e2f4">Nop.Web.Areas.Admin.Models.Orders.InitialOrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a71f22a085e966d34a91795faee99e848">Nop.Services.Orders.IOrderService.InsertRecurringPaymentAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aa5d03d6d03cfeb2771e00796c0a04ded">Nop.Services.Orders.IOrderService.InsertRecurringPaymentHistoryAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_misc_1_1_sendinblue_1_1_models.html#aba5f995022a1039f2dcac000700cdbaf">Nop.Plugin.Misc.Sendinblue.Models.IsActive</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">Nop.Services.Payments.ProcessPaymentRequest.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a9706413e3020ec3fcaca17a98b0e989e">Nop.Services.Payments.ProcessPaymentRequest.RecurringCycleLength</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a08372489cdf545bd5d84cf74937b1feb">Nop.Services.Payments.ProcessPaymentRequest.RecurringCyclePeriod</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a661520bc33d33d1bf5a482fe00f1c984">Nop.Web.Areas.Admin.Models.Orders.RecurringPaymentId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6886a986ee35038a9c951e47c12dabca">Nop.Services.Payments.ProcessPaymentRequest.RecurringTotalCycles</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#a9499fbb31059450fc3340a31c8608632">Nop.Web.Areas.Admin.Models.Discounts.StartDateUtc</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a697d3eddbad2538edcde4ef15c005671">Nop.Web.Areas.Admin.Models.Orders.TotalCycles</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="aa6f39e64546fb3a2604e36367c473eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6f39e64546fb3a2604e36367c473eac">&#9670;&nbsp;</a></span>DeleteOrderAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes an order </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>The order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a50ddb1ca2f355826068e4fab4a209950">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="comment">//check whether the order wasn&#39;t cancelled before</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            <span class="comment">//if it already was cancelled, then there&#39;s no need to make the following adjustments</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="comment">//(such as reward points, inventory, recurring payments)</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            <span class="comment">//they already was done when cancelling the order</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                <span class="comment">//return (add) back redeemded reward points</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">ReturnBackRedeemedRewardPointsAsync</a>(order);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                <span class="comment">//reduce (cancel) back reward points (previously awarded for this order)</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">ReduceRewardPointsAsync</a>(order);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                <span class="comment">//cancel recurring payments</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                var recurringPayments = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aab18b8ee56cc32d37977e38d032a36d7">SearchRecurringPaymentsAsync</a>(initialOrderId: order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                <span class="keywordflow">foreach</span> (var rp <span class="keywordflow">in</span> recurringPayments) </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">CancelRecurringPaymentAsync</a>(rp);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                <span class="comment">//Adjust inventory for already shipped shipments</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                <span class="comment">//only products with &quot;use multiple warehouses&quot;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                <span class="keywordflow">foreach</span> (var shipment <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#a6602d86cd5ebf33efe57ee9dc4e77327">GetShipmentsByOrderIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                    <span class="keywordflow">foreach</span> (var shipmentItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">GetShipmentItemsByShipmentIdAsync</a>(shipment.Id))</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">GetProductByOrderItemIdAsync</a>(shipmentItem.OrderItemId);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                        <span class="keywordflow">if</span> (product == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#aff4738a330663b5eb45a204405491967">ReverseBookedInventoryAsync</a>(product, shipmentItem,</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                            <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.DeleteOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>));</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                    }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                <span class="comment">//Adjust inventory</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                <span class="keywordflow">foreach</span> (var orderItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                    var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(orderItem.ProductId);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">AdjustInventoryAsync</a>(product, orderItem.Quantity, orderItem.AttributesXml,</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                        <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.DeleteOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>));</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="comment">//deactivate gift cards</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5c8b81de0014b33890c44752823f06b4">DeactivateGiftCardsAfterDeletingOrder</a>)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">SetActivatedValueForPurchasedGiftCardsAsync</a>(order, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been deleted&quot;</span>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <span class="comment">//now delete an order</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a493d72c14a3804a010dc26534db2beaa">DeleteOrderAsync</a>(order);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a5c8b81de0014b33890c44752823f06b4"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5c8b81de0014b33890c44752823f06b4">Nop.Core.Domain.Orders.OrderSettings.DeactivateGiftCardsAfterDeletingOrder</a></div><div class="ttdeci">bool DeactivateGiftCardsAfterDeletingOrder</div><div class="ttdoc">Gets or sets a value indicating whether to deactivate related gift cards after deleting the order</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:139</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a58ef586e3bf6517d1a70e6fcc6bef293"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync</a></div><div class="ttdeci">virtual async Task ReduceRewardPointsAsync(Order order)</div><div class="ttdoc">Reduce (cancel) reward points (previously awarded for placing an order)</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:951</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab640dd113d78cc91758e7bd2e05c5ec5"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync</a></div><div class="ttdeci">virtual async Task SetActivatedValueForPurchasedGiftCardsAsync(Order order, bool activate)</div><div class="ttdoc">Set IsActivated value for purchase gift cards for particular order</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1009</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a493d72c14a3804a010dc26534db2beaa"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a493d72c14a3804a010dc26534db2beaa">Nop.Services.Orders.IOrderService.DeleteOrderAsync</a></div><div class="ttdeci">Task DeleteOrderAsync(Order order)</div><div class="ttdoc">Deletes an order</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">Nop.Services.Catalog.IProductService.AdjustInventoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5c8b81de0014b33890c44752823f06b4">Nop.Core.Domain.Orders.OrderSettings.DeactivateGiftCardsAfterDeletingOrder</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a493d72c14a3804a010dc26534db2beaa">Nop.Services.Orders.IOrderService.DeleteOrderAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">Nop.Services.Orders.IOrderService.GetProductByOrderItemIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">Nop.Services.Shipping.IShipmentService.GetShipmentItemsByShipmentIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#a6602d86cd5ebf33efe57ee9dc4e77327">Nop.Services.Shipping.IShipmentService.GetShipmentsByOrderIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#aff4738a330663b5eb45a204405491967">Nop.Services.Catalog.IProductService.ReverseBookedInventoryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aab18b8ee56cc32d37977e38d032a36d7">Nop.Services.Orders.IOrderService.SearchRecurringPaymentsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync()</a>.</p>

</div>
</div>
<a id="ad28d85dbb5aba28cdbcb26ca78f36edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28d85dbb5aba28cdbcb26ca78f36edd">&#9670;&nbsp;</a></span>DeliverAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.DeliverAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html">Shipment</a>&#160;</td>
          <td class="paramname"><em>shipment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>notifyCustomer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks a shipment as delivered </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">shipment</td><td>Shipment</td></tr>
    <tr><td class="paramname">notifyCustomer</td><td>True to notify customer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a78ddadfde358d8c185bbc8cae5451e6d">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="keywordflow">if</span> (shipment == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(shipment));</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            var order = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">OrderId</a>);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Order cannot be loaded&quot;</span>);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            <span class="keywordflow">if</span> (!shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">ShippedDateUtc</a>.HasValue)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;This shipment is not shipped yet&quot;</span>);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <span class="keywordflow">if</span> (shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a0d8629d85d8fd6bb139504d1442d042a">DeliveryDateUtc</a>.HasValue)</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;This shipment is already delivered&quot;</span>);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a0d8629d85d8fd6bb139504d1442d042a">DeliveryDateUtc</a> = DateTime.UtcNow;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ae875cc67fda49873b4bc67f45cb181ec">UpdateShipmentAsync</a>(shipment);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aaf9783d7fd7a3d38bda26ecc870593b3">HasItemsToAddToShipmentAsync</a>(order) &amp;&amp; !await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#ad7ca9f12ae2d2f9c263c019ccbda45fa">HasItemsToShipAsync</a>(order) &amp;&amp; !await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a6c8cc8a12932a58a8176802de4e9ca4a">HasItemsToDeliverAsync</a>(order))</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                order.ShippingStatusId = (int)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Delivered;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Shipment# {shipment.Id} has been delivered&quot;</span>);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            <span class="keywordflow">if</span> (notifyCustomer)</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                <span class="comment">//send email notification</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                var queuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9eac72e85929651e6310200ee0485abf">SendShipmentDeliveredCustomerNotificationAsync</a>(shipment, order.CustomerLanguageId);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                <span class="keywordflow">if</span> (queuedEmailIds.Any())</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Delivered\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, queuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            <span class="comment">//event</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishShipmentDeliveredAsync(shipment);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment_html_a0d8629d85d8fd6bb139504d1442d042a"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a0d8629d85d8fd6bb139504d1442d042a">Nop.Core.Domain.Shipping.Shipment.DeliveryDateUtc</a></div><div class="ttdeci">DateTime? DeliveryDateUtc</div><div class="ttdoc">Gets or sets the delivery date and time</div><div class="ttdef"><b>Definition:</b> Shipment.cs:34</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment_html_a5361dc61a7738d3cb3aaa07fdf3ef4b4"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">Nop.Core.Domain.Shipping.Shipment.ShippedDateUtc</a></div><div class="ttdeci">DateTime? ShippedDateUtc</div><div class="ttdoc">Gets or sets the shipped date and time</div><div class="ttdef"><b>Definition:</b> Shipment.cs:29</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment_html_a8939e34989422aa12467f5a807a91e40"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">Nop.Core.Domain.Shipping.Shipment.OrderId</a></div><div class="ttdeci">int OrderId</div><div class="ttdoc">Gets or sets the order identifier</div><div class="ttdef"><b>Definition:</b> Shipment.cs:13</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a9eac72e85929651e6310200ee0485abf"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9eac72e85929651e6310200ee0485abf">Nop.Services.Messages.IWorkflowMessageService.SendShipmentDeliveredCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendShipmentDeliveredCustomerNotificationAsync(Shipment shipment, int languageId)</div><div class="ttdoc">Sends a shipment delivered notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a6c8cc8a12932a58a8176802de4e9ca4a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a6c8cc8a12932a58a8176802de4e9ca4a">Nop.Services.Orders.IOrderService.HasItemsToDeliverAsync</a></div><div class="ttdeci">Task&lt; bool &gt; HasItemsToDeliverAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether an order has items to deliver</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_aaf9783d7fd7a3d38bda26ecc870593b3"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aaf9783d7fd7a3d38bda26ecc870593b3">Nop.Services.Orders.IOrderService.HasItemsToAddToShipmentAsync</a></div><div class="ttdeci">Task&lt; bool &gt; HasItemsToAddToShipmentAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether an order has items to be added to a shipment</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_ad7ca9f12ae2d2f9c263c019ccbda45fa"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#ad7ca9f12ae2d2f9c263c019ccbda45fa">Nop.Services.Orders.IOrderService.HasItemsToShipAsync</a></div><div class="ttdeci">Task&lt; bool &gt; HasItemsToShipAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether an order has items to ship</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service_html_ae875cc67fda49873b4bc67f45cb181ec"><div class="ttname"><a href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ae875cc67fda49873b4bc67f45cb181ec">Nop.Services.Shipping.IShipmentService.UpdateShipmentAsync</a></div><div class="ttdeci">Task UpdateShipmentAsync(Shipment shipment)</div><div class="ttdoc">Updates the shipment</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a0d8629d85d8fd6bb139504d1442d042a">Nop.Core.Domain.Shipping.Shipment.DeliveryDateUtc</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aaf9783d7fd7a3d38bda26ecc870593b3">Nop.Services.Orders.IOrderService.HasItemsToAddToShipmentAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a6c8cc8a12932a58a8176802de4e9ca4a">Nop.Services.Orders.IOrderService.HasItemsToDeliverAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#ad7ca9f12ae2d2f9c263c019ccbda45fa">Nop.Services.Orders.IOrderService.HasItemsToShipAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">Nop.Core.Domain.Shipping.Shipment.OrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9eac72e85929651e6310200ee0485abf">Nop.Services.Messages.IWorkflowMessageService.SendShipmentDeliveredCustomerNotificationAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">Nop.Core.Domain.Shipping.Shipment.ShippedDateUtc</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ae875cc67fda49873b4bc67f45cb181ec">Nop.Services.Shipping.IShipmentService.UpdateShipmentAsync()</a>.</p>

</div>
</div>
<a id="a26815bf28de303791fa0f42633a9245e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26815bf28de303791fa0f42633a9245e">&#9670;&nbsp;</a></span>GetCyclesRemainingAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;int&gt; Nop.Services.Orders.OrderProcessingService.GetCyclesRemainingAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the cycles remaining </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">recurringPayment</td><td>Recurring payment</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a9bbfccfc7243a86c507e4932c0e53d93">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            <span class="keywordflow">if</span> (recurringPayment is <span class="keyword">null</span>)</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(recurringPayment));</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160; </div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            var historyCollection = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a98b4cd370f0b1090c5e0dddbaacc7707">GetRecurringPaymentHistoryAsync</a>(recurringPayment);</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;            var <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">TotalCycles</a> - historyCollection.Count;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> &lt; 0)</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = 0;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_aead35a8f54f9342c559568542c3e558f"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">Nop.Core.Domain.Orders.RecurringPayment.TotalCycles</a></div><div class="ttdeci">int TotalCycles</div><div class="ttdoc">Gets or sets the total cycles</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:25</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a98b4cd370f0b1090c5e0dddbaacc7707"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a98b4cd370f0b1090c5e0dddbaacc7707">Nop.Services.Orders.IOrderService.GetRecurringPaymentHistoryAsync</a></div><div class="ttdeci">Task&lt; IList&lt; RecurringPaymentHistory &gt; &gt; GetRecurringPaymentHistoryAsync(RecurringPayment recurringPayment)</div><div class="ttdoc">Gets a recurring payment history</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a98b4cd370f0b1090c5e0dddbaacc7707">Nop.Services.Orders.IOrderService.GetRecurringPaymentHistoryAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">Nop.Core.Domain.Orders.RecurringPayment.TotalCycles</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a08da9b956365be055c479fa2c41d9610">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.CanCalculateNumberOfRemainingCycle()</a>.</p>

</div>
</div>
<a id="abb5180e1683480f5550d2ca71a25b516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5180e1683480f5550d2ca71a25b516">&#9670;&nbsp;</a></span>GetNextPaymentDateAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;DateTime?&gt; Nop.Services.Orders.OrderProcessingService.GetNextPaymentDateAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the next payment date </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">recurringPayment</td><td>Recurring payment</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a680487fdeafd58d593c65cf16f8e1299">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        {</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;            <span class="keywordflow">if</span> (recurringPayment is <span class="keyword">null</span>)</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(recurringPayment));</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160; </div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;            <span class="keywordflow">if</span> (!recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">IsActive</a>)</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; </div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            var historyCollection = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a98b4cd370f0b1090c5e0dddbaacc7707">GetRecurringPaymentHistoryAsync</a>(recurringPayment);</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;            <span class="keywordflow">if</span> (historyCollection.Count &gt;= recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">TotalCycles</a>) </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            <span class="comment">//result</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            DateTime? <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160; </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;            <span class="comment">//calculate next payment date</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;            <span class="keywordflow">if</span> (historyCollection.Any())</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;            {</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#acee4867aa04db4947b9b3118ae0709cf">CyclePeriod</a> <span class="keywordflow">switch</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a78fc1d7cb49b0318ee4f9ef0490f3ba7">RecurringProductCyclePeriod</a>.Days =&gt; recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">StartDateUtc</a>.AddDays((<span class="keywordtype">double</span>)recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">CycleLength</a> * historyCollection.Count),</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a78fc1d7cb49b0318ee4f9ef0490f3ba7">RecurringProductCyclePeriod</a>.Weeks =&gt; recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">StartDateUtc</a>.AddDays((<span class="keywordtype">double</span>)(7 * recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">CycleLength</a>) * historyCollection.Count),</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a78fc1d7cb49b0318ee4f9ef0490f3ba7">RecurringProductCyclePeriod</a>.Months =&gt; recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">StartDateUtc</a>.AddMonths(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">CycleLength</a> * historyCollection.Count),</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a78fc1d7cb49b0318ee4f9ef0490f3ba7">RecurringProductCyclePeriod</a>.Years =&gt; recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">StartDateUtc</a>.AddYears(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">CycleLength</a> * historyCollection.Count),</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                    _ =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Not supported cycle period&quot;</span>),</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                };</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;            }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;            {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                <span class="keywordflow">if</span> (recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">TotalCycles</a> &gt; 0)</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">StartDateUtc</a>;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;            }</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_a20fa2ad07bd41be0e69773bee943881e"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">Nop.Core.Domain.Orders.RecurringPayment.CycleLength</a></div><div class="ttdeci">int CycleLength</div><div class="ttdoc">Gets or sets the cycle length</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:15</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_acee4867aa04db4947b9b3118ae0709cf"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#acee4867aa04db4947b9b3118ae0709cf">Nop.Core.Domain.Orders.RecurringPayment.CyclePeriod</a></div><div class="ttdeci">RecurringProductCyclePeriod CyclePeriod</div><div class="ttdoc">Gets or sets the cycle period</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:61</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_html_ae9b897bbf803b8f80ec9c0a368c91e65"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">Nop.Core.Domain.Orders.RecurringPayment.StartDateUtc</a></div><div class="ttdeci">DateTime StartDateUtc</div><div class="ttdoc">Gets or sets the start date</div><div class="ttdef"><b>Definition:</b> RecurringPayment.cs:30</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_catalog_html_a78fc1d7cb49b0318ee4f9ef0490f3ba7"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a78fc1d7cb49b0318ee4f9ef0490f3ba7">Nop.Core.Domain.Catalog.RecurringProductCyclePeriod</a></div><div class="ttdeci">RecurringProductCyclePeriod</div><div class="ttdoc">Represents a recurring product cycle period</div><div class="ttdef"><b>Definition:</b> RecurringProductCyclePeriod.cs:7</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">Nop.Core.Domain.Orders.RecurringPayment.CycleLength</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#acee4867aa04db4947b9b3118ae0709cf">Nop.Core.Domain.Orders.RecurringPayment.CyclePeriod</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a98b4cd370f0b1090c5e0dddbaacc7707">Nop.Services.Orders.IOrderService.GetRecurringPaymentHistoryAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">Nop.Core.Domain.Orders.RecurringPayment.IsActive</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#ae9b897bbf803b8f80ec9c0a368c91e65">Nop.Core.Domain.Orders.RecurringPayment.StartDateUtc</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">Nop.Core.Domain.Orders.RecurringPayment.TotalCycles</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#aadd9d88b6c93af0db393aa44bb311942">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.CanCalculateNextPaymentDateWithDaysAsCyclePeriod()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#abecedff7b7cf093f3e401aeae355d823">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.CanCalculateNextPaymentDateWithMonthsAsCyclePeriod()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#ad93eb563b8185c260a9af3f632f633a3">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.CanCalculateNextPaymentDateWithWeeksAsCyclePeriod()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#a37c1dc78b1d0f313813ba79e47c48a88">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.CanCalculateNextPaymentDateWithYearsAsCyclePeriod()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac0875883e79f8cf6f926d30b11c9d0a3">Nop.Services.Orders.OrderProcessingService.CanCancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_tests_1_1_nop_1_1_services_1_1_tests_1_1_orders_1_1_order_processing_service_tests.html#ab94517e72abce340ebb882da2f257be7">Nop.Tests.Nop.Services.Tests.Orders.OrderProcessingServiceTests.NextPaymentDateIsNullWhenRecurringPaymentIsNotActive()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a5fdc3a30ecd2f4fd151465b6b1953eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fdc3a30ecd2f4fd151465b6b1953eb0">&#9670;&nbsp;</a></span>GetProcessPaymentResultAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;<a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a>&gt; Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get process payment result </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
    <tr><td class="paramname">details</td><td>Place order container</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the </dd></dl>
<div class="fragment"><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            <span class="comment">//process payment</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> processPaymentResult;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="comment">//check if is payment workflow required</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">IsPaymentWorkflowRequiredAsync</a>(details.Cart))</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">CustomerId</a>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                var paymentMethod = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                    .<a class="code" href="interface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager.html#ae65d47d1226a9c2099ff48e24a976235">LoadPluginBySystemNameAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a>, customer, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                    ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Payment method couldn&#39;t be loaded&quot;</span>);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                <span class="comment">//ensure that payment method is active</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html#a3ca5817d660c52b46621080a20598fc8">IsPluginActive</a>(paymentMethod))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Payment method is not active&quot;</span>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                <span class="keywordflow">if</span> (details.IsRecurringShoppingCart)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    <span class="comment">//recurring cart</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                    processPaymentResult = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">GetRecurringPaymentTypeAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a>)) <span class="keywordflow">switch</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                    {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.NotSupported =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Recurring payments are not supported by selected payment method&quot;</span>),</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Manual or </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Automatic =&gt; await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ab17cc75a304e6bf10a1579a61da97ffe">ProcessRecurringPaymentAsync</a>(processPaymentRequest),</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                        _ =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Not supported recurring payment type&quot;</span>),</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    };</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    <span class="comment">//standard cart</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                    processPaymentResult = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a5c0d724362d95efd5d4f14120d8663ab">ProcessPaymentAsync</a>(processPaymentRequest);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <span class="comment">//payment is not required</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                processPaymentResult = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> { NewPaymentStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid };</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordflow">return</span> processPaymentResult;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a468a280332b31043d11c73bd2f6e6630"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">Nop.Services.Orders.OrderProcessingService.IsPaymentWorkflowRequiredAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; IsPaymentWorkflowRequiredAsync(IList&lt; ShoppingCartItem &gt; cart, bool? useRewardPoints=null)</div><div class="ttdoc">Gets a value indicating whether payment workflow is required</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:3168</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a098b0e1fef0218d4da085f5e1db550d3"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">Nop.Services.Payments.ProcessPaymentRequest.CustomerId</a></div><div class="ttdeci">int CustomerId</div><div class="ttdoc">Gets or sets a customer identifier</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:27</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a1734b4d0645df9858d9e4940dfdafb58"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">Nop.Services.Payments.ProcessPaymentRequest.StoreId</a></div><div class="ttdeci">int StoreId</div><div class="ttdoc">Gets or sets a store identifier</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:22</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">Nop.Services.Payments.ProcessPaymentResult</a></div><div class="ttdoc">Process payment result</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:11</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager_html_a3ca5817d660c52b46621080a20598fc8"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html#a3ca5817d660c52b46621080a20598fc8">Nop.Services.Payments.IPaymentPluginManager.IsPluginActive</a></div><div class="ttdeci">bool IsPluginActive(IPaymentMethod paymentMethod)</div><div class="ttdoc">Check whether the passed payment method is active</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a5c0d724362d95efd5d4f14120d8663ab"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a5c0d724362d95efd5d4f14120d8663ab">Nop.Services.Payments.IPaymentService.ProcessPaymentAsync</a></div><div class="ttdeci">Task&lt; ProcessPaymentResult &gt; ProcessPaymentAsync(ProcessPaymentRequest processPaymentRequest)</div><div class="ttdoc">Process a payment</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_ab17cc75a304e6bf10a1579a61da97ffe"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ab17cc75a304e6bf10a1579a61da97ffe">Nop.Services.Payments.IPaymentService.ProcessRecurringPaymentAsync</a></div><div class="ttdeci">Task&lt; ProcessPaymentResult &gt; ProcessRecurringPaymentAsync(ProcessPaymentRequest processPaymentRequest)</div><div class="ttdoc">Process recurring payment</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager_html_ae65d47d1226a9c2099ff48e24a976235"><div class="ttname"><a href="interface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager.html#ae65d47d1226a9c2099ff48e24a976235">Nop.Services.Plugins.IPluginManager.LoadPluginBySystemNameAsync</a></div><div class="ttdeci">Task&lt; TPlugin &gt; LoadPluginBySystemNameAsync(string systemName, Customer customer=null, int storeId=0)</div><div class="ttdoc">Load plugin by system name</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">Nop.Services.Orders.OrderProcessingService._paymentPluginManager</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#abb3d87958e3cd94c39bee9a9d3d7aa27">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.Cart</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">Nop.Services.Payments.ProcessPaymentRequest.CustomerId</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">Nop.Services.Payments.IPaymentService.GetRecurringPaymentTypeAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">Nop.Services.Orders.OrderProcessingService.IsPaymentWorkflowRequiredAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html#a3ca5817d660c52b46621080a20598fc8">Nop.Services.Payments.IPaymentPluginManager.IsPluginActive()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a944d528d43967e681bd31a657645f130">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.IsRecurringShoppingCart</a>, <a class="el" href="interface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager.html#ae65d47d1226a9c2099ff48e24a976235">Nop.Services.Plugins.IPluginManager&lt; TPlugin &gt;.LoadPluginBySystemNameAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">Nop.Services.Payments.ProcessPaymentRequest.PaymentMethodSystemName</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a5c0d724362d95efd5d4f14120d8663ab">Nop.Services.Payments.IPaymentService.ProcessPaymentAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ab17cc75a304e6bf10a1579a61da97ffe">Nop.Services.Payments.IPaymentService.ProcessRecurringPaymentAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">Nop.Services.Payments.ProcessPaymentRequest.StoreId</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="ada11474c14bf82ad908d28bf9d926112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada11474c14bf82ad908d28bf9d926112">&#9670;&nbsp;</a></span>GetVendorsInOrderAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_vendors_1_1_vendor.html">Vendor</a>&gt; &gt; Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a list of vendors in order (order items) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the vendors </dd></dl>
<div class="fragment"><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            var pIds = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>)).Select(x =&gt; x.ProductId).ToArray();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            <span class="keywordflow">return</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">_vendorService</a>.<a class="code" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html#a7ed2befe0ad6e82d4dd4ef4e7d053353">GetVendorsByProductIdsAsync</a>(pIds);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service_html_a7ed2befe0ad6e82d4dd4ef4e7d053353"><div class="ttname"><a href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html#a7ed2befe0ad6e82d4dd4ef4e7d053353">Nop.Services.Vendors.IVendorService.GetVendorsByProductIdsAsync</a></div><div class="ttdeci">Task&lt; IList&lt; Vendor &gt; &gt; GetVendorsByProductIdsAsync(int[] productIds)</div><div class="ttdoc">Gets a vendors by product identifiers</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a904543a4ac69a1f79f576612ec51b05d">Nop.Services.Orders.OrderProcessingService._vendorService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html#a7ed2befe0ad6e82d4dd4ef4e7d053353">Nop.Services.Vendors.IVendorService.GetVendorsByProductIdsAsync()</a> e <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>.</p>

</div>
</div>
<a id="a468a280332b31043d11c73bd2f6e6630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468a280332b31043d11c73bd2f6e6630">&#9670;&nbsp;</a></span>IsPaymentWorkflowRequiredAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.IsPaymentWorkflowRequiredAsync </td>
          <td>(</td>
          <td class="paramtype">IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt;&#160;</td>
          <td class="paramname"><em>cart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool?&#160;</td>
          <td class="paramname"><em>useRewardPoints</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value indicating whether payment workflow is required </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">cart</td><td>Shopping cart</td></tr>
    <tr><td class="paramname">useRewardPoints</td><td>A value indicating reward points should be used; null to detect current choice of the customer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the rue - OK; false - minimum order total amount is not reached </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#afbf31131670c37de52003e56d246676f">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        {</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            <span class="keywordflow">if</span> (cart == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(cart));</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160; </div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;            var <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160; </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;            <span class="comment">//check whether order total equals zero</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;            var shoppingCartTotalBase = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">GetShoppingCartTotalAsync</a>(cart, useRewardPoints: useRewardPoints)).shoppingCartTotal;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;            <span class="keywordflow">if</span> (shoppingCartTotalBase.HasValue &amp;&amp; shoppingCartTotalBase.Value == decimal.Zero)</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_a2316f10e4f0b8c3962ccfdc726b83199"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartTotalAsync</a></div><div class="ttdeci">Task&lt;(decimal? shoppingCartTotal, decimal discountAmount, List&lt; Discount &gt; appliedDiscounts, List&lt; AppliedGiftCard &gt; appliedGiftCards, int redeemedRewardPoints, decimal redeemedRewardPointsAmount)&gt; GetShoppingCartTotalAsync(IList&lt; ShoppingCartItem &gt; cart, bool? useRewardPoints=null, bool usePaymentMethodAdditionalFee=true)</div><div class="ttdoc">Gets shopping cart total</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartTotalAsync()</a> e <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync()</a>.</p>

</div>
</div>
<a id="a81a5d841973c068e42ea78caf6a160a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a5d841973c068e42ea78caf6a160a3">&#9670;&nbsp;</a></span>IsReturnRequestAllowedAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.IsReturnRequestAllowedAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether return request is allowed </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the result </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a9dfc33f9f15fd35fc881f609153dd89b">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        {</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#adb148cb7c675a6feaba0d75151e1c6b6">ReturnRequestsEnabled</a>)</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span> || order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aca1560b7ce7d1f158ed3bbb2ae867c4d">Deleted</a>)</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160; </div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            <span class="comment">//status should be complete</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete)</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; </div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;            <span class="comment">//validate allowed number of days</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a515ebcf55b9043937cb003cba79607dd">NumberOfDaysReturnRequestAvailable</a> &lt;= 0)</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                <span class="keywordflow">return</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>, <span class="keyword">false</span>)).Any();</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            var daysPassed = (DateTime.UtcNow - order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a41103e3f7860b256a8b14d87f58546e7">CreatedOnUtc</a>).TotalDays;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            <span class="keywordflow">if</span> (daysPassed &gt;= <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a515ebcf55b9043937cb003cba79607dd">NumberOfDaysReturnRequestAvailable</a>)</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            <span class="comment">//ensure that we have at least one returnable product</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            <span class="keywordflow">return</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>, <span class="keyword">false</span>)).Any();</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a41103e3f7860b256a8b14d87f58546e7"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a41103e3f7860b256a8b14d87f58546e7">Nop.Core.Domain.Orders.Order.CreatedOnUtc</a></div><div class="ttdeci">DateTime CreatedOnUtc</div><div class="ttdoc">Gets or sets the date and time of order creation</div><div class="ttdef"><b>Definition:</b> Order.cs:284</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_aca1560b7ce7d1f158ed3bbb2ae867c4d"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aca1560b7ce7d1f158ed3bbb2ae867c4d">Nop.Core.Domain.Orders.Order.Deleted</a></div><div class="ttdeci">bool Deleted</div><div class="ttdoc">Gets or sets a value indicating whether the entity has been deleted</div><div class="ttdef"><b>Definition:</b> Order.cs:279</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a515ebcf55b9043937cb003cba79607dd"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a515ebcf55b9043937cb003cba79607dd">Nop.Core.Domain.Orders.OrderSettings.NumberOfDaysReturnRequestAvailable</a></div><div class="ttdeci">int NumberOfDaysReturnRequestAvailable</div><div class="ttdoc">Gets or sets a number of days that the Return Request Link will be available for customers after orde...</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:124</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_adb148cb7c675a6feaba0d75151e1c6b6"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#adb148cb7c675a6feaba0d75151e1c6b6">Nop.Core.Domain.Orders.OrderSettings.ReturnRequestsEnabled</a></div><div class="ttdeci">bool ReturnRequestsEnabled</div><div class="ttdoc">Gets or sets a value indicating whether &quot;Return requests&quot; are allowed</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:104</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a41103e3f7860b256a8b14d87f58546e7">Nop.Core.Domain.Orders.Order.CreatedOnUtc</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aca1560b7ce7d1f158ed3bbb2ae867c4d">Nop.Core.Domain.Orders.Order.Deleted</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a515ebcf55b9043937cb003cba79607dd">Nop.Core.Domain.Orders.OrderSettings.NumberOfDaysReturnRequestAvailable</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#adb148cb7c675a6feaba0d75151e1c6b6">Nop.Core.Domain.Orders.OrderSettings.ReturnRequestsEnabled</a>.</p>

</div>
</div>
<a id="aeda57f823a8631e81d96c2318845fc84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeda57f823a8631e81d96c2318845fc84">&#9670;&nbsp;</a></span>MarkAsAuthorizedAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.MarkAsAuthorizedAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks order as authorized </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a9183fd18943756d7ebafa1fe503c68d4">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">PaymentStatusId</a> = (int)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Authorized;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been marked as authorized&quot;</span>);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_authorized_event.html">OrderAuthorizedEvent</a>(order)); </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_authorized_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_authorized_event.html">Nop.Core.Domain.Orders.OrderAuthorizedEvent</a></div><div class="ttdoc">Order authorized event</div><div class="ttdef"><b>Definition:</b> OrderAuthorizedEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a65bb2321dfba33fc88853c1e0c558c6b"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">Nop.Core.Domain.Orders.Order.PaymentStatusId</a></div><div class="ttdeci">int PaymentStatusId</div><div class="ttdoc">Gets or sets the payment status identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:64</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">Nop.Core.Domain.Orders.Order.PaymentStatusId</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a85a9ee7368631647b120766b46d5e5c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a9ee7368631647b120766b46d5e5c0">&#9670;&nbsp;</a></span>MarkOrderAsPaidAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks order as paid </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a16248ae963e21a741b2f1387a9148a01">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        {</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a3d275e26976b46270de28874bbb7beec">CanMarkOrderAsPaid</a>(order))</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;You can&#39;t mark this order as paid&quot;</span>);</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">PaymentStatusId</a> = (int)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">PaidDateUtc</a> = DateTime.UtcNow;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160; </div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been marked as paid&quot;</span>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid) </div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">ProcessOrderPaidAsync</a>(order);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a3d275e26976b46270de28874bbb7beec"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a3d275e26976b46270de28874bbb7beec">Nop.Services.Orders.OrderProcessingService.CanMarkOrderAsPaid</a></div><div class="ttdeci">virtual bool CanMarkOrderAsPaid(Order order)</div><div class="ttdoc">Gets a value indicating whether order can be marked as paid</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2484</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a3d275e26976b46270de28874bbb7beec">Nop.Services.Orders.OrderProcessingService.CanMarkOrderAsPaid()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ac8c537be82fe4c7c7550efe0c203f03a">Nop.Core.Domain.Orders.Order.PaidDateUtc</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">Nop.Core.Domain.Orders.Order.PaymentStatusId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a2c693d0278fa64204bbcac1f05df1651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c693d0278fa64204bbcac1f05df1651">&#9670;&nbsp;</a></span>MoveShoppingCartItemsToOrderItemsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&#160;</td>
          <td class="paramname"><em>details</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move shopping cart items to order items </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">details</td><td>Place order container</td></tr>
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keywordflow">foreach</span> (var sc <span class="keywordflow">in</span> details.Cart)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(sc.ProductId);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="comment">//prices</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                var scUnitPrice = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#af024c8e7d05c5971d0aaf11c72ab6f8a">GetUnitPriceAsync</a>(sc, <span class="keyword">true</span>)).unitPrice;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                var (scSubTotal, discountAmount, scDiscounts, _) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#ace6ba6d15c59339c0ffdd2dac06371af">GetSubTotalAsync</a>(sc, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                var scUnitPriceInclTax =</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, scUnitPrice, <span class="keyword">true</span>, details.Customer);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                var scUnitPriceExclTax =</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, scUnitPrice, <span class="keyword">false</span>, details.Customer);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                var scSubTotalInclTax =</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, scSubTotal, <span class="keyword">true</span>, details.Customer);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                var scSubTotalExclTax =</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, scSubTotal, <span class="keyword">false</span>, details.Customer);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                var discountAmountInclTax =</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, discountAmount, <span class="keyword">true</span>, details.Customer);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                var discountAmountExclTax =</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">GetProductPriceAsync</a>(product, discountAmount, <span class="keyword">false</span>, details.Customer);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                <span class="keywordflow">foreach</span> (var disc <span class="keywordflow">in</span> scDiscounts)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">ContainsDiscount</a>(details.AppliedDiscounts, disc))</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                        details.AppliedDiscounts.Add(disc);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                <span class="comment">//attributes</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                var attributeDescription =</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">_productAttributeFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html#a1e2ece5017fc654445aef796ee0f5c43">FormatAttributesAsync</a>(product, sc.AttributesXml, details.Customer);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                var itemWeight = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">_shippingService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html#aedf9c8bfb29a2b4f086dcf3fb4b85a5a">GetShoppingCartItemWeightAsync</a>(sc);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                <span class="comment">//save order item</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                var orderItem = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item.html">OrderItem</a></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    OrderItemGuid = Guid.NewGuid(),</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">ProductId</a> = product.Id,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9f44d521e2cb6de54997a4944fe78fb8">UnitPriceInclTax</a> = scUnitPriceInclTax.price,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af128d4afe5fb49b08eb130558cbf1240">UnitPriceExclTax</a> = scUnitPriceExclTax.price,</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    PriceInclTax = scSubTotalInclTax.price,</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                    PriceExclTax = scSubTotalExclTax.price,</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    OriginalProductCost = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">_priceCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html#a548db2ce044f290390e43a93bdb3140e">GetProductCostAsync</a>(product, sc.AttributesXml),</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                    AttributeDescription = attributeDescription,</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">AttributesXml</a> = sc.AttributesXml,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Quantity</a> = sc.Quantity,</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    DiscountAmountInclTax = discountAmountInclTax.price,</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    DiscountAmountExclTax = discountAmountExclTax.price,</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aed6bcf76e9af9efdc1b39036c07e2339">DownloadCount</a> = 0,</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2b6e46b2877ac8c8cbd01815811940fc">IsDownloadActivated</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aeb85b3b7b4160833212a34e82669cd0a">LicenseDownloadId</a> = 0,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a562e09ec2ece64b33dc1afcdbbbc0a99">ItemWeight</a> = itemWeight,</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    RentalStartDateUtc = sc.RentalStartDateUtc,</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                    RentalEndDateUtc = sc.RentalEndDateUtc</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                };</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#af5c522d07c4bfa70c71384b0d890c8f1">InsertOrderItemAsync</a>(orderItem);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                <span class="comment">//gift cards</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">AddGiftCardsAsync</a>(product, sc.AttributesXml, sc.Quantity, orderItem, scUnitPriceExclTax.price);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                <span class="comment">//inventory</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">AdjustInventoryAsync</a>(product, -sc.Quantity, sc.AttributesXml,</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.PlaceOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>));</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">//clear shopping cart</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            details.Cart.ToList().ForEach(async sci =&gt; await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a884ba6669f7571e0ecf5079877792a6e">DeleteShoppingCartItemAsync</a>(sci, <span class="keyword">false</span>));</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item.html">Nop.Core.Domain.Orders.OrderItem</a></div><div class="ttdoc">Represents an order item</div><div class="ttdef"><b>Definition:</b> OrderItem.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ac4b72d392fdabac68ba2bdfc50e63247"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync</a></div><div class="ttdeci">virtual async Task AddGiftCardsAsync(Product product, string attributesXml, int quantity, OrderItem orderItem, decimal? unitPriceExclTax=null, decimal? amount=null)</div><div class="ttdoc">Add gift cards</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1373</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service_html_a548db2ce044f290390e43a93bdb3140e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html#a548db2ce044f290390e43a93bdb3140e">Nop.Services.Catalog.IPriceCalculationService.GetProductCostAsync</a></div><div class="ttdeci">Task&lt; decimal &gt; GetProductCostAsync(Product product, string attributesXml)</div><div class="ttdoc">Gets the product cost (one item)</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter_html_a1e2ece5017fc654445aef796ee0f5c43"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html#a1e2ece5017fc654445aef796ee0f5c43">Nop.Services.Catalog.IProductAttributeFormatter.FormatAttributesAsync</a></div><div class="ttdeci">Task&lt; string &gt; FormatAttributesAsync(Product product, string attributesXml)</div><div class="ttdoc">Formats attributes</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_discounts_1_1_i_discount_service_html_aa31e5a6b1f11b300175fa360eb12b768"><div class="ttname"><a href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">Nop.Services.Discounts.IDiscountService.ContainsDiscount</a></div><div class="ttdeci">bool ContainsDiscount(IList&lt; Discount &gt; discounts, Discount discount)</div><div class="ttdoc">Check whether a list of discounts already contains a certain discount instance</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_af5c522d07c4bfa70c71384b0d890c8f1"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#af5c522d07c4bfa70c71384b0d890c8f1">Nop.Services.Orders.IOrderService.InsertOrderItemAsync</a></div><div class="ttdeci">Task InsertOrderItemAsync(OrderItem orderItem)</div><div class="ttdoc">Inserts a order item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a884ba6669f7571e0ecf5079877792a6e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a884ba6669f7571e0ecf5079877792a6e">Nop.Services.Orders.IShoppingCartService.DeleteShoppingCartItemAsync</a></div><div class="ttdeci">Task DeleteShoppingCartItemAsync(ShoppingCartItem shoppingCartItem, bool resetCheckoutData=true, bool ensureOnlyActiveCheckoutAttributes=false)</div><div class="ttdoc">Delete shopping cart item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_ace6ba6d15c59339c0ffdd2dac06371af"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#ace6ba6d15c59339c0ffdd2dac06371af">Nop.Services.Orders.IShoppingCartService.GetSubTotalAsync</a></div><div class="ttdeci">Task&lt;(decimal subTotal, decimal discountAmount, List&lt; Discount &gt; appliedDiscounts, int? maximumDiscountQty)&gt; GetSubTotalAsync(ShoppingCartItem shoppingCartItem, bool includeDiscounts)</div><div class="ttdoc">Gets the shopping cart item sub total</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_af024c8e7d05c5971d0aaf11c72ab6f8a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#af024c8e7d05c5971d0aaf11c72ab6f8a">Nop.Services.Orders.IShoppingCartService.GetUnitPriceAsync</a></div><div class="ttdeci">Task&lt;(decimal unitPrice, decimal discountAmount, List&lt; Discount &gt; appliedDiscounts)&gt; GetUnitPriceAsync(ShoppingCartItem shoppingCartItem, bool includeDiscounts)</div><div class="ttdoc">Gets the shopping cart unit price (one item)</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service_html_aedf9c8bfb29a2b4f086dcf3fb4b85a5a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html#aedf9c8bfb29a2b4f086dcf3fb4b85a5a">Nop.Services.Shipping.IShippingService.GetShoppingCartItemWeightAsync</a></div><div class="ttdeci">Task&lt; decimal &gt; GetShoppingCartItemWeightAsync(ShoppingCartItem shoppingCartItem, bool ignoreFreeShippedItems=false)</div><div class="ttdoc">Gets shopping cart item weight (of one item)</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_tax_1_1_i_tax_service_html_a3fc89fb59109314bd1358d290a8d3684"><div class="ttname"><a href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">Nop.Services.Tax.ITaxService.GetProductPriceAsync</a></div><div class="ttdeci">Task&lt;(decimal price, decimal taxRate)&gt; GetProductPriceAsync(Product product, decimal price)</div><div class="ttdoc">Gets price</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog_html_a5f43f2b53838c9c8c34cf27f06f5e78c"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">Nop.Web.Areas.Admin.Models.Catalog.ProductId</a></div><div class="ttdeci">int ProductId</div><div class="ttdef"><b>Definition:</b> AddAssociatedProductModel.cs:21</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog_html_a9bfc9e3c5477ae8ce198f4ed303671d1"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Nop.Web.Areas.Admin.Models.Catalog.Quantity</a></div><div class="ttdeci">int Quantity</div><div class="ttdef"><b>Definition:</b> TierPriceModel.cs:44</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog_html_ae45ef18dd721dd3c34b1c4eb15a5ca0c"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">Nop.Web.Areas.Admin.Models.Catalog.AttributesXml</a></div><div class="ttdeci">string AttributesXml</div><div class="ttdef"><b>Definition:</b> ProductAttributeCombinationModel.cs:30</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a2b6e46b2877ac8c8cbd01815811940fc"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2b6e46b2877ac8c8cbd01815811940fc">Nop.Web.Areas.Admin.Models.Orders.IsDownloadActivated</a></div><div class="ttdeci">bool IsDownloadActivated</div><div class="ttdef"><b>Definition:</b> OrderItemModel.cs:77</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a562e09ec2ece64b33dc1afcdbbbc0a99"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a562e09ec2ece64b33dc1afcdbbbc0a99">Nop.Web.Areas.Admin.Models.Orders.ItemWeight</a></div><div class="ttdeci">string ItemWeight</div><div class="ttdef"><b>Definition:</b> ShipmentItemModel.cs:40</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a9f44d521e2cb6de54997a4944fe78fb8"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9f44d521e2cb6de54997a4944fe78fb8">Nop.Web.Areas.Admin.Models.Orders.UnitPriceInclTax</a></div><div class="ttdeci">decimal UnitPriceInclTax</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:36</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_aeb85b3b7b4160833212a34e82669cd0a"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aeb85b3b7b4160833212a34e82669cd0a">Nop.Web.Areas.Admin.Models.Orders.LicenseDownloadId</a></div><div class="ttdeci">int LicenseDownloadId</div><div class="ttdef"><b>Definition:</b> UploadLicenseModel.cs:18</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_aed6bcf76e9af9efdc1b39036c07e2339"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aed6bcf76e9af9efdc1b39036c07e2339">Nop.Web.Areas.Admin.Models.Orders.DownloadCount</a></div><div class="ttdeci">int DownloadCount</div><div class="ttdef"><b>Definition:</b> OrderItemModel.cs:73</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_af128d4afe5fb49b08eb130558cbf1240"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af128d4afe5fb49b08eb130558cbf1240">Nop.Web.Areas.Admin.Models.Orders.UnitPriceExclTax</a></div><div class="ttdeci">decimal UnitPriceExclTax</div><div class="ttdef"><b>Definition:</b> AddProductToOrderModel.cs:38</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">Nop.Services.Orders.OrderProcessingService._priceCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">Nop.Services.Orders.OrderProcessingService._productAttributeFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">Nop.Services.Orders.OrderProcessingService._shippingService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">Nop.Services.Orders.OrderProcessingService._taxService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">Nop.Services.Catalog.IProductService.AdjustInventoryAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">Nop.Web.Areas.Admin.Models.Catalog.AttributesXml</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">Nop.Services.Discounts.IDiscountService.ContainsDiscount()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a884ba6669f7571e0ecf5079877792a6e">Nop.Services.Orders.IShoppingCartService.DeleteShoppingCartItemAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aed6bcf76e9af9efdc1b39036c07e2339">Nop.Web.Areas.Admin.Models.Orders.DownloadCount</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html#a1e2ece5017fc654445aef796ee0f5c43">Nop.Services.Catalog.IProductAttributeFormatter.FormatAttributesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html#a548db2ce044f290390e43a93bdb3140e">Nop.Services.Catalog.IPriceCalculationService.GetProductCostAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#a3fc89fb59109314bd1358d290a8d3684">Nop.Services.Tax.ITaxService.GetProductPriceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html#aedf9c8bfb29a2b4f086dcf3fb4b85a5a">Nop.Services.Shipping.IShippingService.GetShoppingCartItemWeightAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#ace6ba6d15c59339c0ffdd2dac06371af">Nop.Services.Orders.IShoppingCartService.GetSubTotalAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#af024c8e7d05c5971d0aaf11c72ab6f8a">Nop.Services.Orders.IShoppingCartService.GetUnitPriceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#af5c522d07c4bfa70c71384b0d890c8f1">Nop.Services.Orders.IOrderService.InsertOrderItemAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2b6e46b2877ac8c8cbd01815811940fc">Nop.Web.Areas.Admin.Models.Orders.IsDownloadActivated</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a562e09ec2ece64b33dc1afcdbbbc0a99">Nop.Web.Areas.Admin.Models.Orders.ItemWeight</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aeb85b3b7b4160833212a34e82669cd0a">Nop.Web.Areas.Admin.Models.Orders.LicenseDownloadId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">Nop.Web.Areas.Admin.Models.Catalog.ProductId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Nop.Web.Areas.Admin.Models.Catalog.Quantity</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af128d4afe5fb49b08eb130558cbf1240">Nop.Web.Areas.Admin.Models.Orders.UnitPriceExclTax</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9f44d521e2cb6de54997a4944fe78fb8">Nop.Web.Areas.Admin.Models.Orders.UnitPriceInclTax</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="a6623c66d5d0f34b520aa92df82552f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6623c66d5d0f34b520aa92df82552f37">&#9670;&nbsp;</a></span>PartiallyRefundAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal&#160;</td>
          <td class="paramname"><em>amountToRefund</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Partially refunds an order (from admin panel) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">amountToRefund</td><td>Amount to refund</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a list of errors; empty list if no errors </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#aad49f1a78fa658d15e389956d3f91a36">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        {</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">CanPartiallyRefundAsync</a>(order, amountToRefund))</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cannot do partial refund for order.&quot;</span>);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;            var request = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_request.html">RefundPaymentRequest</a>();</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_result.html">RefundPaymentResult</a> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;            {</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                request.Order = order;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                request.AmountToRefund = amountToRefund;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                request.IsPartialRefund = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; </div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a44d3a3bee742272dc64a0b83b04101c4">RefundAsync</a>(request);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                {</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                    <span class="comment">//total amount refunded</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                    var totalAmountRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> + amountToRefund;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                    <span class="comment">//update order info</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> = totalAmountRefunded;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                    <span class="comment">//mark payment status as &#39;Refunded&#39; if the order total amount is fully refunded</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == totalAmountRefunded &amp;&amp; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.PartiallyRefunded ? <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Refunded : <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                    <span class="comment">//add a note</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Order has been partially refunded. Amount = {amountToRefund}&quot;</span>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160; </div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                    <span class="comment">//check order status</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                    <span class="comment">//notifications</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                    var orderRefundedStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">SendOrderRefundedStoreOwnerNotificationAsync</a>(order, amountToRefund, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                    <span class="keywordflow">if</span> (orderRefundedStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160; </div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                    var orderRefundedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">SendOrderRefundedCustomerNotificationAsync</a>(order, amountToRefund, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                    <span class="keywordflow">if</span> (orderRefundedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                    <span class="comment">//raise event       </span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event.html">OrderRefundedEvent</a>(order, amountToRefund));</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_result.html">RefundPaymentResult</a>();</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError($<span class="stringliteral">&quot;Error: {exc.Message}. Full exception: {exc}&quot;</span>);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            }</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; </div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            <span class="comment">//process errors</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            var error = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count; i++)</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                error += $<span class="stringliteral">&quot;Error {i}: {result.Errors[i]}&quot;</span>;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                <span class="keywordflow">if</span> (i != <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count - 1)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                    error += <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(error))</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Unable to partially refund order. {error}&quot;</span>);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            <span class="comment">//log it</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            var logError = $<span class="stringliteral">&quot;Error refunding order #{order.Id}. Error: {error}&quot;</span>;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">InsertLogAsync</a>(<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">LogLevel</a>.Error, logError, logError);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_afac2b603ee3b2ff601163ed07164694e"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a></div><div class="ttdeci">int CustomerLanguageId</div><div class="ttdoc">Gets or sets the customer language identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:174</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event.html">Nop.Core.Domain.Orders.OrderRefundedEvent</a></div><div class="ttdoc">Order refunded event</div><div class="ttdef"><b>Definition:</b> OrderRefundedEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_af5c1027453ac2c150e4f5b5e34022883"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; CanPartiallyRefundAsync(Order order, decimal amountToRefund)</div><div class="ttdoc">Gets a value indicating whether partial refund from admin panel is allowed</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2718</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_refund_payment_request_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_request.html">Nop.Services.Payments.RefundPaymentRequest</a></div><div class="ttdoc">Represents a RefundPaymentResult</div><div class="ttdef"><b>Definition:</b> RefundPaymentRequest.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_refund_payment_result_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_result.html">Nop.Services.Payments.RefundPaymentResult</a></div><div class="ttdoc">Refund payment result</div><div class="ttdef"><b>Definition:</b> RefundPaymentResult.cs:11</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a024e725d06b93b18e5e5f8c46e0c1158"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderRefundedCustomerNotificationAsync(Order order, decimal refundedAmount, int languageId)</div><div class="ttdoc">Sends an order refunded notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_ab8088f4807759c499b93a6f4ad92f6d2"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedStoreOwnerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderRefundedStoreOwnerNotificationAsync(Order order, decimal refundedAmount, int languageId)</div><div class="ttdoc">Sends an order refunded notification to a store owner</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a44d3a3bee742272dc64a0b83b04101c4"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a44d3a3bee742272dc64a0b83b04101c4">Nop.Services.Payments.IPaymentService.RefundAsync</a></div><div class="ttdeci">Task&lt; RefundPaymentResult &gt; RefundAsync(RefundPaymentRequest refundPaymentRequest)</div><div class="ttdoc">Refunds a payment</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a44d3a3bee742272dc64a0b83b04101c4">Nop.Services.Payments.IPaymentService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a81e7a00a2b1767ccb3d8cc954a16eff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e7a00a2b1767ccb3d8cc954a16eff4">&#9670;&nbsp;</a></span>PartiallyRefundOfflineAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decimal&#160;</td>
          <td class="paramname"><em>amountToRefund</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Partially refunds an order (offline) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">amountToRefund</td><td>Amount to refund</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#af9b75bce3c735a94ceffd5728d32e263">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        {</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; </div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8d89f4c048a18b4790969a296a4d9952">CanPartiallyRefundOffline</a>(order, amountToRefund))</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;You can&#39;t partially refund (offline) this order&quot;</span>);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            <span class="comment">//total amount refunded</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            var totalAmountRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> + amountToRefund;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160; </div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;            <span class="comment">//update order info</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> = totalAmountRefunded;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;            <span class="comment">//mark payment status as &#39;Refunded&#39; if the order total amount is fully refunded</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> == totalAmountRefunded ? <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Refunded : <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.PartiallyRefunded;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Order has been marked as partially refunded. Amount = {amountToRefund}&quot;</span>);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; </div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            <span class="comment">//notifications</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;            var orderRefundedStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">SendOrderRefundedStoreOwnerNotificationAsync</a>(order, amountToRefund, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            <span class="keywordflow">if</span> (orderRefundedStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;            var orderRefundedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">SendOrderRefundedCustomerNotificationAsync</a>(order, amountToRefund, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            <span class="keywordflow">if</span> (orderRefundedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160; </div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <span class="comment">//raise event       </span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event.html">OrderRefundedEvent</a>(order, amountToRefund));</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a8d89f4c048a18b4790969a296a4d9952"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8d89f4c048a18b4790969a296a4d9952">Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundOffline</a></div><div class="ttdeci">virtual bool CanPartiallyRefundOffline(Order order, decimal amountToRefund)</div><div class="ttdoc">Gets a value indicating whether order can be marked as partially refunded</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2836</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8d89f4c048a18b4790969a296a4d9952">Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundOffline()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a6d2ae89a729ed2afc363893126b81958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2ae89a729ed2afc363893126b81958">&#9670;&nbsp;</a></span>PlaceOrderAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_place_order_result.html">PlaceOrderResult</a>&gt; Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Places an order </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the place order result </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a04b7db557357578a067772b6940a7a1d">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            <span class="keywordflow">if</span> (processPaymentRequest == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(processPaymentRequest));</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            var <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> PlaceOrderResult();</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                <span class="keywordflow">if</span> (processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1ad6e75bc8d6088bdd0ce3d710e3ee89">OrderGuid</a> == Guid.Empty)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Order GUID is not generated&quot;</span>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                <span class="comment">//prepare order details</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                var details = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">PreparePlaceOrderDetailsAsync</a>(processPaymentRequest);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                var processPaymentResult = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">GetProcessPaymentResultAsync</a>(processPaymentRequest, details);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                <span class="keywordflow">if</span> (processPaymentResult == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;processPaymentResult is not available&quot;</span>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                <span class="keywordflow">if</span> (processPaymentResult.Success)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                    var order = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">SaveOrderDetailsAsync</a>(processPaymentRequest, processPaymentResult, details);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.PlacedOrder = order;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                    <span class="comment">//move shopping cart items to order items</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">MoveShoppingCartItemsToOrderItemsAsync</a>(details, order);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                    <span class="comment">//discount usage history</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">SaveDiscountUsageHistoryAsync</a>(details, order);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                    <span class="comment">//gift card usage history</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">SaveGiftCardUsageHistoryAsync</a>(details, order);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                    <span class="comment">//recurring orders</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                    <span class="keywordflow">if</span> (details.IsRecurringShoppingCart) </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">CreateFirstRecurringPaymentAsync</a>(processPaymentRequest, order);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                    <span class="comment">//notifications</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">SendNotificationsAndSaveNotesAsync</a>(order);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                    <span class="comment">//reset checkout data</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a045bcbe8b8e6766c811b1097f91c6606">ResetCheckoutDataAsync</a>(details.Customer, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>, clearCouponCodes: <span class="keyword">true</span>, clearCheckoutAttributes: <span class="keyword">true</span>);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">_customerActivityService</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html#ace276cb05f95582a8b21c3bece105144">InsertActivityAsync</a>(<span class="stringliteral">&quot;PublicStore.PlaceOrder&quot;</span>,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                        <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;ActivityLog.PublicStore.PlaceOrder&quot;</span>), order.Id), order);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    <span class="comment">//check order status</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    <span class="comment">//raise event       </span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_placed_event.html">OrderPlacedEvent</a>(order));</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    <span class="keywordflow">if</span> (order.PaymentStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">ProcessOrderPaidAsync</a>(order);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    <span class="keywordflow">foreach</span> (var paymentError <span class="keywordflow">in</span> processPaymentResult.Errors)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError(<span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Checkout.PaymentError&quot;</span>), paymentError));</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">ErrorAsync</a>(exc.Message, exc);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError(exc.Message);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <span class="comment">//log errors</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            var logError = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Aggregate(<span class="stringliteral">&quot;Error while placing order. &quot;</span>,</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                (current, next) =&gt; $<span class="stringliteral">&quot;{current}Error {result.Errors.IndexOf(next) + 1}: {next}. &quot;</span>);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">CustomerId</a>);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">ErrorAsync</a>(logError, customer: customer);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_placed_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_placed_event.html">Nop.Core.Domain.Orders.OrderPlacedEvent</a></div><div class="ttdoc">Order placed event</div><div class="ttdef"><b>Definition:</b> OrderPlacedEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a11fe03f64d9156620bc0611240669287"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync</a></div><div class="ttdeci">virtual async Task SendNotificationsAndSaveNotesAsync(Order order)</div><div class="ttdoc">Send &quot;order placed&quot; notifications and save order notes</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:864</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a2c693d0278fa64204bbcac1f05df1651"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync</a></div><div class="ttdeci">virtual async Task MoveShoppingCartItemsToOrderItemsAsync(PlaceOrderContainer details, Order order)</div><div class="ttdoc">Move shopping cart items to order items</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1294</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a5fdc3a30ecd2f4fd151465b6b1953eb0"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync</a></div><div class="ttdeci">virtual async Task&lt; ProcessPaymentResult &gt; GetProcessPaymentResultAsync(ProcessPaymentRequest processPaymentRequest, PlaceOrderContainer details)</div><div class="ttdoc">Get process payment result</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1409</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a6f364e54df9c3c5e630d0251b3c4b6e2"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">Nop.Services.Orders.OrderProcessingService.CreateFirstRecurringPaymentAsync</a></div><div class="ttdeci">virtual async Task CreateFirstRecurringPaymentAsync(ProcessPaymentRequest processPaymentRequest, Order order)</div><div class="ttdoc">Create recurring payment (the first payment)</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1253</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a7fe03f365a1fb4e26dfa305562fa7d5e"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync</a></div><div class="ttdeci">virtual async Task&lt; PlaceOrderContainer &gt; PreparePlaceOrderDetailsAsync(ProcessPaymentRequest processPaymentRequest)</div><div class="ttdoc">Prepare details to place an order. It also sets some properties to &quot;processPaymentRequest&quot;</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:402</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ae28360b413dd34283242e7075da477d3"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">Nop.Services.Orders.OrderProcessingService.SaveDiscountUsageHistoryAsync</a></div><div class="ttdeci">virtual async Task SaveDiscountUsageHistoryAsync(PlaceOrderContainer details, Order order)</div><div class="ttdoc">Save discount usage history</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1473</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_aea58104edceca7eb0576dc9c02824f04"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync</a></div><div class="ttdeci">virtual async Task&lt; Order &gt; SaveOrderDetailsAsync(ProcessPaymentRequest processPaymentRequest, ProcessPaymentResult processPaymentResult, PlaceOrderContainer details)</div><div class="ttdoc">Save order and add order notes</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:765</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_af2b1d50935c535ba0709de02f3da3c05"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">Nop.Services.Orders.OrderProcessingService.SaveGiftCardUsageHistoryAsync</a></div><div class="ttdeci">virtual async Task SaveGiftCardUsageHistoryAsync(PlaceOrderContainer details, Order order)</div><div class="ttdoc">Save gift card usage history</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1452</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a1ad6e75bc8d6088bdd0ce3d710e3ee89"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1ad6e75bc8d6088bdd0ce3d710e3ee89">Nop.Services.Payments.ProcessPaymentRequest.OrderGuid</a></div><div class="ttdeci">Guid OrderGuid</div><div class="ttdoc">Gets or sets an order unique identifier. Used when order is not saved yet (payment gateways that do n...</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:32</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a045bcbe8b8e6766c811b1097f91c6606"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a045bcbe8b8e6766c811b1097f91c6606">Nop.Services.Customers.ICustomerService.ResetCheckoutDataAsync</a></div><div class="ttdeci">Task ResetCheckoutDataAsync(Customer customer, int storeId, bool clearCouponCodes=false, bool clearCheckoutAttributes=false, bool clearRewardPoints=true, bool clearShippingMethod=true, bool clearPaymentMethod=true)</div><div class="ttdoc">Reset data required for checkout</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service_html_ace276cb05f95582a8b21c3bece105144"><div class="ttname"><a href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html#ace276cb05f95582a8b21c3bece105144">Nop.Services.Logging.ICustomerActivityService.InsertActivityAsync</a></div><div class="ttdeci">Task&lt; ActivityLog &gt; InsertActivityAsync(string systemKeyword, string comment, BaseEntity entity=null)</div><div class="ttdoc">Inserts an activity log item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_logging_1_1_i_logger_html_a79f003fceaa9adc00f36f8654be85913"><div class="ttname"><a href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">Nop.Services.Logging.ILogger.ErrorAsync</a></div><div class="ttdeci">Task ErrorAsync(string message, Exception exception=null, Customer customer=null)</div><div class="ttdoc">Error</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9e8d965a1d5e4b9abd89d5b8167c7fae">Nop.Services.Orders.OrderProcessingService._customerActivityService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">Nop.Services.Orders.OrderProcessingService.CreateFirstRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">Nop.Services.Payments.ProcessPaymentRequest.CustomerId</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">Nop.Services.Logging.ILogger.ErrorAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html#ace276cb05f95582a8b21c3bece105144">Nop.Services.Logging.ICustomerActivityService.InsertActivityAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1ad6e75bc8d6088bdd0ce3d710e3ee89">Nop.Services.Payments.ProcessPaymentRequest.OrderGuid</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a045bcbe8b8e6766c811b1097f91c6606">Nop.Services.Customers.ICustomerService.ResetCheckoutDataAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">Nop.Services.Orders.OrderProcessingService.SaveDiscountUsageHistoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">Nop.Services.Orders.OrderProcessingService.SaveGiftCardUsageHistoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">Nop.Services.Payments.ProcessPaymentRequest.StoreId</a>.</p>

</div>
</div>
<a id="a7fe03f365a1fb4e26dfa305562fa7d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fe03f365a1fb4e26dfa305562fa7d5e">&#9670;&nbsp;</a></span>PreparePlaceOrderDetailsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&gt; Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare details to place an order. It also sets some properties to "processPaymentRequest" </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the details </dd></dl>
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            var details = <span class="keyword">new</span> PlaceOrderContainer</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="comment">//customer</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Customer</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">CustomerId</a>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            };</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">if</span> (details.Customer == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<span class="stringliteral">&quot;Customer is not set&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">//affiliate</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            var affiliate = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">_affiliateService</a>.<a class="code" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html#ab888b7c22d44ae6f781bfc0611855315">GetAffiliateByIdAsync</a>(details.Customer.AffiliateId);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">if</span> (affiliate != <span class="keyword">null</span> &amp;&amp; affiliate.Active &amp;&amp; !affiliate.Deleted)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                details.AffiliateId = affiliate.Id;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">//check whether customer is guest</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a1ea83a743a13cc9e5dda268a57f16f1f">IsGuestAsync</a>(details.Customer) &amp;&amp; !<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#aa744bb22abf06693a671caeade716b1e">AnonymousCheckoutAllowed</a>)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Anonymous checkout is not allowed&quot;</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">//customer currency</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            var currencyTmp = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a81c78d1c9841ac8dc226e43d5a19a4e4">GetCurrencyByIdAsync</a>(</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">int</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a2822cda4872e4da9449b86f3442aa87c">CurrencyIdAttribute</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            var customerCurrency = currencyTmp != <span class="keyword">null</span> &amp;&amp; currencyTmp.Published ? currencyTmp : await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a34d59971fa4eafe471e74c89f0d05349">GetWorkingCurrencyAsync</a>();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            var primaryStoreCurrency = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a81c78d1c9841ac8dc226e43d5a19a4e4">GetCurrencyByIdAsync</a>(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">_currencySettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html#a5d5ba8e598d20352aa491a9924572da8">PrimaryStoreCurrencyId</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            details.CustomerCurrencyCode = customerCurrency.CurrencyCode;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            details.CustomerCurrencyRate = customerCurrency.Rate / primaryStoreCurrency.Rate;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="comment">//customer language</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            details.CustomerLanguage = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">GetLanguageByIdAsync</a>(</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">int</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a722df216cf706b1c1e6daa60a7be761f">LanguageIdAttribute</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>));</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span> (details.CustomerLanguage == <span class="keyword">null</span> || !details.CustomerLanguage.Published)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                details.CustomerLanguage = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a686f2cf36883b0c44436ddbf33a023a5">GetWorkingLanguageAsync</a>();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="comment">//billing address</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">if</span> (details.Customer.BillingAddressId is <span class="keyword">null</span>)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Billing address is not provided&quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            var billingAddress = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a471cc5d9241f6a904f37247ffbdc46e8">GetCustomerBillingAddressAsync</a>(details.Customer);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_core_1_1_common_helper.html">CommonHelper</a>.<a class="code" href="class_nop_1_1_core_1_1_common_helper.html#a78b50a7979169f28157c685159b92884">IsValidEmail</a>(billingAddress?.Email))</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Email is not valid&quot;</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            details.BillingAddress = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">CloneAddress</a>(billingAddress);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">GetCountryByAddressAsync</a>(details.BillingAddress) is <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html">Country</a> billingCountry &amp;&amp; !billingCountry.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#a6619fd0db3b4fa53560eac21612ce42e">AllowsBilling</a>)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>($<span class="stringliteral">&quot;Country &#39;{billingCountry.Name}&#39; is not allowed for billing&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="comment">//checkout attributes</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            details.CheckoutAttributesXml = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">string</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a7fad329b67b90c06f515599945aa20ef">CheckoutAttributes</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            details.CheckoutAttributeDescription = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">_checkoutAttributeFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html#a5454bfd26689d9f8a88d22fe9087159a">FormatAttributesAsync</a>(details.CheckoutAttributesXml, details.Customer);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="comment">//load shopping cart</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            details.Cart = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a57f855d8ca2ffb0465bc91d84ae253e1">GetShoppingCartAsync</a>(details.Customer, <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#ae2fb88620fcd3889e6e0504e7b18e806">ShoppingCartType</a>.ShoppingCart, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">if</span> (!details.Cart.Any())</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cart is empty&quot;</span>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="comment">//validate the entire shopping cart</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            var warnings = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a23bee3e064339be31d645cf8d8763cd4">GetShoppingCartWarningsAsync</a>(details.Cart, details.CheckoutAttributesXml, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">if</span> (warnings.Any())</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(warnings.Aggregate(<span class="keywordtype">string</span>.Empty, (current, next) =&gt; $<span class="stringliteral">&quot;{current}{next};&quot;</span>));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="comment">//validate individual cart items</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">foreach</span> (var sci <span class="keywordflow">in</span> details.Cart)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(sci.ProductId);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                var sciWarnings = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a372f2e1d392903a70e272a1cfc5ed0e5">GetShoppingCartItemWarningsAsync</a>(details.Customer,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    sci.ShoppingCartType, product, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>, sci.AttributesXml,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    sci.CustomerEnteredPrice, sci.RentalStartDateUtc, sci.RentalEndDateUtc, sci.Quantity, <span class="keyword">false</span>, sci.Id);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">if</span> (sciWarnings.Any())</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(sciWarnings.Aggregate(<span class="keywordtype">string</span>.Empty, (current, next) =&gt; $<span class="stringliteral">&quot;{current}{next};&quot;</span>));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="comment">//min totals validation</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">ValidateMinOrderSubtotalAmountAsync</a>(details.Cart))</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                var minOrderSubtotalAmount = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a232e7d559ba6ca61f2cb80cbcf5f0be5">ConvertFromPrimaryStoreCurrencyAsync</a>(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">MinOrderSubtotalAmount</a>, await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a34d59971fa4eafe471e74c89f0d05349">GetWorkingCurrencyAsync</a>());</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Checkout.MinOrderSubtotalAmount&quot;</span>),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">_priceFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html#a5e131524dfbb20c6d2d175f3323de98a">FormatPriceAsync</a>(minOrderSubtotalAmount, <span class="keyword">true</span>, <span class="keyword">false</span>)));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">ValidateMinOrderTotalAmountAsync</a>(details.Cart))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                var minOrderTotalAmount = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">_currencyService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a232e7d559ba6ca61f2cb80cbcf5f0be5">ConvertFromPrimaryStoreCurrencyAsync</a>(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">MinOrderTotalAmount</a>, await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a34d59971fa4eafe471e74c89f0d05349">GetWorkingCurrencyAsync</a>());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Checkout.MinOrderTotalAmount&quot;</span>),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">_priceFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html#a5e131524dfbb20c6d2d175f3323de98a">FormatPriceAsync</a>(minOrderTotalAmount, <span class="keyword">true</span>, <span class="keyword">false</span>)));</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="comment">//tax display type</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">_taxSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#ad8b0185cf2d4654763f15d5725034b0f">AllowCustomersToSelectTaxDisplayType</a>)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                details.CustomerTaxDisplayType = (<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#ad59b7fb4d9c43ceac91df05de550018c">TaxDisplayType</a>)await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">int</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aefa3c76e25cd71c1750abcdbfc214723">TaxDisplayTypeIdAttribute</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                details.CustomerTaxDisplayType = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">_taxSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#a82f18b7fa06a2b57db30c1128c4def25">TaxDisplayType</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="comment">//sub total (incl tax)</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            var (orderSubTotalDiscountAmount, orderSubTotalAppliedDiscounts, subTotalWithoutDiscountBase, _, _) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">GetShoppingCartSubTotalAsync</a>(details.Cart, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            details.OrderSubTotalInclTax = subTotalWithoutDiscountBase;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            details.OrderSubTotalDiscountInclTax = orderSubTotalDiscountAmount;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="comment">//discount history</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">foreach</span> (var disc <span class="keywordflow">in</span> orderSubTotalAppliedDiscounts)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">ContainsDiscount</a>(details.AppliedDiscounts, disc))</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    details.AppliedDiscounts.Add(disc);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="comment">//sub total (excl tax)</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            (orderSubTotalDiscountAmount, _, subTotalWithoutDiscountBase, _, _) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">GetShoppingCartSubTotalAsync</a>(details.Cart, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            details.OrderSubTotalExclTax = subTotalWithoutDiscountBase;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            details.OrderSubTotalDiscountExclTax = orderSubTotalDiscountAmount;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="comment">//shipping info</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a7be2776062568ed611d05f199573ee70">ShoppingCartRequiresShippingAsync</a>(details.Cart))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                var pickupPoint = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html">PickupPoint</a>&gt;(details.Customer,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aa4d75ce1339c91da5107f4aebf624196">SelectedPickupPointAttribute</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">_shippingSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html#a97d22567945cbe195a3063c4262e856a">AllowPickupInStore</a> &amp;&amp; pickupPoint != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    var country = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ab210ec12fa25e8566e7996696322acfd">GetCountryByTwoLetterIsoCodeAsync</a>(pickupPoint.CountryCode);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    var state = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">_stateProvinceService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html#a2b5e45990cbddc0360d43b258d522dd1">GetStateProvinceByAbbreviationAsync</a>(pickupPoint.StateAbbreviation, country?.Id);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    details.PickupInStore = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    details.PickupAddress = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_common_1_1_address.html">Address</a></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a8dead30ac8b6c9929325dae406bc9ff5">Address1</a> = pickupPoint.Address,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a41fd119446f105b297fde3d88d79d8b1">City</a> = pickupPoint.City,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#aabdfd67c26d0ba001d2d0a49cee7d454">County</a> = pickupPoint.County,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        <a class="code" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#ade9e47c6ab2d9608a96bb049d71e80b2">CountryId</a> = country?.Id,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        <a class="code" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#a67af1a2410a1c6a569e85b6df0fe75ac">StateProvinceId</a> = state?.Id,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a9125d4e9a486a66d6c2f526872ee08ac">ZipPostalCode</a> = pickupPoint.ZipPostalCode,</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    };</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    <span class="keywordflow">if</span> (details.Customer.ShippingAddressId == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Shipping address is not provided&quot;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    var shippingAddress = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#ac550950db302400f38f7798af6210548">GetCustomerShippingAddressAsync</a>(details.Customer);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_core_1_1_common_helper.html">CommonHelper</a>.<a class="code" href="class_nop_1_1_core_1_1_common_helper.html#a78b50a7979169f28157c685159b92884">IsValidEmail</a>(shippingAddress?.Email))</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Email is not valid&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    <span class="comment">//clone shipping address</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    details.ShippingAddress = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">CloneAddress</a>(shippingAddress);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">GetCountryByAddressAsync</a>(details.ShippingAddress) is <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html">Country</a> shippingCountry &amp;&amp; !shippingCountry.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#af8d60303d1011037f99c2c615e9e82da">AllowsShipping</a>)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>($<span class="stringliteral">&quot;Country &#39;{shippingCountry.Name}&#39; is not allowed for shipping&quot;</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                var shippingOption = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option.html">ShippingOption</a>&gt;(details.Customer,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a06d4f563dd9b4b4a2af69a17561fa29d">SelectedShippingOptionAttribute</a>, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordflow">if</span> (shippingOption != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    details.ShippingMethodName = shippingOption.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option.html#a7cf0288af132677b5a521a5e0a831dd9">Name</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    details.ShippingRateComputationMethodSystemName = shippingOption.ShippingRateComputationMethodSystemName;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                details.ShippingStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.NotYetShipped;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                details.ShippingStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.ShippingNotRequired;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="comment">//shipping total</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            var (orderShippingTotalInclTax, _, shippingTotalDiscounts) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ad04b78079fef3880d2a2040cab84bb99">GetShoppingCartShippingTotalAsync</a>(details.Cart, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            var (orderShippingTotalExclTax, _, _) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ad04b78079fef3880d2a2040cab84bb99">GetShoppingCartShippingTotalAsync</a>(details.Cart, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">if</span> (!orderShippingTotalInclTax.HasValue || !orderShippingTotalExclTax.HasValue)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Shipping total couldn&#39;t be calculated&quot;</span>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            details.OrderShippingTotalInclTax = orderShippingTotalInclTax.Value;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            details.OrderShippingTotalExclTax = orderShippingTotalExclTax.Value;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">foreach</span> (var disc <span class="keywordflow">in</span> shippingTotalDiscounts)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">ContainsDiscount</a>(details.AppliedDiscounts, disc))</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    details.AppliedDiscounts.Add(disc);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="comment">//payment total</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            var paymentAdditionalFee = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a9fc76bc9d2ffa2e9b6e3b64e4c985068">GetAdditionalHandlingFeeAsync</a>(details.Cart, processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            details.PaymentAdditionalFeeInclTax = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#ad498f4d40d26e50851b2d554b406b24a">GetPaymentMethodAdditionalFeeAsync</a>(paymentAdditionalFee, <span class="keyword">true</span>, details.Customer)).price;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            details.PaymentAdditionalFeeExclTax = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">_taxService</a>.<a class="code" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#ad498f4d40d26e50851b2d554b406b24a">GetPaymentMethodAdditionalFeeAsync</a>(paymentAdditionalFee, <span class="keyword">false</span>, details.Customer)).price;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="comment">//tax amount</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            SortedDictionary&lt;decimal, decimal&gt; taxRatesDictionary;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            (details.OrderTaxTotal, taxRatesDictionary) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a49f53830a529dec35134f08cb0380665">GetTaxTotalAsync</a>(details.Cart);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="comment">//VAT number</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            var customerVatStatus = (<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#a1e41366ee169068a235af7db450cae15">VatNumberStatus</a>)await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">int</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a9a6dcb7d10234c5db6437124b33edf8c">VatNumberStatusIdAttribute</a>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">_taxSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#afd627f2ff228d772e5f5f724d9253ca3">EuVatEnabled</a> &amp;&amp; customerVatStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#a1e41366ee169068a235af7db450cae15">VatNumberStatus</a>.Valid)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                details.VatNumber = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.GetAttributeAsync&lt;<span class="keywordtype">string</span>&gt;(details.Customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#ad0d12dbb2b57a95254cd4ec22b8de6ff">VatNumberAttribute</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">//tax rates</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            details.TaxRates = taxRatesDictionary.Aggregate(<span class="keywordtype">string</span>.Empty, (current, next) =&gt;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                $<span class="stringliteral">&quot;{current}{next.Key.ToString(CultureInfo.InvariantCulture)}:{next.Value.ToString(CultureInfo.InvariantCulture)};   &quot;</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="comment">//order total (and applied discounts, gift cards, reward points)</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            var (orderTotal, orderDiscountAmount, orderAppliedDiscounts, appliedGiftCards, redeemedRewardPoints,  redeemedRewardPointsAmount) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">GetShoppingCartTotalAsync</a>(details.Cart);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">if</span> (!orderTotal.HasValue)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Order total couldn&#39;t be calculated&quot;</span>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            details.OrderDiscountAmount = orderDiscountAmount;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            details.RedeemedRewardPoints = redeemedRewardPoints;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            details.RedeemedRewardPointsAmount = redeemedRewardPointsAmount;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            details.AppliedGiftCards = appliedGiftCards;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            details.OrderTotal = orderTotal.Value;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">//discount history</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">foreach</span> (var disc <span class="keywordflow">in</span> orderAppliedDiscounts)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">ContainsDiscount</a>(details.AppliedDiscounts, disc))</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    details.AppliedDiscounts.Add(disc);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a0c5837b2c79b22f63e3825f06ebc848d">OrderTotal</a> = details.OrderTotal;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="comment">//recurring or standard shopping cart?</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            details.IsRecurringShoppingCart = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a3b580677af40869cbfe3f61aff6faa20">ShoppingCartIsRecurringAsync</a>(details.Cart);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">if</span> (!details.IsRecurringShoppingCart)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="keywordflow">return</span> details;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            var (recurringCyclesError, recurringCycleLength, recurringCyclePeriod, recurringTotalCycles) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a861f1b42fac7692f3873d76123e03a09">GetRecurringCycleInfoAsync</a>(details.Cart);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(recurringCyclesError))</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(recurringCyclesError);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a9706413e3020ec3fcaca17a98b0e989e">RecurringCycleLength</a> = recurringCycleLength;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a08372489cdf545bd5d84cf74937b1feb">RecurringCyclePeriod</a> = recurringCyclePeriod;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6886a986ee35038a9c951e47c12dabca">RecurringTotalCycles</a> = recurringTotalCycles;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">return</span> details;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_common_helper_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_common_helper.html">Nop.Core.CommonHelper</a></div><div class="ttdoc">Represents a common helper</div><div class="ttdef"><b>Definition:</b> CommonHelper.cs:17</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_common_helper_html_a78b50a7979169f28157c685159b92884"><div class="ttname"><a href="class_nop_1_1_core_1_1_common_helper.html#a78b50a7979169f28157c685159b92884">Nop.Core.CommonHelper.IsValidEmail</a></div><div class="ttdeci">static bool IsValidEmail(string email)</div><div class="ttdoc">Verifies that a string is in valid e-mail format</div><div class="ttdef"><b>Definition:</b> CommonHelper.cs:62</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_common_1_1_address_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_common_1_1_address.html">Nop.Core.Domain.Common.Address</a></div><div class="ttdoc">Address</div><div class="ttdef"><b>Definition:</b> Address.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer.html">Nop.Core.Domain.Customers.Customer</a></div><div class="ttdoc">Represents a customer</div><div class="ttdef"><b>Definition:</b> Customer.cs:10</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">Nop.Core.Domain.Customers.NopCustomerDefaults</a></div><div class="ttdoc">Represents default values related to customers data</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_a06d4f563dd9b4b4a2af69a17561fa29d"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a06d4f563dd9b4b4a2af69a17561fa29d">Nop.Core.Domain.Customers.NopCustomerDefaults.SelectedShippingOptionAttribute</a></div><div class="ttdeci">static string SelectedShippingOptionAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'SelectedShippingOption'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:226</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_a2822cda4872e4da9449b86f3442aa87c"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a2822cda4872e4da9449b86f3442aa87c">Nop.Core.Domain.Customers.NopCustomerDefaults.CurrencyIdAttribute</a></div><div class="ttdeci">static string CurrencyIdAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'CurrencyId'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:206</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_a722df216cf706b1c1e6daa60a7be761f"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a722df216cf706b1c1e6daa60a7be761f">Nop.Core.Domain.Customers.NopCustomerDefaults.LanguageIdAttribute</a></div><div class="ttdeci">static string LanguageIdAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'LanguageId'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:211</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_a7fad329b67b90c06f515599945aa20ef"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a7fad329b67b90c06f515599945aa20ef">Nop.Core.Domain.Customers.NopCustomerDefaults.CheckoutAttributes</a></div><div class="ttdeci">static string CheckoutAttributes</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'CheckoutAttributes'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:236</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_a9a6dcb7d10234c5db6437124b33edf8c"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a9a6dcb7d10234c5db6437124b33edf8c">Nop.Core.Domain.Customers.NopCustomerDefaults.VatNumberStatusIdAttribute</a></div><div class="ttdeci">static string VatNumberStatusIdAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'VatNumberStatusId'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:131</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_aa4d75ce1339c91da5107f4aebf624196"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aa4d75ce1339c91da5107f4aebf624196">Nop.Core.Domain.Customers.NopCustomerDefaults.SelectedPickupPointAttribute</a></div><div class="ttdeci">static string SelectedPickupPointAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'SelectedPickupPoint'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:231</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_ad0d12dbb2b57a95254cd4ec22b8de6ff"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#ad0d12dbb2b57a95254cd4ec22b8de6ff">Nop.Core.Domain.Customers.NopCustomerDefaults.VatNumberAttribute</a></div><div class="ttdeci">static string VatNumberAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'VatNumber'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:126</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults_html_aefa3c76e25cd71c1750abcdbfc214723"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aefa3c76e25cd71c1750abcdbfc214723">Nop.Core.Domain.Customers.NopCustomerDefaults.TaxDisplayTypeIdAttribute</a></div><div class="ttdeci">static string TaxDisplayTypeIdAttribute</div><div class="ttdoc">Gets a name of generic attribute to store the value of 'TaxDisplayTypeId'</div><div class="ttdef"><b>Definition:</b> NopCustomerDefaults.cs:261</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_directory_1_1_country_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html">Nop.Core.Domain.Directory.Country</a></div><div class="ttdoc">Represents a country</div><div class="ttdef"><b>Definition:</b> Country.cs:10</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_directory_1_1_country_html_a6619fd0db3b4fa53560eac21612ce42e"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#a6619fd0db3b4fa53560eac21612ce42e">Nop.Core.Domain.Directory.Country.AllowsBilling</a></div><div class="ttdeci">bool AllowsBilling</div><div class="ttdoc">Gets or sets a value indicating whether billing is allowed to this country</div><div class="ttdef"><b>Definition:</b> Country.cs:19</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_directory_1_1_country_html_af8d60303d1011037f99c2c615e9e82da"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#af8d60303d1011037f99c2c615e9e82da">Nop.Core.Domain.Directory.Country.AllowsShipping</a></div><div class="ttdeci">bool AllowsShipping</div><div class="ttdoc">Gets or sets a value indicating whether shipping is allowed to this country</div><div class="ttdef"><b>Definition:</b> Country.cs:24</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings_html_a5d5ba8e598d20352aa491a9924572da8"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html#a5d5ba8e598d20352aa491a9924572da8">Nop.Core.Domain.Directory.CurrencySettings.PrimaryStoreCurrencyId</a></div><div class="ttdeci">int PrimaryStoreCurrencyId</div><div class="ttdoc">Primary store currency identifier</div><div class="ttdef"><b>Definition:</b> CurrencySettings.cs:18</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a30d55228ecdde267161c342936bc33fa"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">Nop.Core.Domain.Orders.OrderSettings.MinOrderSubtotalAmount</a></div><div class="ttdeci">decimal MinOrderSubtotalAmount</div><div class="ttdoc">Gets or sets a minimum order subtotal amount</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:18</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_aa744bb22abf06693a671caeade716b1e"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#aa744bb22abf06693a671caeade716b1e">Nop.Core.Domain.Orders.OrderSettings.AnonymousCheckoutAllowed</a></div><div class="ttdeci">bool AnonymousCheckoutAllowed</div><div class="ttdoc">Gets or sets a value indicating whether anonymous checkout allowed</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:39</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_ae6448db4ab3f78dc75d767667214dc61"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">Nop.Core.Domain.Orders.OrderSettings.MinOrderTotalAmount</a></div><div class="ttdeci">decimal MinOrderTotalAmount</div><div class="ttdoc">Gets or sets a minimum order total amount</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:29</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html">Nop.Core.Domain.Shipping.PickupPoint</a></div><div class="ttdoc">Pickup point</div><div class="ttdef"><b>Definition:</b> PickupPoint.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option.html">Nop.Core.Domain.Shipping.ShippingOption</a></div><div class="ttdoc">Represents a shipping option</div><div class="ttdef"><b>Definition:</b> ShippingOption.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option_html_a7cf0288af132677b5a521a5e0a831dd9"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option.html#a7cf0288af132677b5a521a5e0a831dd9">Nop.Core.Domain.Shipping.ShippingOption.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">Gets or sets a shipping option name</div><div class="ttdef"><b>Definition:</b> ShippingOption.cs:21</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings_html_a97d22567945cbe195a3063c4262e856a"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html#a97d22567945cbe195a3063c4262e856a">Nop.Core.Domain.Shipping.ShippingSettings.AllowPickupInStore</a></div><div class="ttdeci">bool AllowPickupInStore</div><div class="ttdoc">Gets or sets a value indicating whether customers can choose &quot;Pick Up in Store&quot; option during checkou...</div><div class="ttdef"><b>Definition:</b> ShippingSettings.cs:35</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings_html_a82f18b7fa06a2b57db30c1128c4def25"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#a82f18b7fa06a2b57db30c1128c4def25">Nop.Core.Domain.Tax.TaxSettings.TaxDisplayType</a></div><div class="ttdeci">TaxDisplayType TaxDisplayType</div><div class="ttdoc">Tax display type</div><div class="ttdef"><b>Definition:</b> TaxSettings.cs:23</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings_html_ad8b0185cf2d4654763f15d5725034b0f"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#ad8b0185cf2d4654763f15d5725034b0f">Nop.Core.Domain.Tax.TaxSettings.AllowCustomersToSelectTaxDisplayType</a></div><div class="ttdeci">bool AllowCustomersToSelectTaxDisplayType</div><div class="ttdoc">Gets or sets a value indicating whether customers are allowed to select tax display type</div><div class="ttdef"><b>Definition:</b> TaxSettings.cs:53</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings_html_afd627f2ff228d772e5f5f724d9253ca3"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#afd627f2ff228d772e5f5f724d9253ca3">Nop.Core.Domain.Tax.TaxSettings.EuVatEnabled</a></div><div class="ttdeci">bool EuVatEnabled</div><div class="ttdoc">Gets or sets a value indicating whether EU VAT (Europe Union Value Added Tax) is enabled</div><div class="ttdef"><b>Definition:</b> TaxSettings.cs:108</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_aa5f9da9315f1980c60a43f756b7dc85c"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderTotalAmountAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; ValidateMinOrderTotalAmountAsync(IList&lt; ShoppingCartItem &gt; cart)</div><div class="ttdoc">Validate minimum order total amount</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:3143</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ab2cedc770d4bd92ee976dcb0cec0604b"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderSubtotalAmountAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; ValidateMinOrderSubtotalAmountAsync(IList&lt; ShoppingCartItem &gt; cart)</div><div class="ttdoc">Validate minimum order sub-total amount</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:3117</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a0c5837b2c79b22f63e3825f06ebc848d"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a0c5837b2c79b22f63e3825f06ebc848d">Nop.Services.Payments.ProcessPaymentRequest.OrderTotal</a></div><div class="ttdeci">decimal OrderTotal</div><div class="ttdoc">Gets or sets an order total</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:42</div></div>
<div class="ttc" id="ainterface_nop_1_1_core_1_1_i_work_context_html_a34d59971fa4eafe471e74c89f0d05349"><div class="ttname"><a href="interface_nop_1_1_core_1_1_i_work_context.html#a34d59971fa4eafe471e74c89f0d05349">Nop.Core.IWorkContext.GetWorkingCurrencyAsync</a></div><div class="ttdeci">Task&lt; Currency &gt; GetWorkingCurrencyAsync()</div><div class="ttdoc">Gets or sets current user working currency</div></div>
<div class="ttc" id="ainterface_nop_1_1_core_1_1_i_work_context_html_a686f2cf36883b0c44436ddbf33a023a5"><div class="ttname"><a href="interface_nop_1_1_core_1_1_i_work_context.html#a686f2cf36883b0c44436ddbf33a023a5">Nop.Core.IWorkContext.GetWorkingLanguageAsync</a></div><div class="ttdeci">Task&lt; Language &gt; GetWorkingLanguageAsync()</div><div class="ttdoc">Gets current user working language</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service_html_ab888b7c22d44ae6f781bfc0611855315"><div class="ttname"><a href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html#ab888b7c22d44ae6f781bfc0611855315">Nop.Services.Affiliates.IAffiliateService.GetAffiliateByIdAsync</a></div><div class="ttdeci">Task&lt; Affiliate &gt; GetAffiliateByIdAsync(int affiliateId)</div><div class="ttdoc">Gets an affiliate by affiliate identifier</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter_html_a5e131524dfbb20c6d2d175f3323de98a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html#a5e131524dfbb20c6d2d175f3323de98a">Nop.Services.Catalog.IPriceFormatter.FormatPriceAsync</a></div><div class="ttdeci">Task&lt; string &gt; FormatPriceAsync(decimal price)</div><div class="ttdoc">Formats the price</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_common_1_1_i_address_service_html_a797b198a52ae7dee8e287f4aa47cafc5"><div class="ttname"><a href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">Nop.Services.Common.IAddressService.CloneAddress</a></div><div class="ttdeci">Address CloneAddress(Address address)</div><div class="ttdoc">Clone address</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a1ea83a743a13cc9e5dda268a57f16f1f"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a1ea83a743a13cc9e5dda268a57f16f1f">Nop.Services.Customers.ICustomerService.IsGuestAsync</a></div><div class="ttdeci">Task&lt; bool &gt; IsGuestAsync(Customer customer, bool onlyActiveCustomerRoles=true)</div><div class="ttdoc">Gets a value indicating whether customer is guest</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a471cc5d9241f6a904f37247ffbdc46e8"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a471cc5d9241f6a904f37247ffbdc46e8">Nop.Services.Customers.ICustomerService.GetCustomerBillingAddressAsync</a></div><div class="ttdeci">Task&lt; Address &gt; GetCustomerBillingAddressAsync(Customer customer)</div><div class="ttdoc">Gets a customer billing address</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_ac550950db302400f38f7798af6210548"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#ac550950db302400f38f7798af6210548">Nop.Services.Customers.ICustomerService.GetCustomerShippingAddressAsync</a></div><div class="ttdeci">Task&lt; Address &gt; GetCustomerShippingAddressAsync(Customer customer)</div><div class="ttdoc">Gets a customer shipping address</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_directory_1_1_i_country_service_html_ab210ec12fa25e8566e7996696322acfd"><div class="ttname"><a href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ab210ec12fa25e8566e7996696322acfd">Nop.Services.Directory.ICountryService.GetCountryByTwoLetterIsoCodeAsync</a></div><div class="ttdeci">Task&lt; Country &gt; GetCountryByTwoLetterIsoCodeAsync(string twoLetterIsoCode)</div><div class="ttdoc">Gets a country by two letter ISO code</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_directory_1_1_i_country_service_html_ac5036ded2f392a64646355d5e49e3936"><div class="ttname"><a href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">Nop.Services.Directory.ICountryService.GetCountryByAddressAsync</a></div><div class="ttdeci">Task&lt; Country &gt; GetCountryByAddressAsync(Address address)</div><div class="ttdoc">Gets a country by address</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_directory_1_1_i_currency_service_html_a232e7d559ba6ca61f2cb80cbcf5f0be5"><div class="ttname"><a href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a232e7d559ba6ca61f2cb80cbcf5f0be5">Nop.Services.Directory.ICurrencyService.ConvertFromPrimaryStoreCurrencyAsync</a></div><div class="ttdeci">Task&lt; decimal &gt; ConvertFromPrimaryStoreCurrencyAsync(decimal amount, Currency targetCurrencyCode)</div><div class="ttdoc">Converts from primary store currency</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_directory_1_1_i_currency_service_html_a81c78d1c9841ac8dc226e43d5a19a4e4"><div class="ttname"><a href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a81c78d1c9841ac8dc226e43d5a19a4e4">Nop.Services.Directory.ICurrencyService.GetCurrencyByIdAsync</a></div><div class="ttdeci">Task&lt; Currency &gt; GetCurrencyByIdAsync(int currencyId)</div><div class="ttdoc">Gets a currency</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_directory_1_1_i_state_province_service_html_a2b5e45990cbddc0360d43b258d522dd1"><div class="ttname"><a href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html#a2b5e45990cbddc0360d43b258d522dd1">Nop.Services.Directory.IStateProvinceService.GetStateProvinceByAbbreviationAsync</a></div><div class="ttdeci">Task&lt; StateProvince &gt; GetStateProvinceByAbbreviationAsync(string abbreviation, int? countryId=null)</div><div class="ttdoc">Gets a state/province by abbreviation</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_localization_1_1_i_language_service_html_ab45dfd47ef73657b418113f1767da185"><div class="ttname"><a href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">Nop.Services.Localization.ILanguageService.GetLanguageByIdAsync</a></div><div class="ttdeci">Task&lt; Language &gt; GetLanguageByIdAsync(int languageId)</div><div class="ttdoc">Gets a language</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter_html_a5454bfd26689d9f8a88d22fe9087159a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html#a5454bfd26689d9f8a88d22fe9087159a">Nop.Services.Orders.ICheckoutAttributeFormatter.FormatAttributesAsync</a></div><div class="ttdeci">Task&lt; string &gt; FormatAttributesAsync(string attributesXml, Customer customer, string separator=&quot;&lt;br /&gt;&quot;, bool htmlEncode=true, bool renderPrices=true, bool allowHyperlinks=true)</div><div class="ttdoc">Formats attributes</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_a49f53830a529dec35134f08cb0380665"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a49f53830a529dec35134f08cb0380665">Nop.Services.Orders.IOrderTotalCalculationService.GetTaxTotalAsync</a></div><div class="ttdeci">Task&lt;(decimal taxTotal, SortedDictionary&lt; decimal, decimal &gt; taxRates)&gt; GetTaxTotalAsync(IList&lt; ShoppingCartItem &gt; cart, bool usePaymentMethodAdditionalFee=true)</div><div class="ttdoc">Gets tax</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_ababbfde7e0273a5482b3997cd7b1e859"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartSubTotalAsync</a></div><div class="ttdeci">Task&lt;(decimal discountAmount, List&lt; Discount &gt; appliedDiscounts, decimal subTotalWithoutDiscount, decimal subTotalWithDiscount, SortedDictionary&lt; decimal, decimal &gt; taxRates)&gt; GetShoppingCartSubTotalAsync(IList&lt; ShoppingCartItem &gt; cart, bool includingTax)</div><div class="ttdoc">Gets shopping cart subtotal</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_ad04b78079fef3880d2a2040cab84bb99"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ad04b78079fef3880d2a2040cab84bb99">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartShippingTotalAsync</a></div><div class="ttdeci">Task&lt; decimal?&gt; GetShoppingCartShippingTotalAsync(IList&lt; ShoppingCartItem &gt; cart)</div><div class="ttdoc">Gets shopping cart shipping total</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a23bee3e064339be31d645cf8d8763cd4"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a23bee3e064339be31d645cf8d8763cd4">Nop.Services.Orders.IShoppingCartService.GetShoppingCartWarningsAsync</a></div><div class="ttdeci">Task&lt; IList&lt; string &gt; &gt; GetShoppingCartWarningsAsync(IList&lt; ShoppingCartItem &gt; shoppingCart, string checkoutAttributesXml, bool validateCheckoutAttributes)</div><div class="ttdoc">Validates whether this shopping cart is valid</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a372f2e1d392903a70e272a1cfc5ed0e5"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a372f2e1d392903a70e272a1cfc5ed0e5">Nop.Services.Orders.IShoppingCartService.GetShoppingCartItemWarningsAsync</a></div><div class="ttdeci">Task&lt; IList&lt; string &gt; &gt; GetShoppingCartItemWarningsAsync(Customer customer, ShoppingCartType shoppingCartType, Product product, int storeId, string attributesXml, decimal customerEnteredPrice, DateTime? rentalStartDate=null, DateTime? rentalEndDate=null, int quantity=1, bool addRequiredProducts=true, int shoppingCartItemId=0, bool getStandardWarnings=true, bool getAttributesWarnings=true, bool getGiftCardWarnings=true, bool getRequiredProductWarnings=true, bool getRentalWarnings=true)</div><div class="ttdoc">Validates shopping cart item</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a3b580677af40869cbfe3f61aff6faa20"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a3b580677af40869cbfe3f61aff6faa20">Nop.Services.Orders.IShoppingCartService.ShoppingCartIsRecurringAsync</a></div><div class="ttdeci">Task&lt; bool &gt; ShoppingCartIsRecurringAsync(IList&lt; ShoppingCartItem &gt; shoppingCart)</div><div class="ttdoc">Gets a value indicating whether shopping cart is recurring</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a57f855d8ca2ffb0465bc91d84ae253e1"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a57f855d8ca2ffb0465bc91d84ae253e1">Nop.Services.Orders.IShoppingCartService.GetShoppingCartAsync</a></div><div class="ttdeci">Task&lt; IList&lt; ShoppingCartItem &gt; &gt; GetShoppingCartAsync(Customer customer, ShoppingCartType? shoppingCartType=null, int storeId=0, int? productId=null, DateTime? createdFromUtc=null, DateTime? createdToUtc=null)</div><div class="ttdoc">Gets shopping cart</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a7be2776062568ed611d05f199573ee70"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a7be2776062568ed611d05f199573ee70">Nop.Services.Orders.IShoppingCartService.ShoppingCartRequiresShippingAsync</a></div><div class="ttdeci">Task&lt; bool &gt; ShoppingCartRequiresShippingAsync(IList&lt; ShoppingCartItem &gt; shoppingCart)</div><div class="ttdoc">Indicates whether the shopping cart requires shipping</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_a861f1b42fac7692f3873d76123e03a09"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a861f1b42fac7692f3873d76123e03a09">Nop.Services.Orders.IShoppingCartService.GetRecurringCycleInfoAsync</a></div><div class="ttdeci">Task&lt;(string error, int cycleLength, RecurringProductCyclePeriod cyclePeriod, int totalCycles)&gt; GetRecurringCycleInfoAsync(IList&lt; ShoppingCartItem &gt; shoppingCart)</div><div class="ttdoc">Get a recurring cycle information</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a9fc76bc9d2ffa2e9b6e3b64e4c985068"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a9fc76bc9d2ffa2e9b6e3b64e4c985068">Nop.Services.Payments.IPaymentService.GetAdditionalHandlingFeeAsync</a></div><div class="ttdeci">Task&lt; decimal &gt; GetAdditionalHandlingFeeAsync(IList&lt; ShoppingCartItem &gt; cart, string paymentMethodSystemName)</div><div class="ttdoc">Gets an additional handling fee of a payment method</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_tax_1_1_i_tax_service_html_ad498f4d40d26e50851b2d554b406b24a"><div class="ttname"><a href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#ad498f4d40d26e50851b2d554b406b24a">Nop.Services.Tax.ITaxService.GetPaymentMethodAdditionalFeeAsync</a></div><div class="ttdeci">Task&lt;(decimal price, decimal taxRate)&gt; GetPaymentMethodAdditionalFeeAsync(decimal price, Customer customer)</div><div class="ttdoc">Gets payment method additional handling fee</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_orders_html_ae2fb88620fcd3889e6e0504e7b18e806"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#ae2fb88620fcd3889e6e0504e7b18e806">Nop.Core.Domain.Orders.ShoppingCartType</a></div><div class="ttdeci">ShoppingCartType</div><div class="ttdoc">Represents a shopping cart type</div><div class="ttdef"><b>Definition:</b> ShoppingCartType.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_tax_html_a1e41366ee169068a235af7db450cae15"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#a1e41366ee169068a235af7db450cae15">Nop.Core.Domain.Tax.VatNumberStatus</a></div><div class="ttdeci">VatNumberStatus</div><div class="ttdoc">Represents the VAT number status enumeration</div><div class="ttdef"><b>Definition:</b> VatNumberStatus.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_tax_html_ad59b7fb4d9c43ceac91df05de550018c"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#ad59b7fb4d9c43ceac91df05de550018c">Nop.Core.Domain.Tax.TaxDisplayType</a></div><div class="ttdeci">TaxDisplayType</div><div class="ttdoc">Represents the tax display type enumeration</div><div class="ttdef"><b>Definition:</b> TaxDisplayType.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models_html_a67af1a2410a1c6a569e85b6df0fe75ac"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#a67af1a2410a1c6a569e85b6df0fe75ac">Nop.Plugin.Shipping.FixedByWeightByTotal.Models.StateProvinceId</a></div><div class="ttdeci">int StateProvinceId</div><div class="ttdef"><b>Definition:</b> ShippingByWeightByTotalModel.cs:36</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models_html_ade9e47c6ab2d9608a96bb049d71e80b2"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#ade9e47c6ab2d9608a96bb049d71e80b2">Nop.Plugin.Shipping.FixedByWeightByTotal.Models.CountryId</a></div><div class="ttdeci">int CountryId</div><div class="ttdef"><b>Definition:</b> ShippingByWeightByTotalModel.cs:31</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common_html_a41fd119446f105b297fde3d88d79d8b1"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a41fd119446f105b297fde3d88d79d8b1">Nop.Web.Areas.Admin.Models.Common.City</a></div><div class="ttdeci">string City</div><div class="ttdef"><b>Definition:</b> AddressModel.cs:48</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common_html_a8dead30ac8b6c9929325dae406bc9ff5"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a8dead30ac8b6c9929325dae406bc9ff5">Nop.Web.Areas.Admin.Models.Common.Address1</a></div><div class="ttdeci">string Address1</div><div class="ttdef"><b>Definition:</b> AddressModel.cs:45</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common_html_a9125d4e9a486a66d6c2f526872ee08ac"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a9125d4e9a486a66d6c2f526872ee08ac">Nop.Web.Areas.Admin.Models.Common.ZipPostalCode</a></div><div class="ttdeci">string ZipPostalCode</div><div class="ttdef"><b>Definition:</b> AddressModel.cs:57</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common_html_aabdfd67c26d0ba001d2d0a49cee7d454"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#aabdfd67c26d0ba001d2d0a49cee7d454">Nop.Web.Areas.Admin.Models.Common.County</a></div><div class="ttdeci">string County</div><div class="ttdef"><b>Definition:</b> AddressModel.cs:51</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">Nop.Services.Orders.OrderProcessingService._affiliateService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a75dbf57754d33a660e8263165282af98">Nop.Services.Orders.OrderProcessingService._checkoutAttributeFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">Nop.Services.Orders.OrderProcessingService._countryService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a1af4526c16c2806e79141eee59eec04d">Nop.Services.Orders.OrderProcessingService._currencyService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7ece80723f8671f549b939dbd21926ce">Nop.Services.Orders.OrderProcessingService._currencySettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">Nop.Services.Orders.OrderProcessingService._genericAttributeService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">Nop.Services.Orders.OrderProcessingService._languageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afc0c1f9f592bd30994ec44a49280cad0">Nop.Services.Orders.OrderProcessingService._priceFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a212c894e11cf3f8fc28b0cfdc0bbedf8">Nop.Services.Orders.OrderProcessingService._shippingSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad4eca13441d549f6e2b57ed3b0bb8df2">Nop.Services.Orders.OrderProcessingService._stateProvinceService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a870338b48b8874c10ae35cff96dd4322">Nop.Services.Orders.OrderProcessingService._taxService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab630f7eca77078d362428f6b924d2472">Nop.Services.Orders.OrderProcessingService._taxSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">Nop.Services.Orders.OrderProcessingService._workContext</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a8dead30ac8b6c9929325dae406bc9ff5">Nop.Web.Areas.Admin.Models.Common.Address1</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#ad8b0185cf2d4654763f15d5725034b0f">Nop.Core.Domain.Tax.TaxSettings.AllowCustomersToSelectTaxDisplayType</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html#a97d22567945cbe195a3063c4262e856a">Nop.Core.Domain.Shipping.ShippingSettings.AllowPickupInStore</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#a6619fd0db3b4fa53560eac21612ce42e">Nop.Core.Domain.Directory.Country.AllowsBilling</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#af8d60303d1011037f99c2c615e9e82da">Nop.Core.Domain.Directory.Country.AllowsShipping</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#aa744bb22abf06693a671caeade716b1e">Nop.Core.Domain.Orders.OrderSettings.AnonymousCheckoutAllowed</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a7fad329b67b90c06f515599945aa20ef">Nop.Core.Domain.Customers.NopCustomerDefaults.CheckoutAttributes</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a41fd119446f105b297fde3d88d79d8b1">Nop.Web.Areas.Admin.Models.Common.City</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">Nop.Services.Common.IAddressService.CloneAddress()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#aa31e5a6b1f11b300175fa360eb12b768">Nop.Services.Discounts.IDiscountService.ContainsDiscount()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a232e7d559ba6ca61f2cb80cbcf5f0be5">Nop.Services.Directory.ICurrencyService.ConvertFromPrimaryStoreCurrencyAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#ade9e47c6ab2d9608a96bb049d71e80b2">Nop.Plugin.Shipping.FixedByWeightByTotal.Models.CountryId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#aabdfd67c26d0ba001d2d0a49cee7d454">Nop.Web.Areas.Admin.Models.Common.County</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a2822cda4872e4da9449b86f3442aa87c">Nop.Core.Domain.Customers.NopCustomerDefaults.CurrencyIdAttribute</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">Nop.Services.Payments.ProcessPaymentRequest.CustomerId</a>, <a class="el" href="namespace_nop_1_1_core_1_1_domain_1_1_tax.html#a1e41366ee169068a235af7db450cae15ace2c8aed9c2fa0cfbed56cbda4d8bf07">Nop.Core.Domain.Tax.Empty</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#afd627f2ff228d772e5f5f724d9253ca3">Nop.Core.Domain.Tax.TaxSettings.EuVatEnabled</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html#a5454bfd26689d9f8a88d22fe9087159a">Nop.Services.Orders.ICheckoutAttributeFormatter.FormatAttributesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html#a5e131524dfbb20c6d2d175f3323de98a">Nop.Services.Catalog.IPriceFormatter.FormatPriceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a9fc76bc9d2ffa2e9b6e3b64e4c985068">Nop.Services.Payments.IPaymentService.GetAdditionalHandlingFeeAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html#ab888b7c22d44ae6f781bfc0611855315">Nop.Services.Affiliates.IAffiliateService.GetAffiliateByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">Nop.Services.Directory.ICountryService.GetCountryByAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ab210ec12fa25e8566e7996696322acfd">Nop.Services.Directory.ICountryService.GetCountryByTwoLetterIsoCodeAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html#a81c78d1c9841ac8dc226e43d5a19a4e4">Nop.Services.Directory.ICurrencyService.GetCurrencyByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a471cc5d9241f6a904f37247ffbdc46e8">Nop.Services.Customers.ICustomerService.GetCustomerBillingAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#ac550950db302400f38f7798af6210548">Nop.Services.Customers.ICustomerService.GetCustomerShippingAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">Nop.Services.Localization.ILanguageService.GetLanguageByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html#ad498f4d40d26e50851b2d554b406b24a">Nop.Services.Tax.ITaxService.GetPaymentMethodAdditionalFeeAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a861f1b42fac7692f3873d76123e03a09">Nop.Services.Orders.IShoppingCartService.GetRecurringCycleInfoAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a57f855d8ca2ffb0465bc91d84ae253e1">Nop.Services.Orders.IShoppingCartService.GetShoppingCartAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a372f2e1d392903a70e272a1cfc5ed0e5">Nop.Services.Orders.IShoppingCartService.GetShoppingCartItemWarningsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ad04b78079fef3880d2a2040cab84bb99">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartShippingTotalAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartSubTotalAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartTotalAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a23bee3e064339be31d645cf8d8763cd4">Nop.Services.Orders.IShoppingCartService.GetShoppingCartWarningsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html#a2b5e45990cbddc0360d43b258d522dd1">Nop.Services.Directory.IStateProvinceService.GetStateProvinceByAbbreviationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a49f53830a529dec35134f08cb0380665">Nop.Services.Orders.IOrderTotalCalculationService.GetTaxTotalAsync()</a>, <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html#a34d59971fa4eafe471e74c89f0d05349">Nop.Core.IWorkContext.GetWorkingCurrencyAsync()</a>, <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html#a686f2cf36883b0c44436ddbf33a023a5">Nop.Core.IWorkContext.GetWorkingLanguageAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a1ea83a743a13cc9e5dda268a57f16f1f">Nop.Services.Customers.ICustomerService.IsGuestAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_common_helper.html#a78b50a7979169f28157c685159b92884">Nop.Core.CommonHelper.IsValidEmail()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a722df216cf706b1c1e6daa60a7be761f">Nop.Core.Domain.Customers.NopCustomerDefaults.LanguageIdAttribute</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">Nop.Core.Domain.Orders.OrderSettings.MinOrderSubtotalAmount</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">Nop.Core.Domain.Orders.OrderSettings.MinOrderTotalAmount</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_option.html#a7cf0288af132677b5a521a5e0a831dd9">Nop.Core.Domain.Shipping.ShippingOption.Name</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html#a5d5ba8e598d20352aa491a9924572da8">Nop.Core.Domain.Directory.CurrencySettings.PrimaryStoreCurrencyId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aa4d75ce1339c91da5107f4aebf624196">Nop.Core.Domain.Customers.NopCustomerDefaults.SelectedPickupPointAttribute</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a06d4f563dd9b4b4a2af69a17561fa29d">Nop.Core.Domain.Customers.NopCustomerDefaults.SelectedShippingOptionAttribute</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a3b580677af40869cbfe3f61aff6faa20">Nop.Services.Orders.IShoppingCartService.ShoppingCartIsRecurringAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a7be2776062568ed611d05f199573ee70">Nop.Services.Orders.IShoppingCartService.ShoppingCartRequiresShippingAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#a67af1a2410a1c6a569e85b6df0fe75ac">Nop.Plugin.Shipping.FixedByWeightByTotal.Models.StateProvinceId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">Nop.Services.Payments.ProcessPaymentRequest.StoreId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html#a82f18b7fa06a2b57db30c1128c4def25">Nop.Core.Domain.Tax.TaxSettings.TaxDisplayType</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#aefa3c76e25cd71c1750abcdbfc214723">Nop.Core.Domain.Customers.NopCustomerDefaults.TaxDisplayTypeIdAttribute</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderSubtotalAmountAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderTotalAmountAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#ad0d12dbb2b57a95254cd4ec22b8de6ff">Nop.Core.Domain.Customers.NopCustomerDefaults.VatNumberAttribute</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a9a6dcb7d10234c5db6437124b33edf8c">Nop.Core.Domain.Customers.NopCustomerDefaults.VatNumberStatusIdAttribute</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a9125d4e9a486a66d6c2f526872ee08ac">Nop.Web.Areas.Admin.Models.Common.ZipPostalCode</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="a8a51cb2794e39742eca861d2767779ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a51cb2794e39742eca861d2767779ad">&#9670;&nbsp;</a></span>PrepareRecurringOrderDetailsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;<a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&gt; Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare details to place order based on the recurring payment. </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the details </dd></dl>
<div class="fragment"><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            var details = <span class="keyword">new</span> PlaceOrderContainer</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                IsRecurringShoppingCart = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="comment">//load initial order</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                InitialOrder = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a71275cdc0b3b0062ee4897e1863980a5">InitialOrder</a></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            };</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (details.InitialOrder == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<span class="stringliteral">&quot;Initial order is not set for recurring payment&quot;</span>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a> = details.InitialOrder.PaymentMethodSystemName;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">//customer</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            details.Customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">CustomerId</a>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">if</span> (details.Customer == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<span class="stringliteral">&quot;Customer is not set&quot;</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="comment">//affiliate</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            var affiliate = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">_affiliateService</a>.<a class="code" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html#ab888b7c22d44ae6f781bfc0611855315">GetAffiliateByIdAsync</a>(details.Customer.AffiliateId);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keywordflow">if</span> (affiliate != <span class="keyword">null</span> &amp;&amp; affiliate.Active &amp;&amp; !affiliate.Deleted)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                details.AffiliateId = affiliate.Id;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="comment">//check whether customer is guest</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a1ea83a743a13cc9e5dda268a57f16f1f">IsGuestAsync</a>(details.Customer) &amp;&amp; !<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#aa744bb22abf06693a671caeade716b1e">AnonymousCheckoutAllowed</a>)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Anonymous checkout is not allowed&quot;</span>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="comment">//customer currency</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            details.CustomerCurrencyCode = details.InitialOrder.CustomerCurrencyCode;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            details.CustomerCurrencyRate = details.InitialOrder.CurrencyRate;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="comment">//customer language</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            details.CustomerLanguage = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">GetLanguageByIdAsync</a>(details.InitialOrder.CustomerLanguageId);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">if</span> (details.CustomerLanguage == <span class="keyword">null</span> || !details.CustomerLanguage.Published)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                details.CustomerLanguage = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a686f2cf36883b0c44436ddbf33a023a5">GetWorkingLanguageAsync</a>();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">//billing address</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">if</span> (details.InitialOrder.BillingAddressId == 0)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Billing address is not available&quot;</span>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            var billingAddress = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a91a223bb48ad616e4155d16894c64470">GetAddressByIdAsync</a>(details.InitialOrder.BillingAddressId);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            details.BillingAddress = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">CloneAddress</a>(billingAddress);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">GetCountryByAddressAsync</a>(billingAddress) is <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html">Country</a> billingCountry &amp;&amp; !billingCountry.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#a6619fd0db3b4fa53560eac21612ce42e">AllowsBilling</a>)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>($<span class="stringliteral">&quot;Country &#39;{billingCountry.Name}&#39; is not allowed for billing&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="comment">//checkout attributes</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            details.CheckoutAttributesXml = details.InitialOrder.CheckoutAttributesXml;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            details.CheckoutAttributeDescription = details.InitialOrder.CheckoutAttributeDescription;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="comment">//tax display type</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            details.CustomerTaxDisplayType = details.InitialOrder.CustomerTaxDisplayType;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="comment">//sub total</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            details.OrderSubTotalInclTax = details.InitialOrder.OrderSubtotalInclTax;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            details.OrderSubTotalExclTax = details.InitialOrder.OrderSubtotalExclTax;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            details.OrderSubTotalDiscountExclTax = details.InitialOrder.OrderSubTotalDiscountExclTax;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            details.OrderSubTotalDiscountInclTax = details.InitialOrder.OrderSubTotalDiscountInclTax;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="comment">//shipping info</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">if</span> (details.InitialOrder.ShippingStatus != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.ShippingNotRequired)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                details.PickupInStore = details.InitialOrder.PickupInStore;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="keywordflow">if</span> (!details.PickupInStore)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="keywordflow">if</span> (!details.InitialOrder.ShippingAddressId.HasValue || await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a91a223bb48ad616e4155d16894c64470">GetAddressByIdAsync</a>(details.InitialOrder.ShippingAddressId.Value) is not <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_common_1_1_address.html">Address</a> shippingAddress)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Shipping address is not available&quot;</span>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="comment">//clone shipping address</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    details.ShippingAddress = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">CloneAddress</a>(shippingAddress);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">GetCountryByAddressAsync</a>(details.ShippingAddress) is <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html">Country</a> shippingCountry &amp;&amp; !shippingCountry.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#af8d60303d1011037f99c2c615e9e82da">AllowsShipping</a>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>($<span class="stringliteral">&quot;Country &#39;{shippingCountry.Name}&#39; is not allowed for shipping&quot;</span>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (details.InitialOrder.PickupAddressId.HasValue &amp;&amp; await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a91a223bb48ad616e4155d16894c64470">GetAddressByIdAsync</a>(details.InitialOrder.PickupAddressId.Value) is <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_common_1_1_address.html">Address</a> pickupAddress) </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    details.PickupAddress = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">CloneAddress</a>(pickupAddress);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                details.ShippingMethodName = details.InitialOrder.ShippingMethod;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                details.ShippingRateComputationMethodSystemName = details.InitialOrder.ShippingRateComputationMethodSystemName;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                details.ShippingStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.NotYetShipped;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                details.ShippingStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.ShippingNotRequired;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="comment">//shipping total</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            details.OrderShippingTotalInclTax = details.InitialOrder.OrderShippingInclTax;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            details.OrderShippingTotalExclTax = details.InitialOrder.OrderShippingExclTax;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="comment">//payment total</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            details.PaymentAdditionalFeeInclTax = details.InitialOrder.PaymentMethodAdditionalFeeInclTax;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            details.PaymentAdditionalFeeExclTax = details.InitialOrder.PaymentMethodAdditionalFeeExclTax;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="comment">//tax total</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            details.OrderTaxTotal = details.InitialOrder.OrderTax;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="comment">//tax rates</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            details.TaxRates = details.InitialOrder.TaxRates;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="comment">//VAT number</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            details.VatNumber = details.InitialOrder.VatNumber;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">//discount history (the same)</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordflow">foreach</span> (var duh <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a0473d241079dd560242837ac5c9f7460">GetAllDiscountUsageHistoryAsync</a>(orderId: details.InitialOrder.Id))</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                var d = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">GetDiscountByIdAsync</a>(duh.DiscountId);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">if</span> (d != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    details.AppliedDiscounts.Add(d);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="comment">//order total</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            details.OrderDiscountAmount = details.InitialOrder.OrderDiscount;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            details.OrderTotal = details.InitialOrder.OrderTotal;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a0c5837b2c79b22f63e3825f06ebc848d">OrderTotal</a> = details.OrderTotal;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">return</span> details;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a71275cdc0b3b0062ee4897e1863980a5"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a71275cdc0b3b0062ee4897e1863980a5">Nop.Services.Payments.ProcessPaymentRequest.InitialOrder</a></div><div class="ttdeci">Order InitialOrder</div><div class="ttdoc">Gets or sets an initial (parent) order identifier if order is recurring</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:90</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_common_1_1_i_address_service_html_a91a223bb48ad616e4155d16894c64470"><div class="ttname"><a href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a91a223bb48ad616e4155d16894c64470">Nop.Services.Common.IAddressService.GetAddressByIdAsync</a></div><div class="ttdeci">Task&lt; Address &gt; GetAddressByIdAsync(int addressId)</div><div class="ttdoc">Gets an address by address identifier</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_discounts_1_1_i_discount_service_html_a0473d241079dd560242837ac5c9f7460"><div class="ttname"><a href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a0473d241079dd560242837ac5c9f7460">Nop.Services.Discounts.IDiscountService.GetAllDiscountUsageHistoryAsync</a></div><div class="ttdeci">Task&lt; IPagedList&lt; DiscountUsageHistory &gt; &gt; GetAllDiscountUsageHistoryAsync(int? discountId=null, int? customerId=null, int? orderId=null, int pageIndex=0, int pageSize=int.MaxValue)</div><div class="ttdoc">Gets all discount usage history records</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_discounts_1_1_i_discount_service_html_a9697750465b8fa7893867cb73d358842"><div class="ttname"><a href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">Nop.Services.Discounts.IDiscountService.GetDiscountByIdAsync</a></div><div class="ttdeci">Task&lt; Discount &gt; GetDiscountByIdAsync(int discountId)</div><div class="ttdoc">Gets a discount</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abee78ab02d7850dd249b88d5dc0d775e">Nop.Services.Orders.OrderProcessingService._affiliateService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">Nop.Services.Orders.OrderProcessingService._countryService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">Nop.Services.Orders.OrderProcessingService._languageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">Nop.Services.Orders.OrderProcessingService._workContext</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#a6619fd0db3b4fa53560eac21612ce42e">Nop.Core.Domain.Directory.Country.AllowsBilling</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_country.html#af8d60303d1011037f99c2c615e9e82da">Nop.Core.Domain.Directory.Country.AllowsShipping</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#aa744bb22abf06693a671caeade716b1e">Nop.Core.Domain.Orders.OrderSettings.AnonymousCheckoutAllowed</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a797b198a52ae7dee8e287f4aa47cafc5">Nop.Services.Common.IAddressService.CloneAddress()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a098b0e1fef0218d4da085f5e1db550d3">Nop.Services.Payments.ProcessPaymentRequest.CustomerId</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a91a223bb48ad616e4155d16894c64470">Nop.Services.Common.IAddressService.GetAddressByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html#ab888b7c22d44ae6f781bfc0611855315">Nop.Services.Affiliates.IAffiliateService.GetAffiliateByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a0473d241079dd560242837ac5c9f7460">Nop.Services.Discounts.IDiscountService.GetAllDiscountUsageHistoryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ac5036ded2f392a64646355d5e49e3936">Nop.Services.Directory.ICountryService.GetCountryByAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">Nop.Services.Discounts.IDiscountService.GetDiscountByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">Nop.Services.Localization.ILanguageService.GetLanguageByIdAsync()</a>, <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html#a686f2cf36883b0c44436ddbf33a023a5">Nop.Core.IWorkContext.GetWorkingLanguageAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a71275cdc0b3b0062ee4897e1863980a5">Nop.Services.Payments.ProcessPaymentRequest.InitialOrder</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a1ea83a743a13cc9e5dda268a57f16f1f">Nop.Services.Customers.ICustomerService.IsGuestAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">Nop.Services.Payments.ProcessPaymentRequest.PaymentMethodSystemName</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a9cfacc51e4ed202dd0ee478dba282fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cfacc51e4ed202dd0ee478dba282fb3">&#9670;&nbsp;</a></span>ProcessCustomerRolesWithPurchasedProductSpecifiedAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process customer roles with "Purchased with Product" property configured </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">add</td><td>A value indicating whether to add configured customer role; true - add, false - remove</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <span class="comment">//purchased product identifiers</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            var purchasedProductIds = <span class="keyword">new</span> List&lt;int&gt;();</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="keywordflow">foreach</span> (var orderItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="comment">//standard items</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                purchasedProductIds.Add(orderItem.ProductId);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <span class="comment">//bundled (associated) products</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                var attributeValues = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">_productAttributeParser</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#a3c69288e42ecea1f43b95bb5056b43a7">ParseProductAttributeValuesAsync</a>(orderItem.AttributesXml);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="keywordflow">foreach</span> (var attributeValue <span class="keywordflow">in</span> attributeValues)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    <span class="keywordflow">if</span> (attributeValue.AttributeValueType == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#ae2b0e1630e69ae828dc04a428c000407">AttributeValueType</a>.AssociatedToProduct)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                        purchasedProductIds.Add(attributeValue.AssociatedProductId);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <span class="comment">//list of customer roles</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            var customerRoles = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                .<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#af0376af213c926b34018b673b84e5c41">GetAllCustomerRolesAsync</a>(<span class="keyword">true</span>))</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                .Where(cr =&gt; purchasedProductIds.Contains(cr.PurchasedWithProductId))</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                .ToList();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keywordflow">if</span> (!customerRoles.Any())</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            <span class="keywordflow">foreach</span> (var customerRole <span class="keywordflow">in</span> customerRoles)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a2239e26d02f1534ca3ca9c09e010907b">IsInCustomerRoleAsync</a>(customer, customerRole.SystemName))</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    <span class="comment">//not in the list yet</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                    <span class="keywordflow">if</span> (add)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                    {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        <span class="comment">//add</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a7e2e41331536f5e545059750b99686bc">AddCustomerRoleMappingAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer_customer_role_mapping.html">CustomerCustomerRoleMapping</a> { <a class="code" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">CustomerId</a> = customer.Id, <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a0e373599ed039821b127a960298cf266">CustomerRoleId</a> = customerRole.Id });</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    <span class="comment">//already in the list</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    <span class="keywordflow">if</span> (!add)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                        <span class="comment">//remove</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a07f4e7c38a9fc3b0bd322f503abb2b27">RemoveCustomerRoleMappingAsync</a>(customer, customerRole);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a5e3102e7df9c920f1d3aa72f26502fd4">UpdateCustomerAsync</a>(customer);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer_customer_role_mapping_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_customer_customer_role_mapping.html">Nop.Core.Domain.Customers.CustomerCustomerRoleMapping</a></div><div class="ttdoc">Represents a customer-customer role mapping class</div><div class="ttdef"><b>Definition:</b> CustomerCustomerRoleMapping.cs:7</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser_html_a3c69288e42ecea1f43b95bb5056b43a7"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#a3c69288e42ecea1f43b95bb5056b43a7">Nop.Services.Catalog.IProductAttributeParser.ParseProductAttributeValuesAsync</a></div><div class="ttdeci">Task&lt; IList&lt; ProductAttributeValue &gt; &gt; ParseProductAttributeValuesAsync(string attributesXml, int productAttributeMappingId=0)</div><div class="ttdoc">Get product attribute values</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a07f4e7c38a9fc3b0bd322f503abb2b27"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a07f4e7c38a9fc3b0bd322f503abb2b27">Nop.Services.Customers.ICustomerService.RemoveCustomerRoleMappingAsync</a></div><div class="ttdeci">Task RemoveCustomerRoleMappingAsync(Customer customer, CustomerRole role)</div><div class="ttdoc">Remove a customer-customer role mapping</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a2239e26d02f1534ca3ca9c09e010907b"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a2239e26d02f1534ca3ca9c09e010907b">Nop.Services.Customers.ICustomerService.IsInCustomerRoleAsync</a></div><div class="ttdeci">Task&lt; bool &gt; IsInCustomerRoleAsync(Customer customer, string customerRoleSystemName, bool onlyActiveCustomerRoles=true)</div><div class="ttdoc">Gets a value indicating whether customer is in a certain customer role</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a5e3102e7df9c920f1d3aa72f26502fd4"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a5e3102e7df9c920f1d3aa72f26502fd4">Nop.Services.Customers.ICustomerService.UpdateCustomerAsync</a></div><div class="ttdeci">Task UpdateCustomerAsync(Customer customer)</div><div class="ttdoc">Updates the customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_a7e2e41331536f5e545059750b99686bc"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a7e2e41331536f5e545059750b99686bc">Nop.Services.Customers.ICustomerService.AddCustomerRoleMappingAsync</a></div><div class="ttdeci">Task AddCustomerRoleMappingAsync(CustomerCustomerRoleMapping roleMapping)</div><div class="ttdoc">Add a customer-customer role mapping</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_customers_1_1_i_customer_service_html_af0376af213c926b34018b673b84e5c41"><div class="ttname"><a href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#af0376af213c926b34018b673b84e5c41">Nop.Services.Customers.ICustomerService.GetAllCustomerRolesAsync</a></div><div class="ttdeci">Task&lt; IList&lt; CustomerRole &gt; &gt; GetAllCustomerRolesAsync(bool showHidden=false)</div><div class="ttdoc">Gets all customer roles</div></div>
<div class="ttc" id="anamespace_nop_1_1_core_1_1_domain_1_1_catalog_html_ae2b0e1630e69ae828dc04a428c000407"><div class="ttname"><a href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#ae2b0e1630e69ae828dc04a428c000407">Nop.Core.Domain.Catalog.AttributeValueType</a></div><div class="ttdeci">AttributeValueType</div><div class="ttdoc">Represents an attribute value type</div><div class="ttdef"><b>Definition:</b> AttributeValueType.cs:7</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log_html_aaa4303994371e93df77abec6d473c7e8"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">Nop.Plugin.Tax.Avalara.Models.Log.CustomerId</a></div><div class="ttdeci">int? CustomerId</div><div class="ttdef"><b>Definition:</b> TaxTransactionLogModel.cs:27</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog_html_a0e373599ed039821b127a960298cf266"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a0e373599ed039821b127a960298cf266">Nop.Web.Areas.Admin.Models.Catalog.CustomerRoleId</a></div><div class="ttdeci">int CustomerRoleId</div><div class="ttdef"><b>Definition:</b> TierPriceModel.cs:30</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a35af79dc9ceb975327b0a420491d3ec0">Nop.Services.Orders.OrderProcessingService._productAttributeParser</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a7e2e41331536f5e545059750b99686bc">Nop.Services.Customers.ICustomerService.AddCustomerRoleMappingAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">Nop.Plugin.Tax.Avalara.Models.Log.CustomerId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a0e373599ed039821b127a960298cf266">Nop.Web.Areas.Admin.Models.Catalog.CustomerRoleId</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#af0376af213c926b34018b673b84e5c41">Nop.Services.Customers.ICustomerService.GetAllCustomerRolesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a2239e26d02f1534ca3ca9c09e010907b">Nop.Services.Customers.ICustomerService.IsInCustomerRoleAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html#a3c69288e42ecea1f43b95bb5056b43a7">Nop.Services.Catalog.IProductAttributeParser.ParseProductAttributeValuesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a07f4e7c38a9fc3b0bd322f503abb2b27">Nop.Services.Customers.ICustomerService.RemoveCustomerRoleMappingAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a5e3102e7df9c920f1d3aa72f26502fd4">Nop.Services.Customers.ICustomerService.UpdateCustomerAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>.</p>

</div>
</div>
<a id="ae46217f3f60445071742ab76556757aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae46217f3f60445071742ab76556757aa">&#9670;&nbsp;</a></span>ProcessNextRecurringPaymentAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IEnumerable&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html">RecurringPayment</a>&#160;</td>
          <td class="paramname"><em>recurringPayment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a>&#160;</td>
          <td class="paramname"><em>paymentResult</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process next recurring payment </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">recurringPayment</td><td>Recurring payment</td></tr>
    <tr><td class="paramname">paymentResult</td><td>Process payment result (info about last payment for automatic recurring payments)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the collection of errors </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a68d5c51a0c443cd9d091ffc4608588a5">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            <span class="keywordflow">if</span> (recurringPayment == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(recurringPayment));</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                <span class="keywordflow">if</span> (!recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">IsActive</a>)</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Recurring payment is not active&quot;</span>);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                var initialOrder = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">InitialOrderId</a>);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <span class="keywordflow">if</span> (initialOrder == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Initial order could not be loaded&quot;</span>);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(initialOrder.CustomerId);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                <span class="keywordflow">if</span> (customer == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Customer could not be loaded&quot;</span>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">GetNextPaymentDateAsync</a>(recurringPayment) is <span class="keyword">null</span>)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Next payment date could not be calculated&quot;</span>);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                <span class="comment">//payment info</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                var processPaymentRequest = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    <a class="code" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">StoreId</a> = initialOrder.StoreId,</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                    <a class="code" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">CustomerId</a> = customer.Id,</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9b3018a66cd7b222ad19d2de14e2466b">OrderGuid</a> = Guid.NewGuid(),</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    InitialOrder = initialOrder,</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                    RecurringCycleLength = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">CycleLength</a>,</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                    RecurringCyclePeriod = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#acee4867aa04db4947b9b3118ae0709cf">CyclePeriod</a>,</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                    RecurringTotalCycles = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">TotalCycles</a>,</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae27c9a81a56120c95b2689517fd0871d">CustomValues</a> = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa4ebb9ce309fe00bb9657f9f41bd11e6">DeserializeCustomValues</a>(initialOrder)</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                };</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                <span class="comment">//prepare order details</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                var details = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">PrepareRecurringOrderDetailsAsync</a>(processPaymentRequest);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> processPaymentResult;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                <span class="comment">//skip payment workflow if order total equals zero</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                var skipPaymentWorkflow = details.OrderTotal == decimal.Zero;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                <span class="keywordflow">if</span> (!skipPaymentWorkflow)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    var paymentMethod = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                        .<a class="code" href="interface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager.html#ae65d47d1226a9c2099ff48e24a976235">LoadPluginBySystemNameAsync</a>(processPaymentRequest.PaymentMethodSystemName, customer, initialOrder.StoreId)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                        ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Payment method couldn&#39;t be loaded&quot;</span>);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">_paymentPluginManager</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html#a3ca5817d660c52b46621080a20598fc8">IsPluginActive</a>(paymentMethod))</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Payment method is not active&quot;</span>);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                    <span class="comment">//Old credit card info</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                    <span class="keywordflow">if</span> (details.InitialOrder.AllowStoringCreditCardNumber)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                    {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                        processPaymentRequest.CreditCardType = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardType);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                        processPaymentRequest.CreditCardName = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardName);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                        processPaymentRequest.CreditCardNumber = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardNumber);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                        processPaymentRequest.CreditCardCvv2 = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardCvv2);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                        <span class="keywordflow">try</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                        {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                            processPaymentRequest.CreditCardExpireMonth = Convert.ToInt32(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardExpirationMonth));</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                            processPaymentRequest.CreditCardExpireYear = Convert.ToInt32(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">DecryptText</a>(details.InitialOrder.CardExpirationYear));</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                        }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                        <span class="keywordflow">catch</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                        {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                            <span class="comment">// ignored</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                        }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                    }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    <span class="comment">//payment type</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                    processPaymentResult = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">GetRecurringPaymentTypeAsync</a>(processPaymentRequest.PaymentMethodSystemName)) <span class="keywordflow">switch</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    {</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.NotSupported =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Recurring payments are not supported by selected payment method&quot;</span>),</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Manual =&gt; await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ab17cc75a304e6bf10a1579a61da97ffe">ProcessRecurringPaymentAsync</a>(processPaymentRequest),</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                        <span class="comment">//payment is processed on payment gateway site, info about last transaction in paymentResult parameter</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                        <a class="code" href="namespace_nop_1_1_services_1_1_payments.html#aef3ff9dcc532279768359b7656e72cc7">RecurringPaymentType</a>.Automatic =&gt; paymentResult ?? <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a>(),</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                        _ =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Not supported recurring payment type&quot;</span>),</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                    };</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    processPaymentResult = paymentResult ?? <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a> { NewPaymentStatus = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid };</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                <span class="keywordflow">if</span> (processPaymentResult == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;processPaymentResult is not available&quot;</span>);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                <span class="keywordflow">if</span> (processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a8533096be13a5f96011cdb9daa4d78df">Success</a>)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                    <span class="comment">//save order details</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                    var order = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">SaveOrderDetailsAsync</a>(processPaymentRequest, processPaymentResult, details);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    <span class="keywordflow">foreach</span> (var orderItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(details.InitialOrder.Id))</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                        <span class="comment">//save item</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                        var newOrderItem = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_item.html">OrderItem</a></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                        {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                            OrderItemGuid = Guid.NewGuid(),</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.Id,</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">ProductId</a> = orderItem.ProductId,</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9f44d521e2cb6de54997a4944fe78fb8">UnitPriceInclTax</a> = orderItem.UnitPriceInclTax,</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af128d4afe5fb49b08eb130558cbf1240">UnitPriceExclTax</a> = orderItem.UnitPriceExclTax,</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                            PriceInclTax = orderItem.PriceInclTax,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                            PriceExclTax = orderItem.PriceExclTax,</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                            OriginalProductCost = orderItem.OriginalProductCost,</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                            AttributeDescription = orderItem.AttributeDescription,</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">AttributesXml</a> = orderItem.AttributesXml,</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Quantity</a> = orderItem.Quantity,</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                            DiscountAmountInclTax = orderItem.DiscountAmountInclTax,</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                            DiscountAmountExclTax = orderItem.DiscountAmountExclTax,</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aed6bcf76e9af9efdc1b39036c07e2339">DownloadCount</a> = 0,</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2b6e46b2877ac8c8cbd01815811940fc">IsDownloadActivated</a> = <span class="keyword">false</span>,</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aeb85b3b7b4160833212a34e82669cd0a">LicenseDownloadId</a> = 0,</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                            <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a562e09ec2ece64b33dc1afcdbbbc0a99">ItemWeight</a> = orderItem.ItemWeight,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                            RentalStartDateUtc = orderItem.RentalStartDateUtc,</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                            RentalEndDateUtc = orderItem.RentalEndDateUtc</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                        };</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#af5c522d07c4bfa70c71384b0d890c8f1">InsertOrderItemAsync</a>(newOrderItem);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                        var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(orderItem.ProductId);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                        <span class="comment">//gift cards</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">AddGiftCardsAsync</a>(product, orderItem.AttributesXml, orderItem.Quantity, newOrderItem, amount: orderItem.UnitPriceExclTax);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                        <span class="comment">//inventory</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">AdjustInventoryAsync</a>(product, -orderItem.Quantity, orderItem.AttributesXml,</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                            <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.PlaceOrder&quot;</span>), order.Id));</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                    <span class="comment">//discount usage history</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">SaveDiscountUsageHistoryAsync</a>(details, order);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                    <span class="comment">//notifications</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">SendNotificationsAndSaveNotesAsync</a>(order);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    <span class="comment">//check order status</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                    <span class="comment">//raise event       </span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_placed_event.html">OrderPlacedEvent</a>(order));</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                    <span class="keywordflow">if</span> (order.PaymentStatus == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Paid)</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">ProcessOrderPaidAsync</a>(order);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    <span class="comment">//last payment succeeded</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                    recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">LastPaymentFailed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                    <span class="comment">//next recurring payment</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aa5d03d6d03cfeb2771e00796c0a04ded">InsertRecurringPaymentHistoryAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment_history.html">RecurringPaymentHistory</a></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                    {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a661520bc33d33d1bf5a482fe00f1c984">RecurringPaymentId</a> = recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                        CreatedOnUtc = DateTime.UtcNow,</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.Id</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                    });</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">UpdateRecurringPaymentAsync</a>(recurringPayment);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                <span class="comment">//log errors</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                var logError = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a4510c1808d0a62a564ab8e349050ef44">Errors</a>.Aggregate(<span class="stringliteral">&quot;Error while processing recurring order. &quot;</span>,</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                    (current, next) =&gt; $<span class="stringliteral">&quot;{current}Error {processPaymentResult.Errors.IndexOf(next) + 1}: {next}. &quot;</span>);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">ErrorAsync</a>(logError, customer: customer);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                <span class="keywordflow">if</span> (!processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6cd07b37c195a5d9ba1d77aca25b4d93">RecurringPaymentFailed</a>)</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                    <span class="keywordflow">return</span> processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a4510c1808d0a62a564ab8e349050ef44">Errors</a>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                <span class="comment">//set flag that last payment failed</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                recurringPayment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">LastPaymentFailed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">UpdateRecurringPaymentAsync</a>(recurringPayment);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">_paymentSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html#aef548923f584c3e502baea5ddc673ffc">CancelRecurringPaymentsAfterFailedPayment</a>)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                    <span class="comment">//cancel recurring payment</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                    (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">CancelRecurringPaymentAsync</a>(recurringPayment)).ToList().ForEach(error =&gt; <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">ErrorAsync</a>(error));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                    <span class="comment">//notify a customer about cancelled payment</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aced13a441c2811c58e47af374b0e55d9">SendRecurringPaymentCancelledCustomerNotificationAsync</a>(recurringPayment, initialOrder.CustomerLanguageId);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                    <span class="comment">//notify a customer about failed payment</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a63bdd8627ca7f4fe9c6ad6affb5fb198">SendRecurringPaymentFailedCustomerNotificationAsync</a>(recurringPayment, initialOrder.CustomerLanguageId);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                <span class="keywordflow">return</span> processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a4510c1808d0a62a564ab8e349050ef44">Errors</a>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">ErrorAsync</a>($<span class="stringliteral">&quot;Error while processing recurring order. {exc.Message}&quot;</span>, exc);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings_html_aef548923f584c3e502baea5ddc673ffc"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html#aef548923f584c3e502baea5ddc673ffc">Nop.Core.Domain.Payments.PaymentSettings.CancelRecurringPaymentsAfterFailedPayment</a></div><div class="ttdeci">bool CancelRecurringPaymentsAfterFailedPayment</div><div class="ttdoc">Gets or sets a value indicating whether to cancel the recurring payment after failed last payment</div><div class="ttdef"><b>Definition:</b> PaymentSettings.cs:44</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a8a51cb2794e39742eca861d2767779ad"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync</a></div><div class="ttdeci">virtual async Task&lt; PlaceOrderContainer &gt; PrepareRecurringOrderDetailsAsync(ProcessPaymentRequest processPaymentRequest)</div><div class="ttdoc">Prepare details to place order based on the recurring payment.</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:638</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">Nop.Services.Payments.ProcessPaymentRequest</a></div><div class="ttdoc">Represents a payment info holder</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:13</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a4510c1808d0a62a564ab8e349050ef44"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a4510c1808d0a62a564ab8e349050ef44">Nop.Services.Payments.ProcessPaymentResult.Errors</a></div><div class="ttdeci">IList&lt; string &gt; Errors</div><div class="ttdoc">Errors</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:34</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a6cd07b37c195a5d9ba1d77aca25b4d93"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6cd07b37c195a5d9ba1d77aca25b4d93">Nop.Services.Payments.ProcessPaymentResult.RecurringPaymentFailed</a></div><div class="ttdeci">bool RecurringPaymentFailed</div><div class="ttdoc">Gets or sets a value indicating that the recurring payment failed</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:84</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a8533096be13a5f96011cdb9daa4d78df"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a8533096be13a5f96011cdb9daa4d78df">Nop.Services.Payments.ProcessPaymentResult.Success</a></div><div class="ttdeci">bool Success</div><div class="ttdoc">Gets a value indicating whether request has been completed successfully</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:20</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a63bdd8627ca7f4fe9c6ad6affb5fb198"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a63bdd8627ca7f4fe9c6ad6affb5fb198">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentFailedCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendRecurringPaymentFailedCustomerNotificationAsync(RecurringPayment recurringPayment, int languageId)</div><div class="ttdoc">Sends a &quot;Recurring payment failed&quot; notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_aced13a441c2811c58e47af374b0e55d9"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aced13a441c2811c58e47af374b0e55d9">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentCancelledCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendRecurringPaymentCancelledCustomerNotificationAsync(RecurringPayment recurringPayment, int languageId)</div><div class="ttdoc">Sends a &quot;Recurring payment cancelled&quot; notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_aa4ebb9ce309fe00bb9657f9f41bd11e6"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa4ebb9ce309fe00bb9657f9f41bd11e6">Nop.Services.Payments.IPaymentService.DeserializeCustomValues</a></div><div class="ttdeci">Dictionary&lt; string, object &gt; DeserializeCustomValues(Order order)</div><div class="ttdoc">Deserialize CustomValues of Order</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_security_1_1_i_encryption_service_html_a8c42744952a9b68161ea9f5886242832"><div class="ttname"><a href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">Nop.Services.Security.IEncryptionService.DecryptText</a></div><div class="ttdeci">string DecryptText(string cipherText, string encryptionPrivateKey=&quot;&quot;)</div><div class="ttdoc">Decrypt text</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models_html_addaebf28dd13529bc4c925468d919f5f"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">Nop.Plugin.Pickup.PickupInStore.Models.StoreId</a></div><div class="ttdeci">int StoreId</div><div class="ttdef"><b>Definition:</b> StorePickupPointModel.cs:36</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a9b3018a66cd7b222ad19d2de14e2466b"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9b3018a66cd7b222ad19d2de14e2466b">Nop.Web.Areas.Admin.Models.Orders.OrderGuid</a></div><div class="ttdeci">Guid OrderGuid</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:41</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ae27c9a81a56120c95b2689517fd0871d"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae27c9a81a56120c95b2689517fd0871d">Nop.Web.Areas.Admin.Models.Orders.CustomValues</a></div><div class="ttdeci">Dictionary&lt; string, object &gt; CustomValues</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:61</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">Nop.Services.Orders.OrderProcessingService._encryptionService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a96ff841d52ac21b5a23ce1a9883730d3">Nop.Services.Orders.OrderProcessingService._paymentPluginManager</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab25d720884f3f10ddec6c09b6a214b4d">Nop.Services.Orders.OrderProcessingService._paymentSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#af768f5da7a64d4bd0229f1ebbe727d87">Nop.Services.Catalog.IProductService.AdjustInventoryAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">Nop.Web.Areas.Admin.Models.Catalog.AttributesXml</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html#aef548923f584c3e502baea5ddc673ffc">Nop.Core.Domain.Payments.PaymentSettings.CancelRecurringPaymentsAfterFailedPayment</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">Nop.Plugin.Tax.Avalara.Models.Log.CustomerId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae27c9a81a56120c95b2689517fd0871d">Nop.Web.Areas.Admin.Models.Orders.CustomValues</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a20fa2ad07bd41be0e69773bee943881e">Nop.Core.Domain.Orders.RecurringPayment.CycleLength</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#acee4867aa04db4947b9b3118ae0709cf">Nop.Core.Domain.Orders.RecurringPayment.CyclePeriod</a>, <a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a8c42744952a9b68161ea9f5886242832">Nop.Services.Security.IEncryptionService.DecryptText()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#aa4ebb9ce309fe00bb9657f9f41bd11e6">Nop.Services.Payments.IPaymentService.DeserializeCustomValues()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aed6bcf76e9af9efdc1b39036c07e2339">Nop.Web.Areas.Admin.Models.Orders.DownloadCount</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a79f003fceaa9adc00f36f8654be85913">Nop.Services.Logging.ILogger.ErrorAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a4510c1808d0a62a564ab8e349050ef44">Nop.Services.Payments.ProcessPaymentResult.Errors</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">Nop.Services.Orders.OrderProcessingService.GetNextPaymentDateAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a28a938d0a5192f91ac7024c081b232e9">Nop.Services.Payments.IPaymentService.GetRecurringPaymentTypeAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a5095922475cf4b1ea4e3f8eeb62cad14">Nop.Core.Domain.Orders.RecurringPayment.InitialOrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#af5c522d07c4bfa70c71384b0d890c8f1">Nop.Services.Orders.IOrderService.InsertOrderItemAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aa5d03d6d03cfeb2771e00796c0a04ded">Nop.Services.Orders.IOrderService.InsertRecurringPaymentHistoryAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#a4b79451041f31572807357c834e61054">Nop.Core.Domain.Orders.RecurringPayment.IsActive</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2b6e46b2877ac8c8cbd01815811940fc">Nop.Web.Areas.Admin.Models.Orders.IsDownloadActivated</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html#a3ca5817d660c52b46621080a20598fc8">Nop.Services.Payments.IPaymentPluginManager.IsPluginActive()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a562e09ec2ece64b33dc1afcdbbbc0a99">Nop.Web.Areas.Admin.Models.Orders.ItemWeight</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aa76fcbec98f282a4dbb17c534d55c16c">Nop.Core.Domain.Orders.RecurringPayment.LastPaymentFailed</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aeb85b3b7b4160833212a34e82669cd0a">Nop.Web.Areas.Admin.Models.Orders.LicenseDownloadId</a>, <a class="el" href="interface_nop_1_1_services_1_1_plugins_1_1_i_plugin_manager.html#ae65d47d1226a9c2099ff48e24a976235">Nop.Services.Plugins.IPluginManager&lt; TPlugin &gt;.LoadPluginBySystemNameAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9b3018a66cd7b222ad19d2de14e2466b">Nop.Web.Areas.Admin.Models.Orders.OrderGuid</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ab17cc75a304e6bf10a1579a61da97ffe">Nop.Services.Payments.IPaymentService.ProcessRecurringPaymentAsync()</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">Nop.Web.Areas.Admin.Models.Catalog.ProductId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Nop.Web.Areas.Admin.Models.Catalog.Quantity</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6cd07b37c195a5d9ba1d77aca25b4d93">Nop.Services.Payments.ProcessPaymentResult.RecurringPaymentFailed</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a661520bc33d33d1bf5a482fe00f1c984">Nop.Web.Areas.Admin.Models.Orders.RecurringPaymentId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">Nop.Services.Orders.OrderProcessingService.SaveDiscountUsageHistoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#aced13a441c2811c58e47af374b0e55d9">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentCancelledCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a63bdd8627ca7f4fe9c6ad6affb5fb198">Nop.Services.Messages.IWorkflowMessageService.SendRecurringPaymentFailedCustomerNotificationAsync()</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">Nop.Plugin.Pickup.PickupInStore.Models.StoreId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a8533096be13a5f96011cdb9daa4d78df">Nop.Services.Payments.ProcessPaymentResult.Success</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_recurring_payment.html#aead35a8f54f9342c559568542c3e558f">Nop.Core.Domain.Orders.RecurringPayment.TotalCycles</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af128d4afe5fb49b08eb130558cbf1240">Nop.Web.Areas.Admin.Models.Orders.UnitPriceExclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9f44d521e2cb6de54997a4944fe78fb8">Nop.Web.Areas.Admin.Models.Orders.UnitPriceInclTax</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a46d2342e8308951f8cd55ead51dff68f">Nop.Services.Orders.IOrderService.UpdateRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a14f96cdb18cd65086be7f64788f98ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f96cdb18cd65086be7f64788f98ca3">&#9670;&nbsp;</a></span>ProcessOrderPaidAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process order paid status </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            <span class="comment">//raise event</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_paid_event.html">OrderPaidEvent</a>(order));</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="comment">//order paid email notification</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a> != decimal.Zero)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="comment">//we should not send it for free ($0 total) orders?</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <span class="comment">//remove this &quot;if&quot; statement if you want to send it in this case</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                var orderPaidAttachmentFilePath = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae9d9cc37948590b80a5558c4ace1ab45">AttachPdfInvoiceToOrderPaidEmail</a> ?</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">_pdfService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">PrintOrderToPdfAsync</a>(order) : <span class="keyword">null</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                var orderPaidAttachmentFileName = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae9d9cc37948590b80a5558c4ace1ab45">AttachPdfInvoiceToOrderPaidEmail</a> ?</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                    <span class="stringliteral">&quot;order.pdf&quot;</span> : <span class="keyword">null</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                var orderPaidCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae59f9e8d824e40e97d6f5413ae80edcf">SendOrderPaidCustomerNotificationAsync</a>(order, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    orderPaidAttachmentFilePath, orderPaidAttachmentFileName);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <span class="keywordflow">if</span> (orderPaidCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order paid\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPaidCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                var orderPaidStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a8ce7977f19b698112ce26cab1fb919ee">SendOrderPaidStoreOwnerNotificationAsync</a>(order, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                <span class="keywordflow">if</span> (orderPaidStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order paid\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPaidStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                var vendors = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">GetVendorsInOrderAsync</a>(order);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                <span class="keywordflow">foreach</span> (var vendor <span class="keywordflow">in</span> vendors)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    var orderPaidVendorNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9dd7f64110e89c94913f28ced7498a44">SendOrderPaidVendorNotificationAsync</a>(order, vendor, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                    <span class="keywordflow">if</span> (orderPaidVendorNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order paid\&quot; email (to vendor) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPaidVendorNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ae01165473b03ae2c517710de69734ba1">AffiliateId</a> != 0)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    var orderPaidAffiliateNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a408679d138aa5fedb967f766ea45aef1">SendOrderPaidAffiliateNotificationAsync</a>(order,</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    <span class="keywordflow">if</span> (orderPaidAffiliateNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order paid\&quot; email (to affiliate) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPaidAffiliateNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="comment">//customer roles with &quot;purchased with product&quot; specified</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">ProcessCustomerRolesWithPurchasedProductSpecifiedAsync</a>(order, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_ae01165473b03ae2c517710de69734ba1"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ae01165473b03ae2c517710de69734ba1">Nop.Core.Domain.Orders.Order.AffiliateId</a></div><div class="ttdeci">int AffiliateId</div><div class="ttdoc">Gets or sets the affiliate identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:179</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_paid_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_paid_event.html">Nop.Core.Domain.Orders.OrderPaidEvent</a></div><div class="ttdoc">Order paid event</div><div class="ttdef"><b>Definition:</b> OrderPaidEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_ae9d9cc37948590b80a5558c4ace1ab45"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae9d9cc37948590b80a5558c4ace1ab45">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderPaidEmail</a></div><div class="ttdeci">bool AttachPdfInvoiceToOrderPaidEmail</div><div class="ttdoc">Gets or sets a value indicating we should attach PDF invoice to &quot;Order paid&quot; email</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:89</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a9cfacc51e4ed202dd0ee478dba282fb3"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync</a></div><div class="ttdeci">virtual async Task ProcessCustomerRolesWithPurchasedProductSpecifiedAsync(Order order, bool add)</div><div class="ttdoc">Process customer roles with &quot;Purchased with Product&quot; property configured</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1173</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ada11474c14bf82ad908d28bf9d926112"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync</a></div><div class="ttdeci">virtual async Task&lt; IList&lt; Vendor &gt; &gt; GetVendorsInOrderAsync(Order order)</div><div class="ttdoc">Get a list of vendors in order (order items)</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:1240</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_common_1_1_i_pdf_service_html_abbeb84b271ab3e84f6f79ae4a9dc7b54"><div class="ttname"><a href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">Nop.Services.Common.IPdfService.PrintOrderToPdfAsync</a></div><div class="ttdeci">Task&lt; string &gt; PrintOrderToPdfAsync(Order order, int languageId=0, int vendorId=0)</div><div class="ttdoc">Print an order to PDF</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a408679d138aa5fedb967f766ea45aef1"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a408679d138aa5fedb967f766ea45aef1">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidAffiliateNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPaidAffiliateNotificationAsync(Order order, int languageId)</div><div class="ttdoc">Sends an order paid notification to an affiliate</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a8ce7977f19b698112ce26cab1fb919ee"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a8ce7977f19b698112ce26cab1fb919ee">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidStoreOwnerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPaidStoreOwnerNotificationAsync(Order order, int languageId)</div><div class="ttdoc">Sends an order paid notification to a store owner</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a9dd7f64110e89c94913f28ced7498a44"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9dd7f64110e89c94913f28ced7498a44">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidVendorNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPaidVendorNotificationAsync(Order order, Vendor vendor, int languageId)</div><div class="ttdoc">Sends an order paid notification to a vendor</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_ae59f9e8d824e40e97d6f5413ae80edcf"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae59f9e8d824e40e97d6f5413ae80edcf">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPaidCustomerNotificationAsync(Order order, int languageId, string attachmentFilePath=null, string attachmentFileName=null)</div><div class="ttdoc">Sends an order paid notification to a customer</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">Nop.Services.Orders.OrderProcessingService._pdfService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ae01165473b03ae2c517710de69734ba1">Nop.Core.Domain.Orders.Order.AffiliateId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae9d9cc37948590b80a5558c4ace1ab45">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderPaidEmail</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">Nop.Services.Common.IPdfService.PrintOrderToPdfAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a408679d138aa5fedb967f766ea45aef1">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidAffiliateNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae59f9e8d824e40e97d6f5413ae80edcf">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a8ce7977f19b698112ce26cab1fb919ee">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a9dd7f64110e89c94913f28ced7498a44">Nop.Services.Messages.IWorkflowMessageService.SendOrderPaidVendorNotificationAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a58ef586e3bf6517d1a70e6fcc6bef293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58ef586e3bf6517d1a70e6fcc6bef293">&#9670;&nbsp;</a></span>ReduceRewardPointsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reduce (cancel) reward points (previously awarded for placing an order) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="keywordflow">if</span> (order is <span class="keyword">null</span>)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            var totalForRewardPoints = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                .<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ac7d675bce9c7ec0501c77ad844727571">CalculateApplicableOrderTotalForRewardPoints</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ad5df520cde264bc84fa73ed2d60a4bc6">OrderShippingInclTax</a>, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a>);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            var points = totalForRewardPoints &gt; decimal.Zero ?</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a5336d950071e2d76647171ba3632c5f6">CalculateRewardPointsAsync</a>(customer, totalForRewardPoints) : 0;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="keywordflow">if</span> (points == 0)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="comment">//ensure that reward points were already earned for this order before</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="keywordflow">if</span> (!order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">RewardPointsHistoryEntryId</a>.HasValue)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="comment">//get appropriate history entry</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            var rewardPointsHistoryEntry = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a1998cca68e5c819a20ae1f0fafff08ba">GetRewardPointsHistoryEntryByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">RewardPointsHistoryEntryId</a>.Value);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordflow">if</span> (rewardPointsHistoryEntry != <span class="keyword">null</span> &amp;&amp; rewardPointsHistoryEntry.CreatedOnUtc &gt; DateTime.UtcNow)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="comment">//just delete the upcoming entry (points were not granted yet)</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a29fed3a8a9ce8bca41f75f2fbfbba8f7">DeleteRewardPointsHistoryEntryAsync</a>(rewardPointsHistoryEntry);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <span class="comment">//or reduce reward points if the entry already exists</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">AddRewardPointsHistoryEntryAsync</a>(customer, -points, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;RewardPoints.Message.ReducedForOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">CustomOrderNumber</a>));</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service_html_a1998cca68e5c819a20ae1f0fafff08ba"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a1998cca68e5c819a20ae1f0fafff08ba">Nop.Services.Orders.IRewardPointService.GetRewardPointsHistoryEntryByIdAsync</a></div><div class="ttdeci">Task&lt; RewardPointsHistory &gt; GetRewardPointsHistoryEntryByIdAsync(int rewardPointsHistoryId)</div><div class="ttdoc">Gets a reward point history entry</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service_html_a29fed3a8a9ce8bca41f75f2fbfbba8f7"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a29fed3a8a9ce8bca41f75f2fbfbba8f7">Nop.Services.Orders.IRewardPointService.DeleteRewardPointsHistoryEntryAsync</a></div><div class="ttdeci">Task DeleteRewardPointsHistoryEntryAsync(RewardPointsHistory rewardPointsHistory)</div><div class="ttdoc">Delete the reward point history entry</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">Nop.Services.Orders.IRewardPointService.AddRewardPointsHistoryEntryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ac7d675bce9c7ec0501c77ad844727571">Nop.Services.Orders.IOrderTotalCalculationService.CalculateApplicableOrderTotalForRewardPoints()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a5336d950071e2d76647171ba3632c5f6">Nop.Services.Orders.IOrderTotalCalculationService.CalculateRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">Nop.Core.Domain.Orders.Order.CustomOrderNumber</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a29fed3a8a9ce8bca41f75f2fbfbba8f7">Nop.Services.Orders.IRewardPointService.DeleteRewardPointsHistoryEntryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a1998cca68e5c819a20ae1f0fafff08ba">Nop.Services.Orders.IRewardPointService.GetRewardPointsHistoryEntryByIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ad5df520cde264bc84fa73ed2d60a4bc6">Nop.Core.Domain.Orders.Order.OrderShippingInclTax</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a860f19c21ffa790750a0887b6ae14b85">Nop.Core.Domain.Orders.Order.RewardPointsHistoryEntryId</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">Nop.Core.Domain.Orders.Order.StoreId</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="ad72ff7732c1fc400922a2a6c37d20e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72ff7732c1fc400922a2a6c37d20e17">&#9670;&nbsp;</a></span>RefundAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.RefundAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refunds an order (from admin panel) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains a list of errors; empty list if no errors </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#af82775d602bac28c5e88215f8871665e">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; </div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">CanRefundAsync</a>(order))</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cannot do refund for order.&quot;</span>);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160; </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;            var request = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_request.html">RefundPaymentRequest</a>();</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_result.html">RefundPaymentResult</a> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                request.Order = order;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                request.AmountToRefund = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a>;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                request.IsPartialRefund = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a44d3a3bee742272dc64a0b83b04101c4">RefundAsync</a>(request);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                    <span class="comment">//total amount refunded</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                    var totalAmountRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> + request.AmountToRefund;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                    <span class="comment">//update order info</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> = totalAmountRefunded;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                    <span class="comment">//add a note</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Order has been refunded. Amount = {request.AmountToRefund}&quot;</span>);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160; </div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                    <span class="comment">//check order status</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                    <span class="comment">//notifications</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                    var orderRefundedStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">SendOrderRefundedStoreOwnerNotificationAsync</a>(order, request.AmountToRefund, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                    <span class="keywordflow">if</span> (orderRefundedStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                    var orderRefundedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">SendOrderRefundedCustomerNotificationAsync</a>(order, request.AmountToRefund, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                    <span class="keywordflow">if</span> (orderRefundedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                        await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                    <span class="comment">//raise event       </span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event.html">OrderRefundedEvent</a>(order, request.AmountToRefund));</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                }</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;            {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_refund_payment_result.html">RefundPaymentResult</a>();</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError($<span class="stringliteral">&quot;Error: {exc.Message}. Full exception: {exc}&quot;</span>);</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;            }</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160; </div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            <span class="comment">//process errors</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            var error = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count; i++)</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                error += $<span class="stringliteral">&quot;Error {i}: {result.Errors[i]}&quot;</span>;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                <span class="keywordflow">if</span> (i != <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count - 1)</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                    error += <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(error))</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Unable to refund order. {error}&quot;</span>);</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            <span class="comment">//log it</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            var logError = $<span class="stringliteral">&quot;Error refunding order #{order.Id}. Error: {error}&quot;</span>;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">InsertLogAsync</a>(<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">LogLevel</a>.Error, logError, logError);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a5a51e3689da5d8de248f4d4505f651f6"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">Nop.Services.Orders.OrderProcessingService.CanRefundAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; CanRefundAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether refund from admin panel is allowed</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2534</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">Nop.Services.Orders.OrderProcessingService.CanRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a44d3a3bee742272dc64a0b83b04101c4">Nop.Services.Payments.IPaymentService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="adede3bbc864fd8df87dbf282c9a6f0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adede3bbc864fd8df87dbf282c9a6f0c4">&#9670;&nbsp;</a></span>RefundOfflineAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refunds an order (offline) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a26cd274c952a35f6bb34305b6a78bb34">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        {</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; </div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2de203d7ac5f4bb664036c72eec2f772">CanRefundOffline</a>(order))</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;You can&#39;t refund this order&quot;</span>);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <span class="comment">//amout to refund</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            var amountToRefund = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">OrderTotal</a>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160; </div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            <span class="comment">//total amount refunded</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            var totalAmountRefunded = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> + amountToRefund;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="comment">//update order info</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">RefundedAmount</a> = totalAmountRefunded;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Refunded;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160; </div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Order has been marked as refunded. Amount = {amountToRefund}&quot;</span>);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;            <span class="comment">//notifications</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            var orderRefundedStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">SendOrderRefundedStoreOwnerNotificationAsync</a>(order, amountToRefund, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            <span class="keywordflow">if</span> (orderRefundedStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            var orderRefundedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">SendOrderRefundedCustomerNotificationAsync</a>(order, amountToRefund, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            <span class="keywordflow">if</span> (orderRefundedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order refunded\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderRefundedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            <span class="comment">//raise event       </span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_refunded_event.html">OrderRefundedEvent</a>(order, amountToRefund));</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a2de203d7ac5f4bb664036c72eec2f772"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2de203d7ac5f4bb664036c72eec2f772">Nop.Services.Orders.OrderProcessingService.CanRefundOffline</a></div><div class="ttdeci">virtual bool CanRefundOffline(Order order)</div><div class="ttdoc">Gets a value indicating whether order can be marked as refunded</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2644</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2de203d7ac5f4bb664036c72eec2f772">Nop.Services.Orders.OrderProcessingService.CanRefundOffline()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a5707771d888f12d4a74e1e2eac82f720">Nop.Core.Domain.Orders.Order.OrderTotal</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a9b339205739d7323f10102549276d3b2">Nop.Core.Domain.Orders.Order.RefundedAmount</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a024e725d06b93b18e5e5f8c46e0c1158">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab8088f4807759c499b93a6f4ad92f6d2">Nop.Services.Messages.IWorkflowMessageService.SendOrderRefundedStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<a id="a9b0a42aabf0d2b5c41765806fce04b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b0a42aabf0d2b5c41765806fce04b17">&#9670;&nbsp;</a></span>ReOrderAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ReOrderAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Place order items in current user shopping cart. </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>The order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#ac4e5e08b1ad9887b86eb206ffc0d4ed3">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160; </div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            <span class="comment">//move shopping cart items (if possible)</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;            <span class="keywordflow">foreach</span> (var orderItem <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(orderItem.ProductId);</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#aaac24cc4cb59a21ec4ee1a964677ff7f">AddToCartAsync</a>(customer, product,</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#ae2fb88620fcd3889e6e0504e7b18e806">ShoppingCartType</a>.ShoppingCart, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>,</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                    orderItem.AttributesXml, orderItem.UnitPriceExclTax,</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                    orderItem.RentalStartDateUtc, orderItem.RentalEndDateUtc,</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                    orderItem.Quantity, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;            }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;            <span class="comment">//set checkout attributes</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            <span class="comment">//comment the code below if you want to disable this functionality</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">_genericAttributeService</a>.SaveAttributeAsync(customer, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html">NopCustomerDefaults</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a7fad329b67b90c06f515599945aa20ef">CheckoutAttributes</a>, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aa6208b6d6028dcd42ad138918507bf09">CheckoutAttributesXml</a>, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_aa6208b6d6028dcd42ad138918507bf09"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aa6208b6d6028dcd42ad138918507bf09">Nop.Core.Domain.Orders.Order.CheckoutAttributesXml</a></div><div class="ttdeci">string CheckoutAttributesXml</div><div class="ttdoc">Gets or sets the checkout attributes in XML format</div><div class="ttdef"><b>Definition:</b> Order.cs:169</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service_html_aaac24cc4cb59a21ec4ee1a964677ff7f"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#aaac24cc4cb59a21ec4ee1a964677ff7f">Nop.Services.Orders.IShoppingCartService.AddToCartAsync</a></div><div class="ttdeci">Task&lt; IList&lt; string &gt; &gt; AddToCartAsync(Customer customer, Product product, ShoppingCartType shoppingCartType, int storeId, string attributesXml=null, decimal customerEnteredPrice=decimal.Zero, DateTime? rentalStartDate=null, DateTime? rentalEndDate=null, int quantity=1, bool addRequiredProducts=true)</div><div class="ttdoc">Add a product to shopping cart</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af591bddf525120c688839eeb5b63483a">Nop.Services.Orders.OrderProcessingService._genericAttributeService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#aaac24cc4cb59a21ec4ee1a964677ff7f">Nop.Services.Orders.IShoppingCartService.AddToCartAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_nop_customer_defaults.html#a7fad329b67b90c06f515599945aa20ef">Nop.Core.Domain.Customers.NopCustomerDefaults.CheckoutAttributes</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>.</p>

</div>
</div>
<a id="ab4879004f9159f7339cf04d1e2478178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4879004f9159f7339cf04d1e2478178">&#9670;&nbsp;</a></span>ReturnBackRedeemedRewardPointsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return back redeemed reward points to a customer (spent when placing an order) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="comment">//were some reward points spend on the order</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">foreach</span> (var rewardPoints <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#ac862c43035a2a3b765cf4a5cab2c538b">GetRewardPointsHistoryAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>, orderGuid: order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aaa850211b032f8e766793f70841caa73">OrderGuid</a>))</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <span class="comment">//return back</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">AddRewardPointsHistoryEntryAsync</a>(customer, -rewardPoints.Points, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a>,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;RewardPoints.Message.ReturnedForOrder&quot;</span>), order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a7061d07eef94408c40f32832cf91aafa">CustomOrderNumber</a>));</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_aaa850211b032f8e766793f70841caa73"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#aaa850211b032f8e766793f70841caa73">Nop.Core.Domain.Orders.Order.OrderGuid</a></div><div class="ttdeci">Guid OrderGuid</div><div class="ttdoc">Gets or sets the order identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:19</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service_html_ac862c43035a2a3b765cf4a5cab2c538b"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#ac862c43035a2a3b765cf4a5cab2c538b">Nop.Services.Orders.IRewardPointService.GetRewardPointsHistoryAsync</a></div><div class="ttdeci">Task&lt; IPagedList&lt; RewardPointsHistory &gt; &gt; GetRewardPointsHistoryAsync(int customerId=0, int? storeId=null, bool showNotActivated=false, Guid? orderGuid=null, int pageIndex=0, int pageSize=int.MaxValue)</div><div class="ttdoc">Load reward point history records</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">Nop.Services.Orders.IRewardPointService.AddRewardPointsHistoryEntryAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#ac862c43035a2a3b765cf4a5cab2c538b">Nop.Services.Orders.IRewardPointService.GetRewardPointsHistoryAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>.</p>

</div>
</div>
<a id="ae28360b413dd34283242e7075da477d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28360b413dd34283242e7075da477d3">&#9670;&nbsp;</a></span>SaveDiscountUsageHistoryAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.SaveDiscountUsageHistoryAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&#160;</td>
          <td class="paramname"><em>details</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save discount usage history </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">details</td><td><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html" title="PlaceOrder container">PlaceOrderContainer</a></td></tr>
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">if</span> (details.AppliedDiscounts == <span class="keyword">null</span> || !details.AppliedDiscounts.Any())</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordflow">foreach</span> (var discount <span class="keywordflow">in</span> details.AppliedDiscounts)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                var d = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">GetDiscountByIdAsync</a>(discount.Id);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                <span class="keywordflow">if</span> (d == <span class="keyword">null</span>) </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a71efd382f143d24db78abe78f04f134e">InsertDiscountUsageHistoryAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_discounts_1_1_discount_usage_history.html">DiscountUsageHistory</a></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#af041086ef7fd47ba975c04641acd8723">DiscountId</a> = d.Id,</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                    CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                });</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_discounts_1_1_discount_usage_history_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_discounts_1_1_discount_usage_history.html">Nop.Core.Domain.Discounts.DiscountUsageHistory</a></div><div class="ttdoc">Represents a discount usage history entry</div><div class="ttdef"><b>Definition:</b> DiscountUsageHistory.cs:9</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_discounts_1_1_i_discount_service_html_a71efd382f143d24db78abe78f04f134e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a71efd382f143d24db78abe78f04f134e">Nop.Services.Discounts.IDiscountService.InsertDiscountUsageHistoryAsync</a></div><div class="ttdeci">Task InsertDiscountUsageHistoryAsync(DiscountUsageHistory discountUsageHistory)</div><div class="ttdoc">Insert discount usage history record</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts_html_af041086ef7fd47ba975c04641acd8723"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#af041086ef7fd47ba975c04641acd8723">Nop.Web.Areas.Admin.Models.Discounts.DiscountId</a></div><div class="ttdeci">int DiscountId</div><div class="ttdef"><b>Definition:</b> AddCategoryToDiscountModel.cs:21</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a80b6dffa5cfa458c7f027ed068d1705c">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.AppliedDiscounts</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#af041086ef7fd47ba975c04641acd8723">Nop.Web.Areas.Admin.Models.Discounts.DiscountId</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">Nop.Services.Discounts.IDiscountService.GetDiscountByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a71efd382f143d24db78abe78f04f134e">Nop.Services.Discounts.IDiscountService.InsertDiscountUsageHistoryAsync()</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="af2b1d50935c535ba0709de02f3da3c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b1d50935c535ba0709de02f3da3c05">&#9670;&nbsp;</a></span>SaveGiftCardUsageHistoryAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.SaveGiftCardUsageHistoryAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&#160;</td>
          <td class="paramname"><em>details</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save gift card usage history </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">details</td><td>Place order container</td></tr>
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">if</span> (details.AppliedGiftCards == <span class="keyword">null</span> || !details.AppliedGiftCards.Any())</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordflow">foreach</span> (var agc <span class="keywordflow">in</span> details.AppliedGiftCards)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a82d587e1ef5a4082cf27f89bc74a4785">InsertGiftCardUsageHistoryAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card_usage_history.html">GiftCardUsageHistory</a></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                    GiftCardId = agc.GiftCard.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    UsedWithOrderId = order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>,</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                    UsedValue = agc.AmountCanBeUsed,</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                    CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                });</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card_usage_history_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_gift_card_usage_history.html">Nop.Core.Domain.Orders.GiftCardUsageHistory</a></div><div class="ttdoc">Represents a gift card usage history entry</div><div class="ttdef"><b>Definition:</b> GiftCardUsageHistory.cs:9</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_a82d587e1ef5a4082cf27f89bc74a4785"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a82d587e1ef5a4082cf27f89bc74a4785">Nop.Services.Orders.IGiftCardService.InsertGiftCardUsageHistoryAsync</a></div><div class="ttdeci">Task InsertGiftCardUsageHistoryAsync(GiftCardUsageHistory giftCardUsageHistory)</div><div class="ttdoc">Inserts a gift card usage history entry</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#aac021839992c98f1920d4a79eb071825">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.AppliedGiftCards</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a82d587e1ef5a4082cf27f89bc74a4785">Nop.Services.Orders.IGiftCardService.InsertGiftCardUsageHistoryAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="aea58104edceca7eb0576dc9c02824f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea58104edceca7eb0576dc9c02824f04">&#9670;&nbsp;</a></span>SaveOrderDetailsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;<a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&gt; Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html">ProcessPaymentRequest</a>&#160;</td>
          <td class="paramname"><em>processPaymentRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html">ProcessPaymentResult</a>&#160;</td>
          <td class="paramname"><em>processPaymentResult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html">PlaceOrderContainer</a>&#160;</td>
          <td class="paramname"><em>details</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save order and add order notes </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">processPaymentRequest</td><td>Process payment request</td></tr>
    <tr><td class="paramname">processPaymentResult</td><td>Process payment result</td></tr>
    <tr><td class="paramname">details</td><td>Details</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the order </dd></dl>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            var order = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <a class="code" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">StoreId</a> = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">StoreId</a>,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9b3018a66cd7b222ad19d2de14e2466b">OrderGuid</a> = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1ad6e75bc8d6088bdd0ce3d710e3ee89">OrderGuid</a>,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <a class="code" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">CustomerId</a> = details.Customer.Id,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                CustomerLanguageId = details.CustomerLanguage.Id,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                CustomerTaxDisplayType = details.CustomerTaxDisplayType,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a958efcafb37becc2c1d33168c0ba32b5">CustomerIp</a> = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">_webHelper</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_web_helper.html#ac1757af7d7a624641c0eb47817adf610">GetCurrentIpAddress</a>(),</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a369dc734eb2683217a7463c2025cba84">OrderSubtotalInclTax</a> = details.OrderSubTotalInclTax,</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a27b8b85278182a0aedf5b41a2877f989">OrderSubtotalExclTax</a> = details.OrderSubTotalExclTax,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae6fcac7c96b0de60940b9e6ab9f9124f">OrderSubTotalDiscountInclTax</a> = details.OrderSubTotalDiscountInclTax,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5ef52aba819cdceea8fe783a559eae9d">OrderSubTotalDiscountExclTax</a> = details.OrderSubTotalDiscountExclTax,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2be99ac6ad214361b9bb1a2969500d6d">OrderShippingInclTax</a> = details.OrderShippingTotalInclTax,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a0ed21cb24ca7119ec8071987d2aa2adf">OrderShippingExclTax</a> = details.OrderShippingTotalExclTax,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a76625ebf1cce0a6a27378e13b633edbe">PaymentMethodAdditionalFeeInclTax</a> = details.PaymentAdditionalFeeInclTax,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2cb529f23ef9494c6ad93227d931d49a">PaymentMethodAdditionalFeeExclTax</a> = details.PaymentAdditionalFeeExclTax,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4245cae077ca63a7bc9cccb09d1578c1">TaxRates</a> = details.TaxRates,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                OrderTax = details.OrderTaxTotal,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a0e320952bc0db6909377932bdb257f5a">OrderTotal</a> = details.OrderTotal,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aff5a8b4a0d7b0889d56af1d9075d6b60">RefundedAmount</a> = decimal.Zero,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                OrderDiscount = details.OrderDiscountAmount,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                CheckoutAttributeDescription = details.CheckoutAttributeDescription,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                CheckoutAttributesXml = details.CheckoutAttributesXml,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                CustomerCurrencyCode = details.CustomerCurrencyCode,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                CurrencyRate = details.CustomerCurrencyRate,</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad38a141c1fdab1cfc0adf4ba1a906b66">AffiliateId</a> = details.AffiliateId,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a> = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Pending,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4cbdc5598e4179bc160384d84fcb941e">AllowStoringCreditCardNumber</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a>,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a33a7985c5dfd1d8619cfc7eafee96f12">CardType</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ab48193c8c137367f786fca3c932dac3e">CreditCardType</a>) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4d23e178ceec11bd02e628919d464ffe">CardName</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ac8879ed8814db958715fe5b4ed448201">CreditCardName</a>) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <a class="code" href="namespace_nop_1_1_plugin_1_1_payments_1_1_manual_1_1_models.html#a49f2efcb95e8b244233e69399e080d83">CardNumber</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#abd502ed34204ecf609c94cb6a0ef7687">CreditCardNumber</a>) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                MaskedCreditCardNumber = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a1692ed1ef503fa2ad4385d8239234b3b">GetMaskedCreditCardNumber</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#abd502ed34204ecf609c94cb6a0ef7687">CreditCardNumber</a>)),</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a972675175913d0ea5fcba0ac710eb980">CardCvv2</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#aadfbc068b0bebb5efa80f78761514718">CreditCardCvv2</a>) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a15a56c635eb54e3099ac11ae66467d20">CardExpirationMonth</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#afedf71f266ca76f85103f39f562ce25d">CreditCardExpireMonth</a>.ToString()) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad0b14314d1457baa77ec2d2eaaafc3e4">CardExpirationYear</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">AllowStoringCreditCardNumber</a> ? <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">_encryptionService</a>.<a class="code" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">EncryptText</a>(processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a84d44ed9264c203461f1ed2f56545b2c">CreditCardExpireYear</a>.ToString()) : <span class="keywordtype">string</span>.Empty,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a19b2727c8203affecc07ecdd64147303">PaymentMethodSystemName</a> = processPaymentRequest.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">PaymentMethodSystemName</a>,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4e7042e8ee178a98198afaa4d5456f87">AuthorizationTransactionId</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a51354ebec6390fd8a228ca2bdb394a3c">AuthorizationTransactionId</a>,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                AuthorizationTransactionCode = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6d4d375f3c510aae15235496c3aa1173">AuthorizationTransactionCode</a>,</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                AuthorizationTransactionResult = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69a4cbcd8a1b537c8aef9436e5605bde">AuthorizationTransactionResult</a>,</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aa3307d18d8650265adca9c21e5e48011">CaptureTransactionId</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a40b8566eff1e6292779139e763a6de60">CaptureTransactionId</a>,</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                CaptureTransactionResult = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a200af0190735043c3dbf323a5ca88500">CaptureTransactionResult</a>,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0d943594f78c1eb0ab1652c46c13f97">SubscriptionTransactionId</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69f79e64590fbf7733315cb9d4d83e3c">SubscriptionTransactionId</a>,</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a> = processPaymentResult.<a class="code" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a15069a181038a00f7c442f750cde4e78">NewPaymentStatus</a>,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                PaidDateUtc = <span class="keyword">null</span>,</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a7cd00a4786b83cb99a0936107e5744e2">PickupInStore</a> = details.PickupInStore,</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a> = details.ShippingStatus,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_method.html">ShippingMethod</a> = details.ShippingMethodName,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_shopping_cart.html#ac3319f6afccb6ac1cc0a2dfdc766a2c9">ShippingRateComputationMethodSystemName</a> = details.ShippingRateComputationMethodSystemName,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                CustomValuesXml = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ad3b6aafb6be58943f50971afab659d51">SerializeCustomValues</a>(processPaymentRequest),</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ac030142457f0ea1f838bb620e2340d9e">VatNumber</a> = details.VatNumber,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                CreatedOnUtc = DateTime.UtcNow,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a49b7abe66f7cb9548b6aa391768dbae4">CustomOrderNumber</a> = <span class="keywordtype">string</span>.Empty</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            };</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordflow">if</span> (details.BillingAddress is <span class="keyword">null</span>)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Billing address is not provided&quot;</span>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">InsertAddressAsync</a>(details.BillingAddress);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            order.BillingAddressId = details.BillingAddress.Id;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">if</span> (details.PickupAddress != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">InsertAddressAsync</a>(details.PickupAddress);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                order.PickupAddressId = details.PickupAddress.Id;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span> (details.ShippingAddress != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">InsertAddressAsync</a>(details.ShippingAddress);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                order.ShippingAddressId = details.ShippingAddress.Id;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a3b3c164806463d27db20dbc85ea3a4b0">InsertOrderAsync</a>(order);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="comment">//generate and set custom order number</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            order.CustomOrderNumber = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">_customNumberFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html#a1f48037fc9293ec1a925228ab16749fc">GenerateOrderCustomNumber</a>(order);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="comment">//reward points history</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">if</span> (details.RedeemedRewardPointsAmount &lt;= decimal.Zero)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                <span class="keywordflow">return</span> order;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            order.RedeemedRewardPointsEntryId = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">_rewardPointService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">AddRewardPointsHistoryEntryAsync</a>(details.Customer, -details.RedeemedRewardPoints, order.StoreId,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;RewardPoints.Message.RedeemedForOrder&quot;</span>, order.CustomerLanguageId), order.CustomOrderNumber),</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                order, details.RedeemedRewardPointsAmount);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a5e3102e7df9c920f1d3aa72f26502fd4">UpdateCustomerAsync</a>(details.Customer);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordflow">return</span> order;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Nop.Core.Domain.Orders.Order</a></div><div class="ttdoc">Represents an order</div><div class="ttdef"><b>Definition:</b> Order.cs:13</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_method_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_method.html">Nop.Core.Domain.Shipping.ShippingMethod</a></div><div class="ttdoc">Represents a shipping method (used by offline shipping rate computation methods)</div><div class="ttdef"><b>Definition:</b> ShippingMethod.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_a84d44ed9264c203461f1ed2f56545b2c"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a84d44ed9264c203461f1ed2f56545b2c">Nop.Services.Payments.ProcessPaymentRequest.CreditCardExpireYear</a></div><div class="ttdeci">int CreditCardExpireYear</div><div class="ttdoc">Gets or sets a credit card expire year</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:71</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_aadfbc068b0bebb5efa80f78761514718"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#aadfbc068b0bebb5efa80f78761514718">Nop.Services.Payments.ProcessPaymentRequest.CreditCardCvv2</a></div><div class="ttdeci">string CreditCardCvv2</div><div class="ttdoc">Gets or sets a credit card CVV2 (Card Verification Value)</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:81</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_ab48193c8c137367f786fca3c932dac3e"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ab48193c8c137367f786fca3c932dac3e">Nop.Services.Payments.ProcessPaymentRequest.CreditCardType</a></div><div class="ttdeci">string CreditCardType</div><div class="ttdoc">Gets or sets a credit card type (Visa, Master Card, etc...). We leave it empty if not used by a payme...</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:56</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_abd502ed34204ecf609c94cb6a0ef7687"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#abd502ed34204ecf609c94cb6a0ef7687">Nop.Services.Payments.ProcessPaymentRequest.CreditCardNumber</a></div><div class="ttdeci">string CreditCardNumber</div><div class="ttdoc">Gets or sets a credit card number</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:66</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_ac8879ed8814db958715fe5b4ed448201"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ac8879ed8814db958715fe5b4ed448201">Nop.Services.Payments.ProcessPaymentRequest.CreditCardName</a></div><div class="ttdeci">string CreditCardName</div><div class="ttdoc">Gets or sets a credit card owner name</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:61</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_request_html_afedf71f266ca76f85103f39f562ce25d"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#afedf71f266ca76f85103f39f562ce25d">Nop.Services.Payments.ProcessPaymentRequest.CreditCardExpireMonth</a></div><div class="ttdeci">int CreditCardExpireMonth</div><div class="ttdoc">Gets or sets a credit card expire month</div><div class="ttdef"><b>Definition:</b> ProcessPaymentRequest.cs:76</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a15069a181038a00f7c442f750cde4e78"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a15069a181038a00f7c442f750cde4e78">Nop.Services.Payments.ProcessPaymentResult.NewPaymentStatus</a></div><div class="ttdeci">PaymentStatus NewPaymentStatus</div><div class="ttdoc">Gets or sets a payment status after processing</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:89</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a200af0190735043c3dbf323a5ca88500"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a200af0190735043c3dbf323a5ca88500">Nop.Services.Payments.ProcessPaymentResult.CaptureTransactionResult</a></div><div class="ttdeci">string CaptureTransactionResult</div><div class="ttdoc">Gets or sets the capture transaction result</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:69</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a40b8566eff1e6292779139e763a6de60"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a40b8566eff1e6292779139e763a6de60">Nop.Services.Payments.ProcessPaymentResult.CaptureTransactionId</a></div><div class="ttdeci">string CaptureTransactionId</div><div class="ttdoc">Gets or sets the capture transaction identifier</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:64</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a51354ebec6390fd8a228ca2bdb394a3c"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a51354ebec6390fd8a228ca2bdb394a3c">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionId</a></div><div class="ttdeci">string AuthorizationTransactionId</div><div class="ttdoc">Gets or sets the authorization transaction identifier</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:49</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a69a4cbcd8a1b537c8aef9436e5605bde"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69a4cbcd8a1b537c8aef9436e5605bde">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionResult</a></div><div class="ttdeci">string AuthorizationTransactionResult</div><div class="ttdoc">Gets or sets the authorization transaction result</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:59</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a69f79e64590fbf7733315cb9d4d83e3c"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69f79e64590fbf7733315cb9d4d83e3c">Nop.Services.Payments.ProcessPaymentResult.SubscriptionTransactionId</a></div><div class="ttdeci">string SubscriptionTransactionId</div><div class="ttdoc">Gets or sets the subscription transaction identifier</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:74</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_a6d4d375f3c510aae15235496c3aa1173"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6d4d375f3c510aae15235496c3aa1173">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionCode</a></div><div class="ttdeci">string AuthorizationTransactionCode</div><div class="ttdoc">Gets or sets the authorization transaction code</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:54</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_process_payment_result_html_aeaac974593f572c4751da3f2e63903c3"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">Nop.Services.Payments.ProcessPaymentResult.AllowStoringCreditCardNumber</a></div><div class="ttdeci">bool AllowStoringCreditCardNumber</div><div class="ttdoc">Gets or sets a value indicating whether storing of credit card number, CVV2 is allowed</div><div class="ttdef"><b>Definition:</b> ProcessPaymentResult.cs:79</div></div>
<div class="ttc" id="ainterface_nop_1_1_core_1_1_i_web_helper_html_ac1757af7d7a624641c0eb47817adf610"><div class="ttname"><a href="interface_nop_1_1_core_1_1_i_web_helper.html#ac1757af7d7a624641c0eb47817adf610">Nop.Core.IWebHelper.GetCurrentIpAddress</a></div><div class="ttdeci">string GetCurrentIpAddress()</div><div class="ttdoc">Get IP address from HTTP context</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_common_1_1_i_address_service_html_a1faf9b7e4abdf2ab5a9f430c31c5e8e0"><div class="ttname"><a href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">Nop.Services.Common.IAddressService.InsertAddressAsync</a></div><div class="ttdeci">Task InsertAddressAsync(Address address)</div><div class="ttdoc">Inserts an address</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter_html_a1f48037fc9293ec1a925228ab16749fc"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html#a1f48037fc9293ec1a925228ab16749fc">Nop.Services.Orders.ICustomNumberFormatter.GenerateOrderCustomNumber</a></div><div class="ttdeci">string GenerateOrderCustomNumber(Order order)</div><div class="ttdoc">Generate order custom number</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_service_html_a3b3c164806463d27db20dbc85ea3a4b0"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a3b3c164806463d27db20dbc85ea3a4b0">Nop.Services.Orders.IOrderService.InsertOrderAsync</a></div><div class="ttdeci">Task InsertOrderAsync(Order order)</div><div class="ttdoc">Inserts an order</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_a1692ed1ef503fa2ad4385d8239234b3b"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a1692ed1ef503fa2ad4385d8239234b3b">Nop.Services.Payments.IPaymentService.GetMaskedCreditCardNumber</a></div><div class="ttdeci">string GetMaskedCreditCardNumber(string creditCardNumber)</div><div class="ttdoc">Gets masked credit card number</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_ad3b6aafb6be58943f50971afab659d51"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ad3b6aafb6be58943f50971afab659d51">Nop.Services.Payments.IPaymentService.SerializeCustomValues</a></div><div class="ttdeci">string SerializeCustomValues(ProcessPaymentRequest request)</div><div class="ttdoc">Serialize CustomValues of ProcessPaymentRequest</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_security_1_1_i_encryption_service_html_a26be40e348702524d57ed53debe6f875"><div class="ttname"><a href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">Nop.Services.Security.IEncryptionService.EncryptText</a></div><div class="ttdeci">string EncryptText(string plainText, string encryptionPrivateKey=&quot;&quot;)</div><div class="ttdoc">Encrypt text</div></div>
<div class="ttc" id="anamespace_nop_1_1_plugin_1_1_payments_1_1_manual_1_1_models_html_a49f2efcb95e8b244233e69399e080d83"><div class="ttname"><a href="namespace_nop_1_1_plugin_1_1_payments_1_1_manual_1_1_models.html#a49f2efcb95e8b244233e69399e080d83">Nop.Plugin.Payments.Manual.Models.CardNumber</a></div><div class="ttdeci">string CardNumber</div><div class="ttdef"><b>Definition:</b> PaymentInfoModel.cs:27</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates_html_a0e320952bc0db6909377932bdb257f5a"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a0e320952bc0db6909377932bdb257f5a">Nop.Web.Areas.Admin.Models.Affiliates.OrderTotal</a></div><div class="ttdeci">string OrderTotal</div><div class="ttdef"><b>Definition:</b> AffiliatedOrderModel.cs:31</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates_html_a49b7abe66f7cb9548b6aa391768dbae4"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a49b7abe66f7cb9548b6aa391768dbae4">Nop.Web.Areas.Admin.Models.Affiliates.CustomOrderNumber</a></div><div class="ttdeci">string CustomOrderNumber</div><div class="ttdef"><b>Definition:</b> AffiliatedOrderModel.cs:17</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a0ed21cb24ca7119ec8071987d2aa2adf"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a0ed21cb24ca7119ec8071987d2aa2adf">Nop.Web.Areas.Admin.Models.Orders.OrderShippingExclTax</a></div><div class="ttdeci">string OrderShippingExclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:86</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a15a56c635eb54e3099ac11ae66467d20"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a15a56c635eb54e3099ac11ae66467d20">Nop.Web.Areas.Admin.Models.Orders.CardExpirationMonth</a></div><div class="ttdeci">string CardExpirationMonth</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:164</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a19b2727c8203affecc07ecdd64147303"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a19b2727c8203affecc07ecdd64147303">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodSystemName</a></div><div class="ttdeci">string PaymentMethodSystemName</div><div class="ttdef"><b>Definition:</b> OrderSearchModel.cs:54</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a27b8b85278182a0aedf5b41a2877f989"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a27b8b85278182a0aedf5b41a2877f989">Nop.Web.Areas.Admin.Models.Orders.OrderSubtotalExclTax</a></div><div class="ttdeci">string OrderSubtotalExclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:78</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a2be99ac6ad214361b9bb1a2969500d6d"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2be99ac6ad214361b9bb1a2969500d6d">Nop.Web.Areas.Admin.Models.Orders.OrderShippingInclTax</a></div><div class="ttdeci">string OrderShippingInclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:84</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a2cb529f23ef9494c6ad93227d931d49a"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2cb529f23ef9494c6ad93227d931d49a">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodAdditionalFeeExclTax</a></div><div class="ttdeci">string PaymentMethodAdditionalFeeExclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:90</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a33a7985c5dfd1d8619cfc7eafee96f12"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a33a7985c5dfd1d8619cfc7eafee96f12">Nop.Web.Areas.Admin.Models.Orders.CardType</a></div><div class="ttdeci">string CardType</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:156</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a369dc734eb2683217a7463c2025cba84"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a369dc734eb2683217a7463c2025cba84">Nop.Web.Areas.Admin.Models.Orders.OrderSubtotalInclTax</a></div><div class="ttdeci">string OrderSubtotalInclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:76</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a4245cae077ca63a7bc9cccb09d1578c1"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4245cae077ca63a7bc9cccb09d1578c1">Nop.Web.Areas.Admin.Models.Orders.TaxRates</a></div><div class="ttdeci">TaxRates</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:21</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a4cbdc5598e4179bc160384d84fcb941e"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4cbdc5598e4179bc160384d84fcb941e">Nop.Web.Areas.Admin.Models.Orders.AllowStoringCreditCardNumber</a></div><div class="ttdeci">bool AllowStoringCreditCardNumber</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:154</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a4d23e178ceec11bd02e628919d464ffe"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4d23e178ceec11bd02e628919d464ffe">Nop.Web.Areas.Admin.Models.Orders.CardName</a></div><div class="ttdeci">string CardName</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:158</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a4e7042e8ee178a98198afaa4d5456f87"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4e7042e8ee178a98198afaa4d5456f87">Nop.Web.Areas.Admin.Models.Orders.AuthorizationTransactionId</a></div><div class="ttdeci">string AuthorizationTransactionId</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:170</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a5ef52aba819cdceea8fe783a559eae9d"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5ef52aba819cdceea8fe783a559eae9d">Nop.Web.Areas.Admin.Models.Orders.OrderSubTotalDiscountExclTax</a></div><div class="ttdeci">string OrderSubTotalDiscountExclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:82</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a76625ebf1cce0a6a27378e13b633edbe"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a76625ebf1cce0a6a27378e13b633edbe">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodAdditionalFeeInclTax</a></div><div class="ttdeci">string PaymentMethodAdditionalFeeInclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:88</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a7cd00a4786b83cb99a0936107e5744e2"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a7cd00a4786b83cb99a0936107e5744e2">Nop.Web.Areas.Admin.Models.Orders.PickupInStore</a></div><div class="ttdeci">bool PickupInStore</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:178</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a958efcafb37becc2c1d33168c0ba32b5"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a958efcafb37becc2c1d33168c0ba32b5">Nop.Web.Areas.Admin.Models.Orders.CustomerIp</a></div><div class="ttdeci">string CustomerIp</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:58</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a972675175913d0ea5fcba0ac710eb980"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a972675175913d0ea5fcba0ac710eb980">Nop.Web.Areas.Admin.Models.Orders.CardCvv2</a></div><div class="ttdeci">string CardCvv2</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:162</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_aa3307d18d8650265adca9c21e5e48011"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aa3307d18d8650265adca9c21e5e48011">Nop.Web.Areas.Admin.Models.Orders.CaptureTransactionId</a></div><div class="ttdeci">string CaptureTransactionId</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:172</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ac030142457f0ea1f838bb620e2340d9e"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ac030142457f0ea1f838bb620e2340d9e">Nop.Web.Areas.Admin.Models.Orders.VatNumber</a></div><div class="ttdeci">string VatNumber</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:197</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ad0b14314d1457baa77ec2d2eaaafc3e4"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad0b14314d1457baa77ec2d2eaaafc3e4">Nop.Web.Areas.Admin.Models.Orders.CardExpirationYear</a></div><div class="ttdeci">string CardExpirationYear</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:166</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ad38a141c1fdab1cfc0adf4ba1a906b66"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad38a141c1fdab1cfc0adf4ba1a906b66">Nop.Web.Areas.Admin.Models.Orders.AffiliateId</a></div><div class="ttdeci">int AffiliateId</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:64</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_ae6fcac7c96b0de60940b9e6ab9f9124f"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae6fcac7c96b0de60940b9e6ab9f9124f">Nop.Web.Areas.Admin.Models.Orders.OrderSubTotalDiscountInclTax</a></div><div class="ttdeci">string OrderSubTotalDiscountInclTax</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:80</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_af0d943594f78c1eb0ab1652c46c13f97"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0d943594f78c1eb0ab1652c46c13f97">Nop.Web.Areas.Admin.Models.Orders.SubscriptionTransactionId</a></div><div class="ttdeci">string SubscriptionTransactionId</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:174</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_aff5a8b4a0d7b0889d56af1d9075d6b60"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aff5a8b4a0d7b0889d56af1d9075d6b60">Nop.Web.Areas.Admin.Models.Orders.RefundedAmount</a></div><div class="ttdeci">string RefundedAmount</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:105</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_models_1_1_shopping_cart_html_ac3319f6afccb6ac1cc0a2dfdc766a2c9"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_models_1_1_shopping_cart.html#ac3319f6afccb6ac1cc0a2dfdc766a2c9">Nop.Web.Models.ShoppingCart.ShippingRateComputationMethodSystemName</a></div><div class="ttdeci">string ShippingRateComputationMethodSystemName</div><div class="ttdef"><b>Definition:</b> EstimateShippingModel.cs:50</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab8773893cfe0dfd2f8ae2c17cd868325">Nop.Services.Orders.OrderProcessingService._customNumberFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a935fb408a00bf0f0c44151f1f87beb96">Nop.Services.Orders.OrderProcessingService._encryptionService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a637b49bb3285d8244c1ee304e59a3b3f">Nop.Services.Orders.OrderProcessingService._rewardPointService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85950a3b9289d679c1f24a07dc5b2610">Nop.Services.Orders.OrderProcessingService._webHelper</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html#a43b1fe16836f76602bf85aad1cef602e">Nop.Services.Orders.IRewardPointService.AddRewardPointsHistoryEntryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a0b138a24bae3cfc7575a89ae226371b3">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.AffiliateId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad38a141c1fdab1cfc0adf4ba1a906b66">Nop.Web.Areas.Admin.Models.Orders.AffiliateId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#aeaac974593f572c4751da3f2e63903c3">Nop.Services.Payments.ProcessPaymentResult.AllowStoringCreditCardNumber</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4cbdc5598e4179bc160384d84fcb941e">Nop.Web.Areas.Admin.Models.Orders.AllowStoringCreditCardNumber</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a6d4d375f3c510aae15235496c3aa1173">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionCode</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a51354ebec6390fd8a228ca2bdb394a3c">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4e7042e8ee178a98198afaa4d5456f87">Nop.Web.Areas.Admin.Models.Orders.AuthorizationTransactionId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69a4cbcd8a1b537c8aef9436e5605bde">Nop.Services.Payments.ProcessPaymentResult.AuthorizationTransactionResult</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a72967b790f33b9dcbde118003879f0a5">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.BillingAddress</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a40b8566eff1e6292779139e763a6de60">Nop.Services.Payments.ProcessPaymentResult.CaptureTransactionId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aa3307d18d8650265adca9c21e5e48011">Nop.Web.Areas.Admin.Models.Orders.CaptureTransactionId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a200af0190735043c3dbf323a5ca88500">Nop.Services.Payments.ProcessPaymentResult.CaptureTransactionResult</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a972675175913d0ea5fcba0ac710eb980">Nop.Web.Areas.Admin.Models.Orders.CardCvv2</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a15a56c635eb54e3099ac11ae66467d20">Nop.Web.Areas.Admin.Models.Orders.CardExpirationMonth</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ad0b14314d1457baa77ec2d2eaaafc3e4">Nop.Web.Areas.Admin.Models.Orders.CardExpirationYear</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4d23e178ceec11bd02e628919d464ffe">Nop.Web.Areas.Admin.Models.Orders.CardName</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_payments_1_1_manual_1_1_models.html#a49f2efcb95e8b244233e69399e080d83">Nop.Plugin.Payments.Manual.Models.CardNumber</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a33a7985c5dfd1d8619cfc7eafee96f12">Nop.Web.Areas.Admin.Models.Orders.CardType</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a204e707540c7cc4bb83e937be7ea17bc">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CheckoutAttributeDescription</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a875cf82ea29aa8c58a81a2adaa27b8eb">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CheckoutAttributesXml</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#aadfbc068b0bebb5efa80f78761514718">Nop.Services.Payments.ProcessPaymentRequest.CreditCardCvv2</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#afedf71f266ca76f85103f39f562ce25d">Nop.Services.Payments.ProcessPaymentRequest.CreditCardExpireMonth</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a84d44ed9264c203461f1ed2f56545b2c">Nop.Services.Payments.ProcessPaymentRequest.CreditCardExpireYear</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ac8879ed8814db958715fe5b4ed448201">Nop.Services.Payments.ProcessPaymentRequest.CreditCardName</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#abd502ed34204ecf609c94cb6a0ef7687">Nop.Services.Payments.ProcessPaymentRequest.CreditCardNumber</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#ab48193c8c137367f786fca3c932dac3e">Nop.Services.Payments.ProcessPaymentRequest.CreditCardType</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a247506603c4f7d9449a5682f90cecd7d">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.Customer</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#aa0337f4f08d2571cd7de1f0f63f5b53d">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CustomerCurrencyCode</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a2925c6234570e5cd83848b3c58d38d27">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CustomerCurrencyRate</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">Nop.Plugin.Tax.Avalara.Models.Log.CustomerId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a958efcafb37becc2c1d33168c0ba32b5">Nop.Web.Areas.Admin.Models.Orders.CustomerIp</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a643d2c9fa4ee13b7d5aa8efa648494f9">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CustomerLanguage</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a473acd5cf26b0c7c623ccebf249deed5">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.CustomerTaxDisplayType</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a49b7abe66f7cb9548b6aa391768dbae4">Nop.Web.Areas.Admin.Models.Affiliates.CustomOrderNumber</a>, <a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html#a26be40e348702524d57ed53debe6f875">Nop.Services.Security.IEncryptionService.EncryptText()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html#a1f48037fc9293ec1a925228ab16749fc">Nop.Services.Orders.ICustomNumberFormatter.GenerateOrderCustomNumber()</a>, <a class="el" href="interface_nop_1_1_core_1_1_i_web_helper.html#ac1757af7d7a624641c0eb47817adf610">Nop.Core.IWebHelper.GetCurrentIpAddress()</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#a1692ed1ef503fa2ad4385d8239234b3b">Nop.Services.Payments.IPaymentService.GetMaskedCreditCardNumber()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">Nop.Services.Common.IAddressService.InsertAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a3b3c164806463d27db20dbc85ea3a4b0">Nop.Services.Orders.IOrderService.InsertOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a15069a181038a00f7c442f750cde4e78">Nop.Services.Payments.ProcessPaymentResult.NewPaymentStatus</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a0a0115fc29a6ae4087012408fb091c05">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderDiscountAmount</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1ad6e75bc8d6088bdd0ce3d710e3ee89">Nop.Services.Payments.ProcessPaymentRequest.OrderGuid</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a9b3018a66cd7b222ad19d2de14e2466b">Nop.Web.Areas.Admin.Models.Orders.OrderGuid</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a0ed21cb24ca7119ec8071987d2aa2adf">Nop.Web.Areas.Admin.Models.Orders.OrderShippingExclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2be99ac6ad214361b9bb1a2969500d6d">Nop.Web.Areas.Admin.Models.Orders.OrderShippingInclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a221ffc045872f21e5218aa7f0af64cf0">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderShippingTotalExclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#ad5c6db822bcdbf66c3c11b2103274aa0">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderShippingTotalInclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a7248c9da7fad2da4ddec0458af2950a0">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderSubTotalDiscountExclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a5ef52aba819cdceea8fe783a559eae9d">Nop.Web.Areas.Admin.Models.Orders.OrderSubTotalDiscountExclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a989b5b76030ff81512f9e9169e785a2b">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderSubTotalDiscountInclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ae6fcac7c96b0de60940b9e6ab9f9124f">Nop.Web.Areas.Admin.Models.Orders.OrderSubTotalDiscountInclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#aa914411dbb71d19a2d0d7f5e4fac43cd">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderSubTotalExclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a27b8b85278182a0aedf5b41a2877f989">Nop.Web.Areas.Admin.Models.Orders.OrderSubtotalExclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a76abb7f8ac51b9f5c9a77d4526dd7f42">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderSubTotalInclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a369dc734eb2683217a7463c2025cba84">Nop.Web.Areas.Admin.Models.Orders.OrderSubtotalInclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#ab107fdb0f42a5ad2108f6deb155dd008">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderTaxTotal</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a9b72e8d8e6ebe7dd909d5302654e5ee5">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.OrderTotal</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_affiliates.html#a0e320952bc0db6909377932bdb257f5a">Nop.Web.Areas.Admin.Models.Affiliates.OrderTotal</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#acdb11cb30ccf2fb57a69848313dda97a">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.PaymentAdditionalFeeExclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#af5951139fe15df19998443b2bcbc8e12">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.PaymentAdditionalFeeInclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a2cb529f23ef9494c6ad93227d931d49a">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodAdditionalFeeExclTax</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a76625ebf1cce0a6a27378e13b633edbe">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodAdditionalFeeInclTax</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a6929faec75eea9a7ee1af7ad7ed88813">Nop.Services.Payments.ProcessPaymentRequest.PaymentMethodSystemName</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a19b2727c8203affecc07ecdd64147303">Nop.Web.Areas.Admin.Models.Orders.PaymentMethodSystemName</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a919c5edceb6c5975e1fb69ce5db75f87">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.PickupAddress</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#aaa19737ef315d25941b4f18c5b8b795e">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.PickupInStore</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a7cd00a4786b83cb99a0936107e5744e2">Nop.Web.Areas.Admin.Models.Orders.PickupInStore</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#ab7dda22d6e857171c892a045dbfa0768">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.RedeemedRewardPoints</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a94ae945c6535bf188f8556016d20d0c6">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.RedeemedRewardPointsAmount</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#aff5a8b4a0d7b0889d56af1d9075d6b60">Nop.Web.Areas.Admin.Models.Orders.RefundedAmount</a>, <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#ad3b6aafb6be58943f50971afab659d51">Nop.Services.Payments.IPaymentService.SerializeCustomValues()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a89fd4991eb48d8df3d169b0eeae62862">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.ShippingAddress</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a502afda35fd61f0053bd460f3a3bd9a8">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.ShippingMethodName</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a002ae00b381f8421f6f8ac88091994a4">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.ShippingRateComputationMethodSystemName</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_shopping_cart.html#ac3319f6afccb6ac1cc0a2dfdc766a2c9">Nop.Web.Models.ShoppingCart.ShippingRateComputationMethodSystemName</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a24c4e7d33f7bf788c018f011eba21780">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.ShippingStatus</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_request.html#a1734b4d0645df9858d9e4940dfdafb58">Nop.Services.Payments.ProcessPaymentRequest.StoreId</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">Nop.Plugin.Pickup.PickupInStore.Models.StoreId</a>, <a class="el" href="class_nop_1_1_services_1_1_payments_1_1_process_payment_result.html#a69f79e64590fbf7733315cb9d4d83e3c">Nop.Services.Payments.ProcessPaymentResult.SubscriptionTransactionId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#af0d943594f78c1eb0ab1652c46c13f97">Nop.Web.Areas.Admin.Models.Orders.SubscriptionTransactionId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#afaf5c2ee40b3491adb748526ff40533e">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.TaxRates</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a4245cae077ca63a7bc9cccb09d1578c1">Nop.Web.Areas.Admin.Models.Orders.TaxRates</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a5e3102e7df9c920f1d3aa72f26502fd4">Nop.Services.Customers.ICustomerService.UpdateCustomerAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service_1_1_place_order_container.html#a2a84f3aa4bcdd8a8be6003565777a4b4">Nop.Services.Orders.OrderProcessingService.PlaceOrderContainer.VatNumber</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#ac030142457f0ea1f838bb620e2340d9e">Nop.Web.Areas.Admin.Models.Orders.VatNumber</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a11fe03f64d9156620bc0611240669287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11fe03f64d9156620bc0611240669287">&#9670;&nbsp;</a></span>SendNotificationsAndSaveNotesAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send "order placed" notifications and save order notes </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="comment">//notes, messages</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">_workContext</a>.<a class="code" href="interface_nop_1_1_core_1_1_i_work_context.html#a14a0153b6c715817d92ce76ca6e06075">OriginalCustomerIfImpersonated</a> != <span class="keyword">null</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                ? $<span class="stringliteral">&quot;Order placed by a store owner (&#39;{_workContext.OriginalCustomerIfImpersonated.Email}&#39;. ID = {_workContext.OriginalCustomerIfImpersonated.Id}) impersonating the customer.&quot;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                : <span class="stringliteral">&quot;Order placed&quot;</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="comment">//send email notifications</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            var orderPlacedStoreOwnerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a2ccbd417258b0a212549c025a0aaf33d">SendOrderPlacedStoreOwnerNotificationAsync</a>(order, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span> (orderPlacedStoreOwnerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order placed\&quot; email (to store owner) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPlacedStoreOwnerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            var orderPlacedAttachmentFilePath = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5d63734eed35567cfa5944d0f66d5438">AttachPdfInvoiceToOrderPlacedEmail</a> ?</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">_pdfService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">PrintOrderToPdfAsync</a>(order)) : <span class="keyword">null</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            var orderPlacedAttachmentFileName = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5d63734eed35567cfa5944d0f66d5438">AttachPdfInvoiceToOrderPlacedEmail</a> ?</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="stringliteral">&quot;order.pdf&quot;</span> : <span class="keyword">null</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            var orderPlacedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                .<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a4b3ea5193072e3b846068c67979d13e8">SendOrderPlacedCustomerNotificationAsync</a>(order, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>, orderPlacedAttachmentFilePath, orderPlacedAttachmentFileName);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">if</span> (orderPlacedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order placed\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPlacedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            var vendors = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">GetVendorsInOrderAsync</a>(order);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keywordflow">foreach</span> (var vendor <span class="keywordflow">in</span> vendors)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                var orderPlacedVendorNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ad2f775d10f2111477357c52be0c9e158">SendOrderPlacedVendorNotificationAsync</a>(order, vendor, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="keywordflow">if</span> (orderPlacedVendorNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order placed\&quot; email (to vendor) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPlacedVendorNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#ae01165473b03ae2c517710de69734ba1">AffiliateId</a> == 0)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            var orderPlacedAffiliateNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae5d55663800ba1633223838d0e4010f4">SendOrderPlacedAffiliateNotificationAsync</a>(order, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">_localizationSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">DefaultAdminLanguageId</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">if</span> (orderPlacedAffiliateNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order placed\&quot; email (to affiliate) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderPlacedAffiliateNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a5d63734eed35567cfa5944d0f66d5438"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5d63734eed35567cfa5944d0f66d5438">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderPlacedEmail</a></div><div class="ttdeci">bool AttachPdfInvoiceToOrderPlacedEmail</div><div class="ttdoc">Gets or sets a value indicating we should attach PDF invoice to &quot;Order placed&quot; email</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:84</div></div>
<div class="ttc" id="ainterface_nop_1_1_core_1_1_i_work_context_html_a14a0153b6c715817d92ce76ca6e06075"><div class="ttname"><a href="interface_nop_1_1_core_1_1_i_work_context.html#a14a0153b6c715817d92ce76ca6e06075">Nop.Core.IWorkContext.OriginalCustomerIfImpersonated</a></div><div class="ttdeci">Customer OriginalCustomerIfImpersonated</div><div class="ttdoc">Gets the original customer (in case the current one is impersonated)</div><div class="ttdef"><b>Definition:</b> IWorkContext.cs:31</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a2ccbd417258b0a212549c025a0aaf33d"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a2ccbd417258b0a212549c025a0aaf33d">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedStoreOwnerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPlacedStoreOwnerNotificationAsync(Order order, int languageId)</div><div class="ttdoc">Sends an order placed notification to a store owner</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a4b3ea5193072e3b846068c67979d13e8"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a4b3ea5193072e3b846068c67979d13e8">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPlacedCustomerNotificationAsync(Order order, int languageId, string attachmentFilePath=null, string attachmentFileName=null)</div><div class="ttdoc">Sends an order placed notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_ad2f775d10f2111477357c52be0c9e158"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ad2f775d10f2111477357c52be0c9e158">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedVendorNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPlacedVendorNotificationAsync(Order order, Vendor vendor, int languageId)</div><div class="ttdoc">Sends an order placed notification to a vendor</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_ae5d55663800ba1633223838d0e4010f4"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae5d55663800ba1633223838d0e4010f4">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedAffiliateNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderPlacedAffiliateNotificationAsync(Order order, int languageId)</div><div class="ttdoc">Sends an order placed notification to an affiliate</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac23fbd6e69641baba3a5e4a2b72ba7da">Nop.Services.Orders.OrderProcessingService._localizationSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">Nop.Services.Orders.OrderProcessingService._pdfService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aad13ab85dbf2eeff57a0e908475117cf">Nop.Services.Orders.OrderProcessingService._workContext</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5d63734eed35567cfa5944d0f66d5438">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderPlacedEmail</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html#aad81758f66176a496313e75eadb67aea">Nop.Core.Domain.Localization.LocalizationSettings.DefaultAdminLanguageId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync()</a>, <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html#a14a0153b6c715817d92ce76ca6e06075">Nop.Core.IWorkContext.OriginalCustomerIfImpersonated</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">Nop.Services.Common.IPdfService.PrintOrderToPdfAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ae5d55663800ba1633223838d0e4010f4">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedAffiliateNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a4b3ea5193072e3b846068c67979d13e8">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a2ccbd417258b0a212549c025a0aaf33d">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedStoreOwnerNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ad2f775d10f2111477357c52be0c9e158">Nop.Services.Messages.IWorkflowMessageService.SendOrderPlacedVendorNotificationAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="ab640dd113d78cc91758e7bd2e05c5ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab640dd113d78cc91758e7bd2e05c5ec5">&#9670;&nbsp;</a></span>SetActivatedValueForPurchasedGiftCardsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>activate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set IsActivated value for purchase gift cards for particular order </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">activate</td><td>A value indicating whether to activate gift cards; true - activate, false - deactivate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            var giftCards = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a40af2a966bf527b2b167531fba8d3d21">GetAllGiftCardsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>, isGiftCardActivated: !activate);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">foreach</span> (var gc <span class="keywordflow">in</span> giftCards)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <span class="keywordflow">if</span> (activate)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    <span class="comment">//activate</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    var isRecipientNotified = gc.IsRecipientNotified;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    <span class="keywordflow">if</span> (gc.GiftCardType == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_catalog.html#a0e151df37c0bce5b7c5b587fa8fe9abf">GiftCardType</a>.Virtual)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                        <span class="comment">//send email for virtual gift card</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(gc.RecipientEmail) &amp;&amp;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                            !<span class="keywordtype">string</span>.IsNullOrEmpty(gc.SenderEmail))</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                        {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                            var customerLang = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">GetLanguageByIdAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>) ??</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                                               (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">_languageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#a7355c70b959779af87be67dbc90274a2">GetAllLanguagesAsync</a>()).FirstOrDefault();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            <span class="keywordflow">if</span> (customerLang == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;No languages could be loaded&quot;</span>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                            var queuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a886fe1caebc525ae25b9bfeaab158d26">SendGiftCardNotificationAsync</a>(gc, customerLang.Id);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                            <span class="keywordflow">if</span> (queuedEmailIds.Any())</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                isRecipientNotified = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                    }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    gc.IsGiftCardActivated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    gc.IsRecipientNotified = isRecipientNotified;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a142debdfc7a8cc274b81ad1ed9cf4e42">UpdateGiftCardAsync</a>(gc);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    <span class="comment">//deactivate</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    gc.IsGiftCardActivated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">_giftCardService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a142debdfc7a8cc274b81ad1ed9cf4e42">UpdateGiftCardAsync</a>(gc);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_localization_1_1_i_language_service_html_a7355c70b959779af87be67dbc90274a2"><div class="ttname"><a href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#a7355c70b959779af87be67dbc90274a2">Nop.Services.Localization.ILanguageService.GetAllLanguagesAsync</a></div><div class="ttdeci">Task&lt; IList&lt; Language &gt; &gt; GetAllLanguagesAsync(bool showHidden=false, int storeId=0)</div><div class="ttdoc">Gets all languages</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a886fe1caebc525ae25b9bfeaab158d26"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a886fe1caebc525ae25b9bfeaab158d26">Nop.Services.Messages.IWorkflowMessageService.SendGiftCardNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendGiftCardNotificationAsync(GiftCard giftCard, int languageId)</div><div class="ttdoc">Sends a gift card notification</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_a142debdfc7a8cc274b81ad1ed9cf4e42"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a142debdfc7a8cc274b81ad1ed9cf4e42">Nop.Services.Orders.IGiftCardService.UpdateGiftCardAsync</a></div><div class="ttdeci">Task UpdateGiftCardAsync(GiftCard giftCard)</div><div class="ttdoc">Updates the gift card</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service_html_a40af2a966bf527b2b167531fba8d3d21"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a40af2a966bf527b2b167531fba8d3d21">Nop.Services.Orders.IGiftCardService.GetAllGiftCardsAsync</a></div><div class="ttdeci">Task&lt; IPagedList&lt; GiftCard &gt; &gt; GetAllGiftCardsAsync(int? purchasedWithOrderId=null, int? usedWithOrderId=null, DateTime? createdFromUtc=null, DateTime? createdToUtc=null, bool? isGiftCardActivated=null, string giftCardCouponCode=null, string recipientName=null, int pageIndex=0, int pageSize=int.MaxValue)</div><div class="ttdoc">Gets all gift cards</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0283d452f56e8cc530632d5f24147f5f">Nop.Services.Orders.OrderProcessingService._giftCardService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a86507ce9f96e887f327064723d350b">Nop.Services.Orders.OrderProcessingService._languageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a40af2a966bf527b2b167531fba8d3d21">Nop.Services.Orders.IGiftCardService.GetAllGiftCardsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#a7355c70b959779af87be67dbc90274a2">Nop.Services.Localization.ILanguageService.GetAllLanguagesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html#ab45dfd47ef73657b418113f1767da185">Nop.Services.Localization.ILanguageService.GetLanguageByIdAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a886fe1caebc525ae25b9bfeaab158d26">Nop.Services.Messages.IWorkflowMessageService.SendGiftCardNotificationAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html#a142debdfc7a8cc274b81ad1ed9cf4e42">Nop.Services.Orders.IGiftCardService.UpdateGiftCardAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="afa36dec6110e6877538e59656b5fbc67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa36dec6110e6877538e59656b5fbc67">&#9670;&nbsp;</a></span>SetOrderStatusAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>notifyCustomer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets an order status </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
    <tr><td class="paramname">os</td><td>New order status</td></tr>
    <tr><td class="paramname">notifyCustomer</td><td>True to notify customer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            var prevOrderStatus = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <span class="keywordflow">if</span> (prevOrderStatus == os)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="comment">//set and save new order status</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1083e0aad7ea7c52eca0023e127f1233">OrderStatusId</a> = (int)os;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="comment">//order notes, notifications</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Order status has been changed to {await _localizationService.GetLocalizedEnumAsync(os)}&quot;</span>);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">if</span> (prevOrderStatus != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete &amp;&amp;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                os == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                &amp;&amp; notifyCustomer)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="comment">//notification</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                var orderCompletedAttachmentFilePath = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#abae14a8513c6a6cbf3037e5fe1e80f76">AttachPdfInvoiceToOrderCompletedEmail</a> ?</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">_pdfService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">PrintOrderToPdfAsync</a>(order) : <span class="keyword">null</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                var orderCompletedAttachmentFileName = <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#abae14a8513c6a6cbf3037e5fe1e80f76">AttachPdfInvoiceToOrderCompletedEmail</a> ?</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    <span class="stringliteral">&quot;order.pdf&quot;</span> : <span class="keyword">null</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                var orderCompletedCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    .<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a567937a83fd27864a0fd424023977228">SendOrderCompletedCustomerNotificationAsync</a>(order, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>, orderCompletedAttachmentFilePath,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    orderCompletedAttachmentFileName);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                <span class="keywordflow">if</span> (orderCompletedCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order completed\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderCompletedCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keywordflow">if</span> (prevOrderStatus != <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled &amp;&amp;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                os == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                &amp;&amp; notifyCustomer)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="comment">//notification</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                var orderCancelledCustomerNotificationQueuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab5dbf93ecfb78522fc0ae46084adf56c">SendOrderCancelledCustomerNotificationAsync</a>(order, order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">CustomerLanguageId</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="keywordflow">if</span> (orderCancelledCustomerNotificationQueuedEmailIds.Any())</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Order cancelled\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, orderCancelledCustomerNotificationQueuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="comment">//reward points</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete) </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">AwardRewardPointsAsync</a>(order);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keywordflow">if</span> (order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled) </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">ReduceRewardPointsAsync</a>(order);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="comment">//gift cards activation</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a2703aef31def2e4f647441333e3d5cf4">ActivateGiftCardsAfterCompletingOrder</a> &amp;&amp; order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Complete) </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">SetActivatedValueForPurchasedGiftCardsAsync</a>(order, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="comment">//gift cards deactivation</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5394f788aae88416fa68ff264f8a33da">DeactivateGiftCardsAfterCancellingOrder</a> &amp;&amp; order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">OrderStatus</a> == <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#a110e048090478f8f42845b47c90139e8">OrderStatus</a>.Cancelled) </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">SetActivatedValueForPurchasedGiftCardsAsync</a>(order, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_html_a1083e0aad7ea7c52eca0023e127f1233"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1083e0aad7ea7c52eca0023e127f1233">Nop.Core.Domain.Orders.Order.OrderStatusId</a></div><div class="ttdeci">int OrderStatusId</div><div class="ttdoc">Gets or sets an order status identifier</div><div class="ttdef"><b>Definition:</b> Order.cs:54</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a2703aef31def2e4f647441333e3d5cf4"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a2703aef31def2e4f647441333e3d5cf4">Nop.Core.Domain.Orders.OrderSettings.ActivateGiftCardsAfterCompletingOrder</a></div><div class="ttdeci">bool ActivateGiftCardsAfterCompletingOrder</div><div class="ttdoc">Gets or sets a value indicating whether to activate related gift cards after completing the order</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:129</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a5394f788aae88416fa68ff264f8a33da"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5394f788aae88416fa68ff264f8a33da">Nop.Core.Domain.Orders.OrderSettings.DeactivateGiftCardsAfterCancellingOrder</a></div><div class="ttdeci">bool DeactivateGiftCardsAfterCancellingOrder</div><div class="ttdoc">Gets or sets a value indicating whether to deactivate related gift cards after cancelling the order</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:134</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_abae14a8513c6a6cbf3037e5fe1e80f76"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#abae14a8513c6a6cbf3037e5fe1e80f76">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderCompletedEmail</a></div><div class="ttdeci">bool AttachPdfInvoiceToOrderCompletedEmail</div><div class="ttdoc">Gets or sets a value indicating we should attach PDF invoice to &quot;Order completed&quot; email</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:94</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ae5834b1db8b3e55653eb039c0bbd3be9"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync</a></div><div class="ttdeci">virtual async Task AwardRewardPointsAsync(Order order)</div><div class="ttdoc">Award (earn) reward points (for placing a new order)</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:906</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_a567937a83fd27864a0fd424023977228"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a567937a83fd27864a0fd424023977228">Nop.Services.Messages.IWorkflowMessageService.SendOrderCompletedCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderCompletedCustomerNotificationAsync(Order order, int languageId, string attachmentFilePath=null, string attachmentFileName=null)</div><div class="ttdoc">Sends an order completed notification to a customer</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_ab5dbf93ecfb78522fc0ae46084adf56c"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab5dbf93ecfb78522fc0ae46084adf56c">Nop.Services.Messages.IWorkflowMessageService.SendOrderCancelledCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendOrderCancelledCustomerNotificationAsync(Order order, int languageId)</div><div class="ttdoc">Sends an order cancelled notification to a customer</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4b921e2382b2d0f35d5fd9d378f62668">Nop.Services.Orders.OrderProcessingService._pdfService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a2703aef31def2e4f647441333e3d5cf4">Nop.Core.Domain.Orders.OrderSettings.ActivateGiftCardsAfterCompletingOrder</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#abae14a8513c6a6cbf3037e5fe1e80f76">Nop.Core.Domain.Orders.OrderSettings.AttachPdfInvoiceToOrderCompletedEmail</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afac2b603ee3b2ff601163ed07164694e">Nop.Core.Domain.Orders.Order.CustomerLanguageId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a5394f788aae88416fa68ff264f8a33da">Nop.Core.Domain.Orders.OrderSettings.DeactivateGiftCardsAfterCancellingOrder</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1da26c037c2fa677811f7ae1b6748286">Nop.Core.Domain.Orders.Order.OrderStatus</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1083e0aad7ea7c52eca0023e127f1233">Nop.Core.Domain.Orders.Order.OrderStatusId</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html#abbeb84b271ab3e84f6f79ae4a9dc7b54">Nop.Services.Common.IPdfService.PrintOrderToPdfAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#ab5dbf93ecfb78522fc0ae46084adf56c">Nop.Services.Messages.IWorkflowMessageService.SendOrderCancelledCustomerNotificationAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#a567937a83fd27864a0fd424023977228">Nop.Services.Messages.IWorkflowMessageService.SendOrderCompletedCustomerNotificationAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="af368ffb978128f1a87ec3b4113c1e356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af368ffb978128f1a87ec3b4113c1e356">&#9670;&nbsp;</a></span>ShipAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.ShipAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html">Shipment</a>&#160;</td>
          <td class="paramname"><em>shipment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>notifyCustomer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a shipment </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">shipment</td><td>Shipment</td></tr>
    <tr><td class="paramname">notifyCustomer</td><td>True to notify customer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#aa9ba39e2a392745167361062c92e4563">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        {</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            <span class="keywordflow">if</span> (shipment == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(shipment));</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            var order = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">GetOrderByIdAsync</a>(shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">OrderId</a>);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Order cannot be loaded&quot;</span>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            <span class="keywordflow">if</span> (shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">ShippedDateUtc</a>.HasValue)</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;This shipment is already shipped&quot;</span>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;            shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">ShippedDateUtc</a> = DateTime.UtcNow;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ae875cc67fda49873b4bc67f45cb181ec">UpdateShipmentAsync</a>(shipment);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;            <span class="comment">//process products with &quot;Multiple warehouse&quot; support enabled</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            <span class="keywordflow">foreach</span> (var item <span class="keywordflow">in</span> await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">_shipmentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">GetShipmentItemsByShipmentIdAsync</a>(shipment.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>))</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">GetProductByOrderItemIdAsync</a>(item.OrderItemId);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                <span class="keywordflow">if</span> (product is <span class="keyword">null</span>)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#a5a4a6d6ffa4a2f81c0118fa2e305cc4e">BookReservedInventoryAsync</a>(product, item.WarehouseId, -item.Quantity,</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Admin.StockQuantityHistory.Messages.Ship&quot;</span>), shipment.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">OrderId</a>));</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            <span class="comment">//check whether we have more items to ship</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="keywordflow">if</span> (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aaf9783d7fd7a3d38bda26ecc870593b3">HasItemsToAddToShipmentAsync</a>(order) || await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#ad7ca9f12ae2d2f9c263c019ccbda45fa">HasItemsToShipAsync</a>(order))</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                order.ShippingStatusId = (int)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.PartiallyShipped;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                order.ShippingStatusId = (<span class="keywordtype">int</span>)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_shipping.html#a1dbf5d81e9b14f65a14f24436b374fae">ShippingStatus</a>.Shipped;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Shipment# {shipment.Id} has been sent&quot;</span>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="keywordflow">if</span> (notifyCustomer)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                <span class="comment">//notify customer</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                var queuedEmailIds = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">_workflowMessageService</a>.<a class="code" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#af6109b96faea71479bb8cf90a9c306cc">SendShipmentSentCustomerNotificationAsync</a>(shipment, order.CustomerLanguageId);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                <span class="keywordflow">if</span> (queuedEmailIds.Any())</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;\&quot;Shipped\&quot; email (to customer) has been queued. Queued email identifiers: {string.Join(&quot;</span>, <span class="stringliteral">&quot;, queuedEmailIds)}.&quot;</span>);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <span class="comment">//event</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishShipmentSentAsync(shipment);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        }</div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_catalog_1_1_i_product_service_html_a5a4a6d6ffa4a2f81c0118fa2e305cc4e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#a5a4a6d6ffa4a2f81c0118fa2e305cc4e">Nop.Services.Catalog.IProductService.BookReservedInventoryAsync</a></div><div class="ttdeci">Task BookReservedInventoryAsync(Product product, int warehouseId, int quantity, string message=&quot;&quot;)</div><div class="ttdoc">Book the reserved quantity</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service_html_af6109b96faea71479bb8cf90a9c306cc"><div class="ttname"><a href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#af6109b96faea71479bb8cf90a9c306cc">Nop.Services.Messages.IWorkflowMessageService.SendShipmentSentCustomerNotificationAsync</a></div><div class="ttdeci">Task&lt; IList&lt; int &gt; &gt; SendShipmentSentCustomerNotificationAsync(Shipment shipment, int languageId)</div><div class="ttdoc">Sends a shipment sent notification to a customer</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8acb96f997201c0543a6833cd3a304e7">Nop.Services.Orders.OrderProcessingService._shipmentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a34f4795b2175a1ff0af7828c284477df">Nop.Services.Orders.OrderProcessingService._workflowMessageService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#a5a4a6d6ffa4a2f81c0118fa2e305cc4e">Nop.Services.Catalog.IProductService.BookReservedInventoryAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a75bc6860ccdf693731b275018e462978">Nop.Services.Orders.IOrderService.GetOrderByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#a7feff9a701ac531db9f83037a0564b87">Nop.Services.Orders.IOrderService.GetProductByOrderItemIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ab6aa8c5c24fcd7f12da2c5be0aae16a1">Nop.Services.Shipping.IShipmentService.GetShipmentItemsByShipmentIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aaf9783d7fd7a3d38bda26ecc870593b3">Nop.Services.Orders.IOrderService.HasItemsToAddToShipmentAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#ad7ca9f12ae2d2f9c263c019ccbda45fa">Nop.Services.Orders.IOrderService.HasItemsToShipAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a8939e34989422aa12467f5a807a91e40">Nop.Core.Domain.Shipping.Shipment.OrderId</a>, <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html#af6109b96faea71479bb8cf90a9c306cc">Nop.Services.Messages.IWorkflowMessageService.SendShipmentSentCustomerNotificationAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipment.html#a5361dc61a7738d3cb3aaa07fdf3ef4b4">Nop.Core.Domain.Shipping.Shipment.ShippedDateUtc</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html#ae875cc67fda49873b4bc67f45cb181ec">Nop.Services.Shipping.IShipmentService.UpdateShipmentAsync()</a>.</p>

</div>
</div>
<a id="a598b25782d04f6afcb42582553bb84a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a598b25782d04f6afcb42582553bb84a2">&#9670;&nbsp;</a></span>UpdateOrderTotalsAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html">UpdateOrderParameters</a>&#160;</td>
          <td class="paramname"><em>updateOrderParameters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update order totals </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">updateOrderParameters</td><td>Parameters for the updating order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a76dac477bbaf0b3492af95b93e7cc499">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a91f24ca6cbaded8d2ad4d792ad383550">AutoUpdateOrderTotalsOnEditingOrder</a>)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            var updatedOrder = updateOrderParameters.UpdatedOrder;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            var updatedOrderItem = updateOrderParameters.UpdatedOrderItem;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <span class="comment">//restore shopping cart from order items</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            var (restoredCart, updatedShoppingCartItem) = await restoreShoppingCartAsync(updatedOrder, updatedOrderItem.Id);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            var itemDeleted = updatedShoppingCartItem is <span class="keyword">null</span>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            <span class="comment">//validate shopping cart for warnings</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            updateOrderParameters.Warnings.AddRange(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a23bee3e064339be31d645cf8d8763cd4">GetShoppingCartWarningsAsync</a>(restoredCart, <span class="keywordtype">string</span>.Empty, <span class="keyword">false</span>));</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            var customer = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">_customerService</a>.<a class="code" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">GetCustomerByIdAsync</a>(updatedOrder.CustomerId);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">if</span> (!itemDeleted)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                var product = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">_productService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">GetProductByIdAsync</a>(updatedShoppingCartItem.ProductId);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                updateOrderParameters.Warnings.AddRange(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">_shoppingCartService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a372f2e1d392903a70e272a1cfc5ed0e5">GetShoppingCartItemWarningsAsync</a>(customer, updatedShoppingCartItem.ShoppingCartType,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    product, updatedOrder.StoreId, updatedShoppingCartItem.AttributesXml, updatedShoppingCartItem.CustomerEnteredPrice,</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    updatedShoppingCartItem.RentalStartDateUtc, updatedShoppingCartItem.RentalEndDateUtc, updatedShoppingCartItem.Quantity, <span class="keyword">false</span>, updatedShoppingCartItem.Id));</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                updatedOrderItem.ItemWeight = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">_shippingService</a>.<a class="code" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html#aedf9c8bfb29a2b4f086dcf3fb4b85a5a">GetShoppingCartItemWeightAsync</a>(updatedShoppingCartItem);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                updatedOrderItem.OriginalProductCost = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">_priceCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html#a548db2ce044f290390e43a93bdb3140e">GetProductCostAsync</a>(product, updatedShoppingCartItem.AttributesXml);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                updatedOrderItem.AttributeDescription = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">_productAttributeFormatter</a>.<a class="code" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html#a1e2ece5017fc654445aef796ee0f5c43">FormatAttributesAsync</a>(product,</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                    updatedShoppingCartItem.AttributesXml, customer);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                <span class="comment">//gift cards</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">AddGiftCardsAsync</a>(product, updatedShoppingCartItem.AttributesXml, updatedShoppingCartItem.Quantity, updatedOrderItem, updatedOrderItem.UnitPriceExclTax);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#aa6b418ee1a57cc7122f1edf5a66e8e4e">UpdateOrderTotalsAsync</a>(updateOrderParameters, restoredCart);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="keywordflow">if</span> (updateOrderParameters.PickupPoint != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                updatedOrder.PickupInStore = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                var pickupAddress = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_common_1_1_address.html">Address</a></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a8dead30ac8b6c9929325dae406bc9ff5">Address1</a> = updateOrderParameters.PickupPoint.Address,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a41fd119446f105b297fde3d88d79d8b1">City</a> = updateOrderParameters.PickupPoint.City,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#aabdfd67c26d0ba001d2d0a49cee7d454">County</a> = updateOrderParameters.PickupPoint.County,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                    <a class="code" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#ade9e47c6ab2d9608a96bb049d71e80b2">CountryId</a> = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">_countryService</a>.<a class="code" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ab210ec12fa25e8566e7996696322acfd">GetCountryByTwoLetterIsoCodeAsync</a>(updateOrderParameters.PickupPoint.CountryCode))?.<a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a968ff99d09af9aec2bb20d13d463c147">Id</a>,</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a9125d4e9a486a66d6c2f526872ee08ac">ZipPostalCode</a> = updateOrderParameters.PickupPoint.ZipPostalCode,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                    CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                };</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">_addressService</a>.<a class="code" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">InsertAddressAsync</a>(pickupAddress);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                updatedOrder.PickupAddressId = pickupAddress.Id;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                var shippingMethod = !<span class="keywordtype">string</span>.IsNullOrEmpty(updateOrderParameters.PickupPoint.Name) ?</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                    <span class="keywordtype">string</span>.Format(await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Checkout.PickupPoints.Name&quot;</span>), updateOrderParameters.PickupPoint.Name) :</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">_localizationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">GetResourceAsync</a>(<span class="stringliteral">&quot;Checkout.PickupPoints.NullName&quot;</span>);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                updatedOrder.ShippingMethod = shippingMethod;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                updatedOrder.ShippingRateComputationMethodSystemName = updateOrderParameters.PickupPoint.ProviderSystemName;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(updatedOrder);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="comment">//discount usage history</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            var discountUsageHistoryForOrder = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a0473d241079dd560242837ac5c9f7460">GetAllDiscountUsageHistoryAsync</a>(<span class="keyword">null</span>, customer.Id, updatedOrder.Id);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">foreach</span> (var discount <span class="keywordflow">in</span> updateOrderParameters.AppliedDiscounts)</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                <span class="keywordflow">if</span> (discountUsageHistoryForOrder.Any(history =&gt; history.DiscountId == discount.Id))</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                var d = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">GetDiscountByIdAsync</a>(discount.Id);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                <span class="keywordflow">if</span> (d != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">_discountService</a>.<a class="code" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a71efd382f143d24db78abe78f04f134e">InsertDiscountUsageHistoryAsync</a>(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_discounts_1_1_discount_usage_history.html">DiscountUsageHistory</a></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                    {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#af041086ef7fd47ba975c04641acd8723">DiscountId</a> = d.Id,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                        <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">OrderId</a> = updatedOrder.Id,</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                        CreatedOnUtc = DateTime.UtcNow</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                    });</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(updatedOrder);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            async <a class="code" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;(List&lt;ShoppingCartItem&gt; restoredCart, <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> updatedShoppingCartItem)&gt; restoreShoppingCartAsync(<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a> order, <span class="keywordtype">int</span> updatedOrderItemId)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                <span class="keywordflow">if</span> (order is <span class="keyword">null</span>)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                var cart = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">GetOrderItemsAsync</a>(order.<a class="code" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Id</a>)).Select(item =&gt; <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a968ff99d09af9aec2bb20d13d463c147">Id</a> = item.Id,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">AttributesXml</a> = item.AttributesXml,</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                    <a class="code" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">CustomerId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">CustomerId</a>,</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">ProductId</a> = item.ProductId,</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Quantity</a> = item.Id == updatedOrderItemId ? updateOrderParameters.Quantity : item.Quantity,</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                    RentalEndDateUtc = item.RentalEndDateUtc,</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                    RentalStartDateUtc = item.RentalStartDateUtc,</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                    <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#ae2fb88620fcd3889e6e0504e7b18e806">ShoppingCartType</a> = <a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_orders.html#ae2fb88620fcd3889e6e0504e7b18e806">ShoppingCartType</a>.ShoppingCart,</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                    <a class="code" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">StoreId</a> = order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">StoreId</a></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                }).ToList();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                <span class="comment">//get shopping cart item which has been updated</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                var cartItem = cart.FirstOrDefault(shoppingCartItem =&gt; shoppingCartItem.Id == updatedOrderItemId);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                <span class="keywordflow">return</span> (cart, cartItem);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        }</div>
<div class="ttc" id="a_sendinblue_plugin_8cs_html_a9f49374e6bc76a6b5261e5c211d2e63d"><div class="ttname"><a href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a></div><div class="ttdeci">System.Threading.Tasks.Task Task</div><div class="ttdef"><b>Definition:</b> SendinbluePlugin.cs:15</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_a91f24ca6cbaded8d2ad4d792ad383550"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a91f24ca6cbaded8d2ad4d792ad383550">Nop.Core.Domain.Orders.OrderSettings.AutoUpdateOrderTotalsOnEditingOrder</a></div><div class="ttdeci">bool AutoUpdateOrderTotalsOnEditingOrder</div><div class="ttdoc">Gets or sets a value indicating whether automatically update order totals on editing an order in admi...</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:34</div></div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">Nop.Core.Domain.Orders.ShoppingCartItem</a></div><div class="ttdoc">Represents a shopping cart item</div><div class="ttdef"><b>Definition:</b> ShoppingCartItem.cs:9</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service_html_aa6b418ee1a57cc7122f1edf5a66e8e4e"><div class="ttname"><a href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#aa6b418ee1a57cc7122f1edf5a66e8e4e">Nop.Services.Orders.IOrderTotalCalculationService.UpdateOrderTotalsAsync</a></div><div class="ttdeci">Task UpdateOrderTotalsAsync(UpdateOrderParameters updateOrderParameters, IList&lt; ShoppingCartItem &gt; restoredCart)</div><div class="ttdoc">Update order totals</div></div>
<div class="ttc" id="anamespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders_html_a968ff99d09af9aec2bb20d13d463c147"><div class="ttname"><a href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a968ff99d09af9aec2bb20d13d463c147">Nop.Web.Areas.Admin.Models.Orders.Id</a></div><div class="ttdeci">override int Id</div><div class="ttdef"><b>Definition:</b> OrderModel.cs:39</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adeff3449bd42300b1f5277b5d4038059">Nop.Services.Orders.OrderProcessingService._addressService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aaf47b468edb2b5094a965595abef7180">Nop.Services.Orders.OrderProcessingService._countryService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a528f4227552c25da09510c9030bc9471">Nop.Services.Orders.OrderProcessingService._customerService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae3799d8d3ec560c2e825d188bcda1e5b">Nop.Services.Orders.OrderProcessingService._discountService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a523bf26abfaef915d5c034e4e0a811b5">Nop.Services.Orders.OrderProcessingService._localizationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a997713a565a6ac517f86ce46b6a05bbf">Nop.Services.Orders.OrderProcessingService._priceCalculationService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a37c365ad403e9ac6aa0f5557edb7f2fe">Nop.Services.Orders.OrderProcessingService._productAttributeFormatter</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a309d452cba4d881271ad2d24c7843dff">Nop.Services.Orders.OrderProcessingService._productService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0edda809b10ea29bfe00542d7306424f">Nop.Services.Orders.OrderProcessingService._shippingService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a964b7bb1015e5a6901aaf80e827969cd">Nop.Services.Orders.OrderProcessingService._shoppingCartService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#a8c8935d3d344abbcf443f78010e30607">Nop.Core.Domain.Shipping.PickupPoint.Address</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a8dead30ac8b6c9929325dae406bc9ff5">Nop.Web.Areas.Admin.Models.Common.Address1</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#ae45ef18dd721dd3c34b1c4eb15a5ca0c">Nop.Web.Areas.Admin.Models.Catalog.AttributesXml</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a91f24ca6cbaded8d2ad4d792ad383550">Nop.Core.Domain.Orders.OrderSettings.AutoUpdateOrderTotalsOnEditingOrder</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#a9bcf00dc894f9d2a280b552d1a2c1c18">Nop.Core.Domain.Shipping.PickupPoint.City</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a41fd119446f105b297fde3d88d79d8b1">Nop.Web.Areas.Admin.Models.Common.City</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#acfe14454faa467ac71b057523151cc54">Nop.Core.Domain.Shipping.PickupPoint.CountryCode</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_shipping_1_1_fixed_by_weight_by_total_1_1_models.html#ade9e47c6ab2d9608a96bb049d71e80b2">Nop.Plugin.Shipping.FixedByWeightByTotal.Models.CountryId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#aa64b45e5cc4cfacc37445aa1ceac1a97">Nop.Core.Domain.Shipping.PickupPoint.County</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#aabdfd67c26d0ba001d2d0a49cee7d454">Nop.Web.Areas.Admin.Models.Common.County</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#afc851a198d160f4084e1398b3b4892c3">Nop.Core.Domain.Orders.Order.CustomerId</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_tax_1_1_avalara_1_1_models_1_1_log.html#aaa4303994371e93df77abec6d473c7e8">Nop.Plugin.Tax.Avalara.Models.Log.CustomerId</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#af041086ef7fd47ba975c04641acd8723">Nop.Web.Areas.Admin.Models.Discounts.DiscountId</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html#a1e2ece5017fc654445aef796ee0f5c43">Nop.Services.Catalog.IProductAttributeFormatter.FormatAttributesAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a0473d241079dd560242837ac5c9f7460">Nop.Services.Discounts.IDiscountService.GetAllDiscountUsageHistoryAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html#ab210ec12fa25e8566e7996696322acfd">Nop.Services.Directory.ICountryService.GetCountryByTwoLetterIsoCodeAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html#a9d2dc587d116a6f656792c4f4cf22e09">Nop.Services.Customers.ICustomerService.GetCustomerByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a9697750465b8fa7893867cb73d358842">Nop.Services.Discounts.IDiscountService.GetDiscountByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aea8bd5179d4144f1fd3da8d17a761de2">Nop.Services.Orders.IOrderService.GetOrderItemsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html#ab448923cc8826840ac6cd1558a0f2a9d">Nop.Services.Catalog.IProductService.GetProductByIdAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html#a548db2ce044f290390e43a93bdb3140e">Nop.Services.Catalog.IPriceCalculationService.GetProductCostAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html#ac1ae5d2f3ddfea87ce1f780c9294656a">Nop.Services.Localization.ILocalizationService.GetResourceAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a372f2e1d392903a70e272a1cfc5ed0e5">Nop.Services.Orders.IShoppingCartService.GetShoppingCartItemWarningsAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html#aedf9c8bfb29a2b4f086dcf3fb4b85a5a">Nop.Services.Shipping.IShippingService.GetShoppingCartItemWeightAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html#a23bee3e064339be31d645cf8d8763cd4">Nop.Services.Orders.IShoppingCartService.GetShoppingCartWarningsAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_base_entity.html#a6908f7c042a024f82d7e7947e75bca53">Nop.Core.BaseEntity.Id</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_orders.html#a968ff99d09af9aec2bb20d13d463c147">Nop.Web.Areas.Admin.Models.Orders.Id</a>, <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html#a1faf9b7e4abdf2ab5a9f430c31c5e8e0">Nop.Services.Common.IAddressService.InsertAddressAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html#a71efd382f143d24db78abe78f04f134e">Nop.Services.Discounts.IDiscountService.InsertDiscountUsageHistoryAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#adbf5b2c211315ead246220445ac42ffe">Nop.Core.Domain.Shipping.PickupPoint.Name</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_discounts.html#acfc1f9bbdff6eb7524d793f0816abf27">Nop.Web.Areas.Admin.Models.Discounts.OrderId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html#a41860d50e45a3f9fb7e8a695c470fc48">Nop.Services.Orders.UpdateOrderParameters.PickupPoint</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a5f43f2b53838c9c8c34cf27f06f5e78c">Nop.Web.Areas.Admin.Models.Catalog.ProductId</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#aa73914c99ccb3f53d25c75f947545aa7">Nop.Core.Domain.Shipping.PickupPoint.ProviderSystemName</a>, <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_catalog.html#a9bfc9e3c5477ae8ce198f4ed303671d1">Nop.Web.Areas.Admin.Models.Catalog.Quantity</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a6eab9b1126cda0970526b3c4d9af9aed">Nop.Core.Domain.Orders.Order.StoreId</a>, <a class="el" href="namespace_nop_1_1_plugin_1_1_pickup_1_1_pickup_in_store_1_1_models.html#addaebf28dd13529bc4c925468d919f5f">Nop.Plugin.Pickup.PickupInStore.Models.StoreId</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html#a23e2071da11e51dc06d77a3b3fae546d">Nop.Services.Orders.UpdateOrderParameters.UpdatedOrder</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html#ab6f14d444bed09065e1a0e7b4b916663">Nop.Services.Orders.UpdateOrderParameters.UpdatedOrderItem</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#aa6b418ee1a57cc7122f1edf5a66e8e4e">Nop.Services.Orders.IOrderTotalCalculationService.UpdateOrderTotalsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_update_order_parameters.html#a65d9d9cdad22cb656e167b3e71dce923">Nop.Services.Orders.UpdateOrderParameters.Warnings</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_pickup_point.html#ab80aa95110d62e5199b95d095521b66f">Nop.Core.Domain.Shipping.PickupPoint.ZipPostalCode</a> e <a class="el" href="namespace_nop_1_1_web_1_1_areas_1_1_admin_1_1_models_1_1_common.html#a9125d4e9a486a66d6c2f526872ee08ac">Nop.Web.Areas.Admin.Models.Common.ZipPostalCode</a>.</p>

</div>
</div>
<a id="ab2cedc770d4bd92ee976dcb0cec0604b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2cedc770d4bd92ee976dcb0cec0604b">&#9670;&nbsp;</a></span>ValidateMinOrderSubtotalAmountAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.ValidateMinOrderSubtotalAmountAsync </td>
          <td>(</td>
          <td class="paramtype">IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt;&#160;</td>
          <td class="paramname"><em>cart</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate minimum order sub-total amount </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">cart</td><td>Shopping cart</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the rue - OK; false - minimum order sub-total amount is not reached </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a0cc592ac6e3aecc3bfd5d04018059bd5">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            <span class="keywordflow">if</span> (cart == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(cart));</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160; </div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;            <span class="comment">//min order amount sub-total validation</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            <span class="keywordflow">if</span> (!cart.Any() || <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">MinOrderSubtotalAmount</a> &lt;= decimal.Zero)</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            <span class="comment">//subtotal</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            var (_, _, subTotalWithoutDiscountBase, _, _) = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">GetShoppingCartSubTotalAsync</a>(cart, <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#afd155f07cddb8a8c277b7dfe70130410">MinOrderSubtotalAmountIncludingTax</a>);</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; </div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;            <span class="keywordflow">if</span> (subTotalWithoutDiscountBase &lt; <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">MinOrderSubtotalAmount</a>)</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings_html_afd155f07cddb8a8c277b7dfe70130410"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#afd155f07cddb8a8c277b7dfe70130410">Nop.Core.Domain.Orders.OrderSettings.MinOrderSubtotalAmountIncludingTax</a></div><div class="ttdeci">bool MinOrderSubtotalAmountIncludingTax</div><div class="ttdoc">Gets or sets a value indicating whether 'Minimum order subtotal amount' option should be evaluated ov...</div><div class="ttdef"><b>Definition:</b> OrderSettings.cs:24</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#ababbfde7e0273a5482b3997cd7b1e859">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartSubTotalAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#a30d55228ecdde267161c342936bc33fa">Nop.Core.Domain.Orders.OrderSettings.MinOrderSubtotalAmount</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#afd155f07cddb8a8c277b7dfe70130410">Nop.Core.Domain.Orders.OrderSettings.MinOrderSubtotalAmountIncludingTax</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="aa5f9da9315f1980c60a43f756b7dc85c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5f9da9315f1980c60a43f756b7dc85c">&#9670;&nbsp;</a></span>ValidateMinOrderTotalAmountAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;bool&gt; Nop.Services.Orders.OrderProcessingService.ValidateMinOrderTotalAmountAsync </td>
          <td>(</td>
          <td class="paramtype">IList&lt; <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_shopping_cart_item.html">ShoppingCartItem</a> &gt;&#160;</td>
          <td class="paramname"><em>cart</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate minimum order total amount </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">cart</td><td>Shopping cart</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the rue - OK; false - minimum order total amount is not reached </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a30c3dd7c7334d09c2c3713d89a5893af">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;            <span class="keywordflow">if</span> (cart == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(cart));</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;            <span class="keywordflow">if</span> (!cart.Any() || <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">MinOrderTotalAmount</a> &lt;= decimal.Zero)</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160; </div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;            var shoppingCartTotalBase = (await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">_orderTotalCalculationService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">GetShoppingCartTotalAsync</a>(cart)).shoppingCartTotal;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160; </div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;            <span class="keywordflow">if</span> (shoppingCartTotalBase.HasValue &amp;&amp; shoppingCartTotalBase.Value &lt; <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">_orderSettings</a>.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">MinOrderTotalAmount</a>)</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6b1ee6cc5f283a26994eff77ebbf11eb">Nop.Services.Orders.OrderProcessingService._orderSettings</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8adda1708b22c29c47ffd9976e21265e">Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html#a2316f10e4f0b8c3962ccfdc726b83199">Nop.Services.Orders.IOrderTotalCalculationService.GetShoppingCartTotalAsync()</a> e <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html#ae6448db4ab3f78dc75d767667214dc61">Nop.Core.Domain.Orders.OrderSettings.MinOrderTotalAmount</a>.</p>

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a604b3d74e2c15459de99e0ffcc43dd8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604b3d74e2c15459de99e0ffcc43dd8f">&#9670;&nbsp;</a></span>VoidAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a>&lt;IList&lt;string&gt; &gt; Nop.Services.Orders.OrderProcessingService.VoidAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>async <a class="el" href="namespace_nop_1_1_services_1_1_tasks.html">Tasks</a> order (from admin panel) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation The task result contains the async Tasked order </dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#a875005359c942d04835bc357cbc6371d">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        {</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            <span class="keywordflow">if</span> (!await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">CanVoidAsync</a>(order))</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;Cannot do async Task for order.&quot;</span>);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            var request = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_void_payment_request.html">VoidPaymentRequest</a>();</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;            <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_void_payment_result.html">VoidPaymentResult</a> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;            {</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                request.Order = order;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">_paymentService</a>.<a class="code" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#af2d45e491bb6dd457a036f0acfbfeaed">VoidAsync</a>(request);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Success)</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                {</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                    <span class="comment">//update order info</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                    order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">PaymentStatus</a> = <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.NewPaymentStatus;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                    <span class="comment">//add a note</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been async Tasked&quot;</span>);</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160; </div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                    <span class="comment">//check order status</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                    <span class="comment">//raise event       </span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                    await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_voided_event.html">OrderVoidedEvent</a>(order));</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;            <span class="keywordflow">catch</span> (Exception exc)</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;            {</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> == <span class="keyword">null</span>)</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                    <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a> = <span class="keyword">new</span> <a class="code" href="class_nop_1_1_services_1_1_payments_1_1_void_payment_result.html">VoidPaymentResult</a>();</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.AddError($<span class="stringliteral">&quot;Error: {exc.Message}. Full exception: {exc}&quot;</span>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            }</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;            <span class="comment">//process errors</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            var error = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            <span class="keywordflow">for</span> (var i = 0; i &lt; <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count; i++)</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                error += $<span class="stringliteral">&quot;Error {i}: {result.Errors[i]}&quot;</span>;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                <span class="keywordflow">if</span> (i != <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors.Count - 1)</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                    error += <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;            }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(error))</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160; </div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, $<span class="stringliteral">&quot;Unable to async Tasking order. {error}&quot;</span>);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160; </div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;            <span class="comment">//log it</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;            var logError = $<span class="stringliteral">&quot;Error async Tasking order #{order.Id}. Error: {error}&quot;</span>;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">_logger</a>.<a class="code" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">InsertLogAsync</a>(<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_logging.html#ab594ab9c457c9e33971ebd84419e8aa1">LogLevel</a>.Error, logError, logError);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">result</a>.Errors;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_voided_event_html"><div class="ttname"><a href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_voided_event.html">Nop.Core.Domain.Orders.OrderVoidedEvent</a></div><div class="ttdoc">Order voided event</div><div class="ttdef"><b>Definition:</b> OrderVoidedEvent.cs:7</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_ad97456f8075170348beaad8f57bd56e7"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">Nop.Services.Orders.OrderProcessingService.CanVoidAsync</a></div><div class="ttdeci">virtual async Task&lt; bool &gt; CanVoidAsync(Order order)</div><div class="ttdoc">Gets a value indicating whether async Task from admin panel is allowed</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:2912</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_void_payment_request_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_void_payment_request.html">Nop.Services.Payments.VoidPaymentRequest</a></div><div class="ttdoc">Represents a VoidPaymentResult</div><div class="ttdef"><b>Definition:</b> VoidPaymentRequest.cs:9</div></div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_payments_1_1_void_payment_result_html"><div class="ttname"><a href="class_nop_1_1_services_1_1_payments_1_1_void_payment_result.html">Nop.Services.Payments.VoidPaymentResult</a></div><div class="ttdoc">Represents a VoidPaymentResult</div><div class="ttdef"><b>Definition:</b> VoidPaymentResult.cs:11</div></div>
<div class="ttc" id="ainterface_nop_1_1_services_1_1_payments_1_1_i_payment_service_html_af2d45e491bb6dd457a036f0acfbfeaed"><div class="ttname"><a href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#af2d45e491bb6dd457a036f0acfbfeaed">Nop.Services.Payments.IPaymentService.VoidAsync</a></div><div class="ttdeci">Task&lt; VoidPaymentResult &gt; VoidAsync(VoidPaymentRequest voidPaymentRequest)</div><div class="ttdoc">Voids a payment</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2086f47aac799702f9a3b55b5bd964e">Nop.Services.Orders.OrderProcessingService._logger</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9392ed22ab944838b08d28039e3ded08">Nop.Services.Orders.OrderProcessingService._paymentService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">Nop.Services.Orders.OrderProcessingService.CanVoidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html#a6211543383b66a745408896a80310a40">Nop.Services.Logging.ILogger.InsertLogAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a1ef8e44cb2bff7de9ab65a583f03252c">Nop.Core.Domain.Orders.Order.PaymentStatus</a>, <a class="el" href="namespace_nop_1_1_web_1_1_models_1_1_blogs.html#a6cc3986434c188bc64f7d71789d4a5c8">Nop.Web.Models.Blogs.result</a>, <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a> e <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html#af2d45e491bb6dd457a036f0acfbfeaed">Nop.Services.Payments.IPaymentService.VoidAsync()</a>.</p>

</div>
</div>
<a id="ac5af48ff59b61c63f5d23630a925b09f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5af48ff59b61c63f5d23630a925b09f">&#9670;&nbsp;</a></span>VoidOfflineAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual async <a class="el" href="_sendinblue_plugin_8cs.html#a9f49374e6bc76a6b5261e5c211d2e63d">Task</a> Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html">Order</a>&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>async <a class="el" href="namespace_nop_1_1_services_1_1_tasks.html">Tasks</a> order (offline) </p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retorna</dt><dd>A task that represents the asynchronous operation</dd></dl>

<p>Implementa <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_processing_service.html#ae58afb23cc30edce9a6473f113fc5528">Nop.Services.Orders.IOrderProcessingService</a>.</p>
<div class="fragment"><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            <span class="keywordflow">if</span> (order == <span class="keyword">null</span>)</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(order));</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0c099f5c6bff8c808ad6d86bcf7e8163">CanVoidOffline</a>(order))</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_nop_exception.html">NopException</a>(<span class="stringliteral">&quot;You can&#39;t async Task this order&quot;</span>);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160; </div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            order.<a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">PaymentStatusId</a> = (int)<a class="code" href="namespace_nop_1_1_core_1_1_domain_1_1_payments.html#a5af4d422e00c0b088770533afd7d2c22">PaymentStatus</a>.Voided;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">_orderService</a>.<a class="code" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">UpdateOrderAsync</a>(order);</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            <span class="comment">//add a note</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">AddOrderNoteAsync</a>(order, <span class="stringliteral">&quot;Order has been marked as async Tasked&quot;</span>);</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;            <span class="comment">//check order status</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">CheckOrderStatusAsync</a>(order);</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160; </div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;            <span class="comment">//raise event       </span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            await <a class="code" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">_eventPublisher</a>.PublishAsync(<span class="keyword">new</span> <a class="code" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_voided_event.html">OrderVoidedEvent</a>(order));</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        }</div>
<div class="ttc" id="aclass_nop_1_1_services_1_1_orders_1_1_order_processing_service_html_a0c099f5c6bff8c808ad6d86bcf7e8163"><div class="ttname"><a href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0c099f5c6bff8c808ad6d86bcf7e8163">Nop.Services.Orders.OrderProcessingService.CanVoidOffline</a></div><div class="ttdeci">virtual bool CanVoidOffline(Order order)</div><div class="ttdoc">Gets a value indicating whether order can be marked as async Tasked</div><div class="ttdef"><b>Definition:</b> OrderProcessingService.cs:3003</div></div>
</div><!-- fragment -->
<p class="reference">Referências <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afbc6735136b96ead99c6fd2e4ac5bd9a">Nop.Services.Orders.OrderProcessingService._eventPublisher</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a682a75ec4bce1100c65798a7e251bcf7">Nop.Services.Orders.OrderProcessingService._orderService</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a0c099f5c6bff8c808ad6d86bcf7e8163">Nop.Services.Orders.OrderProcessingService.CanVoidOffline()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order.html#a65bb2321dfba33fc88853c1e0c558c6b">Nop.Core.Domain.Orders.Order.PaymentStatusId</a> e <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html#aef9bab53153d827f38ce1b4f6f785112">Nop.Services.Orders.IOrderService.UpdateOrderAsync()</a>.</p>

</div>
</div>
<h2 class="groupheader">Documentação dos dados membro</h2>
<a id="adeff3449bd42300b1f5277b5d4038059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeff3449bd42300b1f5277b5d4038059">&#9670;&nbsp;</a></span>_addressService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_address_service.html">IAddressService</a> Nop.Services.Orders.OrderProcessingService._addressService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="abee78ab02d7850dd249b88d5dc0d775e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee78ab02d7850dd249b88d5dc0d775e">&#9670;&nbsp;</a></span>_affiliateService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_affiliates_1_1_i_affiliate_service.html">IAffiliateService</a> Nop.Services.Orders.OrderProcessingService._affiliateService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a75dbf57754d33a660e8263165282af98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75dbf57754d33a660e8263165282af98">&#9670;&nbsp;</a></span>_checkoutAttributeFormatter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_checkout_attribute_formatter.html">ICheckoutAttributeFormatter</a> Nop.Services.Orders.OrderProcessingService._checkoutAttributeFormatter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="aaf47b468edb2b5094a965595abef7180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf47b468edb2b5094a965595abef7180">&#9670;&nbsp;</a></span>_countryService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_country_service.html">ICountryService</a> Nop.Services.Orders.OrderProcessingService._countryService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="a1af4526c16c2806e79141eee59eec04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af4526c16c2806e79141eee59eec04d">&#9670;&nbsp;</a></span>_currencyService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_currency_service.html">ICurrencyService</a> Nop.Services.Orders.OrderProcessingService._currencyService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a7ece80723f8671f549b939dbd21926ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ece80723f8671f549b939dbd21926ce">&#9670;&nbsp;</a></span>_currencySettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_directory_1_1_currency_settings.html">CurrencySettings</a> Nop.Services.Orders.OrderProcessingService._currencySettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a9e8d965a1d5e4b9abd89d5b8167c7fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e8d965a1d5e4b9abd89d5b8167c7fae">&#9670;&nbsp;</a></span>_customerActivityService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_customer_activity_service.html">ICustomerActivityService</a> Nop.Services.Orders.OrderProcessingService._customerActivityService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>.</p>

</div>
</div>
<a id="a528f4227552c25da09510c9030bc9471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528f4227552c25da09510c9030bc9471">&#9670;&nbsp;</a></span>_customerService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_customers_1_1_i_customer_service.html">ICustomerService</a> Nop.Services.Orders.OrderProcessingService._customerService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac0875883e79f8cf6f926d30b11c9d0a3">Nop.Services.Orders.OrderProcessingService.CanCancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeb836ba11d1d94f76d792a351ee53cba">Nop.Services.Orders.OrderProcessingService.CanRetryLastRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Nop.Services.Orders.OrderProcessingService.ReOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="ab8773893cfe0dfd2f8ae2c17cd868325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8773893cfe0dfd2f8ae2c17cd868325">&#9670;&nbsp;</a></span>_customNumberFormatter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_custom_number_formatter.html">ICustomNumberFormatter</a> Nop.Services.Orders.OrderProcessingService._customNumberFormatter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="ae3799d8d3ec560c2e825d188bcda1e5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3799d8d3ec560c2e825d188bcda1e5b">&#9670;&nbsp;</a></span>_discountService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_discounts_1_1_i_discount_service.html">IDiscountService</a> Nop.Services.Orders.OrderProcessingService._discountService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae28360b413dd34283242e7075da477d3">Nop.Services.Orders.OrderProcessingService.SaveDiscountUsageHistoryAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="a935fb408a00bf0f0c44151f1f87beb96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a935fb408a00bf0f0c44151f1f87beb96">&#9670;&nbsp;</a></span>_encryptionService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_security_1_1_i_encryption_service.html">IEncryptionService</a> Nop.Services.Orders.OrderProcessingService._encryptionService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="afbc6735136b96ead99c6fd2e4ac5bd9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc6735136b96ead99c6fd2e4ac5bd9a">&#9670;&nbsp;</a></span>_eventPublisher</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_core_1_1_events_1_1_i_event_publisher.html">IEventPublisher</a> Nop.Services.Orders.OrderProcessingService._eventPublisher</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">Nop.Services.Orders.OrderProcessingService.MarkAsAuthorizedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync()</a>.</p>

</div>
</div>
<a id="af591bddf525120c688839eeb5b63483a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af591bddf525120c688839eeb5b63483a">&#9670;&nbsp;</a></span>_genericAttributeService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_generic_attribute_service.html">IGenericAttributeService</a> Nop.Services.Orders.OrderProcessingService._genericAttributeService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Nop.Services.Orders.OrderProcessingService.ReOrderAsync()</a>.</p>

</div>
</div>
<a id="a0283d452f56e8cc530632d5f24147f5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0283d452f56e8cc530632d5f24147f5f">&#9670;&nbsp;</a></span>_giftCardService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_gift_card_service.html">IGiftCardService</a> Nop.Services.Orders.OrderProcessingService._giftCardService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af2b1d50935c535ba0709de02f3da3c05">Nop.Services.Orders.OrderProcessingService.SaveGiftCardUsageHistoryAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync()</a>.</p>

</div>
</div>
<a id="a8a86507ce9f96e887f327064723d350b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a86507ce9f96e887f327064723d350b">&#9670;&nbsp;</a></span>_languageService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_language_service.html">ILanguageService</a> Nop.Services.Orders.OrderProcessingService._languageService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync()</a>.</p>

</div>
</div>
<a id="a523bf26abfaef915d5c034e4e0a811b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523bf26abfaef915d5c034e4e0a811b5">&#9670;&nbsp;</a></span>_localizationService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_localization_1_1_i_localization_service.html">ILocalizationService</a> Nop.Services.Orders.OrderProcessingService._localizationService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="ac23fbd6e69641baba3a5e4a2b72ba7da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23fbd6e69641baba3a5e4a2b72ba7da">&#9670;&nbsp;</a></span>_localizationSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_localization_1_1_localization_settings.html">LocalizationSettings</a> Nop.Services.Orders.OrderProcessingService._localizationSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>.</p>

</div>
</div>
<a id="ab2086f47aac799702f9a3b55b5bd964e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2086f47aac799702f9a3b55b5bd964e">&#9670;&nbsp;</a></span>_logger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_logging_1_1_i_logger.html">ILogger</a> Nop.Services.Orders.OrderProcessingService._logger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6d2ae89a729ed2afc363893126b81958">Nop.Services.Orders.OrderProcessingService.PlaceOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a>.</p>

</div>
</div>
<a id="a682a75ec4bce1100c65798a7e251bcf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682a75ec4bce1100c65798a7e251bcf7">&#9670;&nbsp;</a></span>_orderService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_service.html">IOrderService</a> Nop.Services.Orders.OrderProcessingService._orderService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af7b69d22b846ca3ea12be3a4fd016a49">Nop.Services.Orders.OrderProcessingService.AddOrderNoteAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac0875883e79f8cf6f926d30b11c9d0a3">Nop.Services.Orders.OrderProcessingService.CanCancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeb836ba11d1d94f76d792a351ee53cba">Nop.Services.Orders.OrderProcessingService.CanRetryLastRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">Nop.Services.Orders.OrderProcessingService.CreateFirstRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a26815bf28de303791fa0f42633a9245e">Nop.Services.Orders.OrderProcessingService.GetCyclesRemainingAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#abb5180e1683480f5550d2ca71a25b516">Nop.Services.Orders.OrderProcessingService.GetNextPaymentDateAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81a5d841973c068e42ea78caf6a160a3">Nop.Services.Orders.OrderProcessingService.IsReturnRequestAllowedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeda57f823a8631e81d96c2318845fc84">Nop.Services.Orders.OrderProcessingService.MarkAsAuthorizedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a85a9ee7368631647b120766b46d5e5c0">Nop.Services.Orders.OrderProcessingService.MarkOrderAsPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Nop.Services.Orders.OrderProcessingService.ReOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac5af48ff59b61c63f5d23630a925b09f">Nop.Services.Orders.OrderProcessingService.VoidOfflineAsync()</a>.</p>

</div>
</div>
<a id="a6b1ee6cc5f283a26994eff77ebbf11eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1ee6cc5f283a26994eff77ebbf11eb">&#9670;&nbsp;</a></span>_orderSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_orders_1_1_order_settings.html">OrderSettings</a> Nop.Services.Orders.OrderProcessingService._orderSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a36e730601668851f42f549318caaaa86">Nop.Services.Orders.OrderProcessingService.CheckOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81a5d841973c068e42ea78caf6a160a3">Nop.Services.Orders.OrderProcessingService.IsReturnRequestAllowedAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderSubtotalAmountAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderTotalAmountAsync()</a>.</p>

</div>
</div>
<a id="a8adda1708b22c29c47ffd9976e21265e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adda1708b22c29c47ffd9976e21265e">&#9670;&nbsp;</a></span>_orderTotalCalculationService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_order_total_calculation_service.html">IOrderTotalCalculationService</a> Nop.Services.Orders.OrderProcessingService._orderTotalCalculationService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a468a280332b31043d11c73bd2f6e6630">Nop.Services.Orders.OrderProcessingService.IsPaymentWorkflowRequiredAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab2cedc770d4bd92ee976dcb0cec0604b">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderSubtotalAmountAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa5f9da9315f1980c60a43f756b7dc85c">Nop.Services.Orders.OrderProcessingService.ValidateMinOrderTotalAmountAsync()</a>.</p>

</div>
</div>
<a id="a96ff841d52ac21b5a23ce1a9883730d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ff841d52ac21b5a23ce1a9883730d3">&#9670;&nbsp;</a></span>_paymentPluginManager</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_plugin_manager.html">IPaymentPluginManager</a> Nop.Services.Orders.OrderProcessingService._paymentPluginManager</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a9392ed22ab944838b08d28039e3ded08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9392ed22ab944838b08d28039e3ded08">&#9670;&nbsp;</a></span>_paymentService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_payments_1_1_i_payment_service.html">IPaymentService</a> Nop.Services.Orders.OrderProcessingService._paymentService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7af3ca11a1d78bcbba7679447c03e5a9">Nop.Services.Orders.OrderProcessingService.CanCaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af5c1027453ac2c150e4f5b5e34022883">Nop.Services.Orders.OrderProcessingService.CanPartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5a51e3689da5d8de248f4d4505f651f6">Nop.Services.Orders.OrderProcessingService.CanRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aeb836ba11d1d94f76d792a351ee53cba">Nop.Services.Orders.OrderProcessingService.CanRetryLastRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad97456f8075170348beaad8f57bd56e7">Nop.Services.Orders.OrderProcessingService.CanVoidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a4ed73679d36b7b6be34f30cc26e12dff">Nop.Services.Orders.OrderProcessingService.CaptureAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6f364e54df9c3c5e630d0251b3c4b6e2">Nop.Services.Orders.OrderProcessingService.CreateFirstRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a5fdc3a30ecd2f4fd151465b6b1953eb0">Nop.Services.Orders.OrderProcessingService.GetProcessPaymentResultAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a604b3d74e2c15459de99e0ffcc43dd8f">Nop.Services.Orders.OrderProcessingService.VoidAsync()</a>.</p>

</div>
</div>
<a id="ab25d720884f3f10ddec6c09b6a214b4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab25d720884f3f10ddec6c09b6a214b4d">&#9670;&nbsp;</a></span>_paymentSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_payments_1_1_payment_settings.html">PaymentSettings</a> Nop.Services.Orders.OrderProcessingService._paymentSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>.</p>

</div>
</div>
<a id="a4b921e2382b2d0f35d5fd9d378f62668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b921e2382b2d0f35d5fd9d378f62668">&#9670;&nbsp;</a></span>_pdfService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_common_1_1_i_pdf_service.html">IPdfService</a> Nop.Services.Orders.OrderProcessingService._pdfService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a>.</p>

</div>
</div>
<a id="a997713a565a6ac517f86ce46b6a05bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997713a565a6ac517f86ce46b6a05bbf">&#9670;&nbsp;</a></span>_priceCalculationService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_calculation_service.html">IPriceCalculationService</a> Nop.Services.Orders.OrderProcessingService._priceCalculationService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="afc0c1f9f592bd30994ec44a49280cad0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc0c1f9f592bd30994ec44a49280cad0">&#9670;&nbsp;</a></span>_priceFormatter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_price_formatter.html">IPriceFormatter</a> Nop.Services.Orders.OrderProcessingService._priceFormatter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a37c365ad403e9ac6aa0f5557edb7f2fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37c365ad403e9ac6aa0f5557edb7f2fe">&#9670;&nbsp;</a></span>_productAttributeFormatter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_formatter.html">IProductAttributeFormatter</a> Nop.Services.Orders.OrderProcessingService._productAttributeFormatter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="a35af79dc9ceb975327b0a420491d3ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35af79dc9ceb975327b0a420491d3ec0">&#9670;&nbsp;</a></span>_productAttributeParser</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_attribute_parser.html">IProductAttributeParser</a> Nop.Services.Orders.OrderProcessingService._productAttributeParser</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ac4b72d392fdabac68ba2bdfc50e63247">Nop.Services.Orders.OrderProcessingService.AddGiftCardsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9cfacc51e4ed202dd0ee478dba282fb3">Nop.Services.Orders.OrderProcessingService.ProcessCustomerRolesWithPurchasedProductSpecifiedAsync()</a>.</p>

</div>
</div>
<a id="a309d452cba4d881271ad2d24c7843dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a309d452cba4d881271ad2d24c7843dff">&#9670;&nbsp;</a></span>_productService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_catalog_1_1_i_product_service.html">IProductService</a> Nop.Services.Orders.OrderProcessingService._productService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Nop.Services.Orders.OrderProcessingService.ReOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="a637b49bb3285d8244c1ee304e59a3b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a637b49bb3285d8244c1ee304e59a3b3f">&#9670;&nbsp;</a></span>_rewardPointService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_reward_point_service.html">IRewardPointService</a> Nop.Services.Orders.OrderProcessingService._rewardPointService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a58ef586e3bf6517d1a70e6fcc6bef293">Nop.Services.Orders.OrderProcessingService.ReduceRewardPointsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab4879004f9159f7339cf04d1e2478178">Nop.Services.Orders.OrderProcessingService.ReturnBackRedeemedRewardPointsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a974bdf4aa0452e9f43e8d9669acca975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a974bdf4aa0452e9f43e8d9669acca975">&#9670;&nbsp;</a></span>_rewardPointsSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_customers_1_1_reward_points_settings.html">RewardPointsSettings</a> Nop.Services.Orders.OrderProcessingService._rewardPointsSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae5834b1db8b3e55653eb039c0bbd3be9">Nop.Services.Orders.OrderProcessingService.AwardRewardPointsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>.</p>

</div>
</div>
<a id="a8acb96f997201c0543a6833cd3a304e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8acb96f997201c0543a6833cd3a304e7">&#9670;&nbsp;</a></span>_shipmentService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipment_service.html">IShipmentService</a> Nop.Services.Orders.OrderProcessingService._shipmentService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a94d9d92a027d9c60f54dc0e1cda6a8a8">Nop.Services.Orders.OrderProcessingService.CancelOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aa6f39e64546fb3a2604e36367c473eac">Nop.Services.Orders.OrderProcessingService.DeleteOrderAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>.</p>

</div>
</div>
<a id="a0edda809b10ea29bfe00542d7306424f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0edda809b10ea29bfe00542d7306424f">&#9670;&nbsp;</a></span>_shippingService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_shipping_1_1_i_shipping_service.html">IShippingService</a> Nop.Services.Orders.OrderProcessingService._shippingService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="a212c894e11cf3f8fc28b0cfdc0bbedf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a212c894e11cf3f8fc28b0cfdc0bbedf8">&#9670;&nbsp;</a></span>_shippingSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_shipping_1_1_shipping_settings.html">ShippingSettings</a> Nop.Services.Orders.OrderProcessingService._shippingSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a964b7bb1015e5a6901aaf80e827969cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a964b7bb1015e5a6901aaf80e827969cd">&#9670;&nbsp;</a></span>_shoppingCartService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_orders_1_1_i_shopping_cart_service.html">IShoppingCartService</a> Nop.Services.Orders.OrderProcessingService._shoppingCartService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a9b0a42aabf0d2b5c41765806fce04b17">Nop.Services.Orders.OrderProcessingService.ReOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a598b25782d04f6afcb42582553bb84a2">Nop.Services.Orders.OrderProcessingService.UpdateOrderTotalsAsync()</a>.</p>

</div>
</div>
<a id="ad4eca13441d549f6e2b57ed3b0bb8df2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4eca13441d549f6e2b57ed3b0bb8df2">&#9670;&nbsp;</a></span>_stateProvinceService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_directory_1_1_i_state_province_service.html">IStateProvinceService</a> Nop.Services.Orders.OrderProcessingService._stateProvinceService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a870338b48b8874c10ae35cff96dd4322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870338b48b8874c10ae35cff96dd4322">&#9670;&nbsp;</a></span>_taxService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_tax_1_1_i_tax_service.html">ITaxService</a> Nop.Services.Orders.OrderProcessingService._taxService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a2c693d0278fa64204bbcac1f05df1651">Nop.Services.Orders.OrderProcessingService.MoveShoppingCartItemsToOrderItemsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="ab630f7eca77078d362428f6b924d2472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab630f7eca77078d362428f6b924d2472">&#9670;&nbsp;</a></span>_taxSettings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_nop_1_1_core_1_1_domain_1_1_tax_1_1_tax_settings.html">TaxSettings</a> Nop.Services.Orders.OrderProcessingService._taxSettings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="a904543a4ac69a1f79f576612ec51b05d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a904543a4ac69a1f79f576612ec51b05d">&#9670;&nbsp;</a></span>_vendorService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_vendors_1_1_i_vendor_service.html">IVendorService</a> Nop.Services.Orders.OrderProcessingService._vendorService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ada11474c14bf82ad908d28bf9d926112">Nop.Services.Orders.OrderProcessingService.GetVendorsInOrderAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>.</p>

</div>
</div>
<a id="a85950a3b9289d679c1f24a07dc5b2610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85950a3b9289d679c1f24a07dc5b2610">&#9670;&nbsp;</a></span>_webHelper</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_core_1_1_i_web_helper.html">IWebHelper</a> Nop.Services.Orders.OrderProcessingService._webHelper</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#aea58104edceca7eb0576dc9c02824f04">Nop.Services.Orders.OrderProcessingService.SaveOrderDetailsAsync()</a>.</p>

</div>
</div>
<a id="aad13ab85dbf2eeff57a0e908475117cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad13ab85dbf2eeff57a0e908475117cf">&#9670;&nbsp;</a></span>_workContext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_core_1_1_i_work_context.html">IWorkContext</a> Nop.Services.Orders.OrderProcessingService._workContext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a7fe03f365a1fb4e26dfa305562fa7d5e">Nop.Services.Orders.OrderProcessingService.PreparePlaceOrderDetailsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a8a51cb2794e39742eca861d2767779ad">Nop.Services.Orders.OrderProcessingService.PrepareRecurringOrderDetailsAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>.</p>

</div>
</div>
<a id="a34f4795b2175a1ff0af7828c284477df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f4795b2175a1ff0af7828c284477df">&#9670;&nbsp;</a></span>_workflowMessageService</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_nop_1_1_services_1_1_messages_1_1_i_workflow_message_service.html">IWorkflowMessageService</a> Nop.Services.Orders.OrderProcessingService._workflowMessageService</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenciado por <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a234b127560732053f0c1ab698604c408">Nop.Services.Orders.OrderProcessingService.CancelRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad28d85dbb5aba28cdbcb26ca78f36edd">Nop.Services.Orders.OrderProcessingService.DeliverAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad640a14a8581f8eb8a57b0a210cc7316">Nop.Services.Orders.OrderProcessingService.OrderProcessingService()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a6623c66d5d0f34b520aa92df82552f37">Nop.Services.Orders.OrderProcessingService.PartiallyRefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a81e7a00a2b1767ccb3d8cc954a16eff4">Nop.Services.Orders.OrderProcessingService.PartiallyRefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ae46217f3f60445071742ab76556757aa">Nop.Services.Orders.OrderProcessingService.ProcessNextRecurringPaymentAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a14f96cdb18cd65086be7f64788f98ca3">Nop.Services.Orders.OrderProcessingService.ProcessOrderPaidAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ad72ff7732c1fc400922a2a6c37d20e17">Nop.Services.Orders.OrderProcessingService.RefundAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#adede3bbc864fd8df87dbf282c9a6f0c4">Nop.Services.Orders.OrderProcessingService.RefundOfflineAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#a11fe03f64d9156620bc0611240669287">Nop.Services.Orders.OrderProcessingService.SendNotificationsAndSaveNotesAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#ab640dd113d78cc91758e7bd2e05c5ec5">Nop.Services.Orders.OrderProcessingService.SetActivatedValueForPurchasedGiftCardsAsync()</a>, <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#afa36dec6110e6877538e59656b5fbc67">Nop.Services.Orders.OrderProcessingService.SetOrderStatusAsync()</a> e <a class="el" href="class_nop_1_1_services_1_1_orders_1_1_order_processing_service.html#af368ffb978128f1a87ec3b4113c1e356">Nop.Services.Orders.OrderProcessingService.ShipAsync()</a>.</p>

</div>
</div>
<hr/>A documentação para esta classe foi gerada a partir do seguinte ficheiro:<ul>
<li>C:/Users/gabri/Documents/Projetos/GitHub/Estudos/Nopcommercer plugin/nopCommerce_4.40.3_Source - Copia/src/Libraries/Nop.Services/Orders/<a class="el" href="_order_processing_service_8cs.html">OrderProcessingService.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Gerado por&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
